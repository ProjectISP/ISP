/*
  Copyright Â© 2017 Adobe Systems Incorporated.  All rights reserved.
  Generated by Adobe RoboHelp 2017
*/
!function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=rh._,f=rh.$,g=rh.consts,h=rh.model,i=g("HASH_KEY_RH_SEARCH"),j=g("HASH_KEY_TOPIC"),k=g("HASH_KEY_UIMODE"),l=g("HASH_KEY_RH_TOCID"),m=g("HASH_KEY_RH_HIGHLIGHT"),n=g("HASH_KEY_RANDOM"),o=[m,g("HASH_KEY_RH_SYNS"),l],p=function(a,b){b=b;var c=e.filePath(b),d=e.extractHashString(b);d.length>0&&(d="#"+d);var f=e.urlParams(e.extractParamString(b)),i=!0,j=!1,k=void 0;try{for(var l,m=Array.from(o)[Symbol.iterator]();!(i=(l=m.next()).done);i=!0){var p=l.value;null!=a[p]&&(f[p]=a[p])}}catch(q){j=!0,k=q}finally{try{!i&&m["return"]&&m["return"]()}finally{if(j)throw k}}h.get(g("KEY_SCREEN_IOS"))&&(f[n]=e.uniqueId());var r=e.mapToEncodedString(f);return r.length>0&&(r="?"+r),""+c+r+d},q=e.queueUpdateHashMap,r=function(a){return null==a&&(a={}),a[k]=null,a[n]=null,a[l]||(a[l]=null),a[m]||(a[m]=null),a},s=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a=e.fixRelativeUrl(a);var d=e.urlParams(e.extractParamString(a));return d[j]=e.stripParam(a),d=r(d),q(d,b,c)},t=function(a,b){var c={};return c[j]=a,c=r(c),q(c,b)},u=function(a){var b=void 0,c=a.newMap,d=a.oldMap,f=d[k],n=c[k];return e.getDefaultTopic(function(a){var o=rh.model.get(rh.consts("EVT_USER_CLICK"));if(i in c){var q=c[i];b=q!==h.get(g("KEY_SEARCHED_TERM")),h.publish(g("KEY_SEARCH_TERM"),q,{sync:!0})}if("search"===n&&b&&window.gHost&&h.publish(g("EVT_QUERY_SEARCH_RESULTS"),!0),!n||c[j]){var r=void 0,s=h.get(g("KEY_TOPIC_IN_IFRAME"));j in c&&(r=c[j]),r||(r=s);var t=rh.model.get(rh.consts("KEY_FEATURE"));r||t&&t.showDefTopic===!1||(r=a);var u=r&&(r!==s||f!==n||d[m]!==c[m]||d[l]!==c[l])||o;u&&(e.stripBookmark(r)!==e.stripBookmark(s)&&e.runTopicLoadingAnimation(!0),h.publish(g("KEY_TOPIC_IN_IFRAME"),r),window.loadTopic(p(c,r)))}return rh.model.publish(rh.consts("EVT_USER_CLICK",!1)),h.publish(g("KEY_UI_MODE"),c[k])})},v=function(a){var b=e.hashParams();if(a&&!b[k]){var c=decodeURI(document.location.href),d=window._getRelativeFileName(c,a),f=b[j];if(!f||e.filePath(d)!==e.filePath(f))return h.publish(g("KEY_TOPIC_IN_IFRAME"),d),s(d,!1)}},w=function(a){var b={},c=[g("RHMAPID"),g("RHMAPNO"),g("RHWINDOW"),g("RHCSHMODE")];return e.each(a,function(d,e){c.includes(e)&&(b[e]=d,delete a[e])}),{queryParams:b,hashParams:a}},x=function(a){var b=a.absUrl;if(!e.isRootUrl()){if(!e.isRootUrl(b)){var c=void 0,d=void 0,i=e.getRootUrl();if(e.isExternalUrl(b))d=b;else{d=e.fixRelativeUrl(e.makeRelativePath(b,i)),c=e.urlParams(e.extractParamString(d)),c[j]=e.stripParam(d),c=r(c);var m=w(c),n=m.queryParams,o=m.hashParams;b=i+"?"+e.mapToEncodedString(n)+"#"+e.mapToEncodedString(o)}}return document.location.href=b}if(!e.isUrlAllowdInIframe(b))return t(b,!0);if(b=e.makeRelativeUrl(e.fixRelativeUrl(b)),e.isHomeUrl(b))return document.location.href=b;var p=b&&e.filePath(b);p===g("START_FILEPATH")?b=b.substring(p.length):b||(b="#ux");var u=e.removeParam(e.stripBookmark(h.get(g("KEY_TOPIC_URL"))),g("HASH_KEY_RH_TOCID")),v=e.removeParam(e.stripBookmark(e.get(a,"absUrl")),g("HASH_KEY_RH_TOCID")),x=e.extractHashString(b);if(u===v){e.isEmptyString(x)||h.publish(g("EVT_SCROLL_INTO_VIEW"),"#"+f.cssEscape(x));var y=e.hashParams(e.extractHashString(b));k in y||(y[k]=null);var z=e.urlParams(e.extractParamString(b));return l in z?y[l]=z[l]:y[l]=null,q(y,!0)}if("#"===b[0]||"?"===b[0]){var A=e.hashParams(e.extractHashString(b));return k in A||(A[k]=null),q(A,!0)}return b?s(b,!0,!0):void 0};h.subscribe(g("EVT_WIDGET_LOADED"),function(){return e.addEventListener(document,"click",e.hookClick),h.subscribe(g("EVT_HASH_CHANGE"),u),h.subscribe(g("KEY_TOPIC_URL"),v),h.subscribe(g("EVT_NAVIGATE_TO_URL"),x),h.subscribe(g("KEY_TOPIC_IN_IFRAME"),function(a){if(""+window.gHost+window.gHostPath!="/"&&(window.setTopic&&window.setTopic(),window.changeTopicLink))return window.changeTopicLink(document.location.toString())}),h.subscribe(g("EVT_TOPIC_LOADED"),function(){return e.runTopicLoadingAnimation(!1)}),h.subscribe(g("EVT_INSIDE_IFRAME_DOM_CONTENTLOADED"),function(){return e.runTopicLoadingAnimation(!1)})})},{}],2:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=window,rh=h.rh,i=rh.model,j=rh._,k=rh.consts,l=(rh.apiClient,function(){var a=void 0;return l=function(b){function c(a){d(this,c);var b=e(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return b.data=[],b.chunkCount=0,b.count=0,b.keys="",b.alhpabet="",b.loadNavData("glo"),b.filter="",b.widget=a,b.widget.publish("show",{}),b}return f(c,b),g(c,null,[{key:"initClass",value:function(){a="entrys"}}]),g(c,[{key:"addElement",value:function(b,c){var d=this;return function(){var e=[];return j.each(b[a],function(a){null!=a&&(d.lookup(c,a)?e.push(void 0):e.push(c.push(a)))},d),e}()}},{key:"getEscapedString",value:function(a){return a.replace(/\\"/g,'"').replace(/\\\\/g,"\\")}},{key:"exists",value:function(a){var b=this.alphaText(a);return this.alhpabet.indexOf(b)>-1||(this.alhpabet+=b,!1)}},{key:"isFiltered",value:function(a,b){var c=b?i.get(b):this.filter;return c&&a.toLocaleLowerCase().indexOf(c.toLocaleLowerCase())===-1}},{key:"alphaText",value:function(a){return a.toUpperCase().charAt(0)}},{key:"filterGlo",value:function(a){return this.filter=a.toLocaleLowerCase(),this.alhpabet="",i.publish(k("KEY_SHOW_GLOSSARY_MESSAGE"),!this.hasResults()),i.publish(k("PROJECT_GLOSSARY_DATA"),i.get(k("PROJECT_GLOSSARY_DATA")))}},{key:"hasResults",value:function(){var a=this,b=i.get(k("PROJECT_GLOSSARY_DATA"));return j.any(b,function(b){return!a.isFiltered(b.name)})}}]),c}(rh.NavController),l.initClass(),l}());rh.controller("GlossaryController",l)},{}],3:[function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){return"undefined"!=typeof a&&null!==a?b(a):void 0}var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=window,rh=j.rh,k=rh.model,l=rh._,m=rh.consts,n=rh.apiClient,o=rh.rhs,p="topics",q=function(){function a(){g(this,a),this.updateData=this.updateData.bind(this)}return i(a,[{key:"lookup",value:function(a,b){var c=void 0;return null!=a&&null!=b&&l.any(a,function(a){if(null!=a)return b.type===a.type&&b.name===a.name&&l.isEqual(b.url,a.url)&&(c=a),null!=c},this),c}},{key:"sort",value:function(a){return a.sort(function(a,b){return window.compare(a.name,b.name)})}},{key:"updateData",value:function(a,b,c){var d=l.extractTempData(a,this.widget,{});if(this.addElement(d,this.data,c,this.keys),0===--this.chunkCount&&0===this.count)return"PROJECT_INDEX_DATA"===b?this.data=this.sortIndexData(this.data):this.sort(this.data),k.publish(m(b),this.data)}},{key:"sortIndexData",value:function(a){var b=this,c=l.groupBy(a,"name"),d=l.map(c,function(a){return b.mergedKeyWords(a)});return d=this.sort(d)}},{key:"mergedKeyWords",value:function(a){var b=this;return l.reduce(a,function(a,c){return a.name=c.name,a.type=c.type,a.url=c.url,a["data-rhtags"]=c["data-rhtags"],"key"===c.type&&(a.topics=b.sortIndexData((a.topics||[]).concat(c.topics||[])),a.keys=b.sortIndexData(b.getKeys(a).concat(c.keys||[]))),a},{})}},{key:"getKeys",value:function(a){return Array.isArray(a.keys)?a.keys:[]}},{key:"getChunkData",value:function(a,b,c){this.count--;var d=l.extractTempData(a,this.widget,{}),e=h(d,function(a){return a.chunkinfos})||[];return this.chunkCount+=e.length,l.each(e,function(a){var d=this;return b&&(b=l.ensureSlash(b)),l.loadScript(b+"whxdata/"+a.node+".new.js",!1,function(a){return d.updateData(a,c,b)})},this)}},{key:"loadNavData",value:function(a){var b=this;return k.subscribe(m("KEY_PROJECT_LIST"),function(c){return b.alhpabet="",b.count+=c.length,l.each(c,function(b){var c=this;return b&&(b=l.ensureSlash(b)),l.loadScript(b+"whxdata/"+("ndx"===a?"idx":"glo")+".new.js",!1,function(d){return c.getChunkData(d,b,"ndx"===a?"PROJECT_INDEX_DATA":"PROJECT_GLOSSARY_DATA")})},b)})}}]),a}();rh.NavController=q;var r=function(){var a=void 0;return r=function(b){function c(a){g(this,c);var b=e(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return b.data=[],b.chunkCount=0,b.count=0,b.alhpabet="",b.filter="",b.keys="keys",b.widget=a,k.subscribeOnce(m("EVT_PROJECT_LOADED"),function(){return b.loadNavData("ndx"),b.getIndexData(),k.subscribe(m("KEY_INDEX_FILTER"),function(){return b.alhpabet=""})}),b}return f(c,b),i(c,null,[{key:"initClass",value:function(){a=""}}]),i(c,[{key:"addElement",value:function(b,c,d,e){var f=this;if(null!=b[e])return function(){var g=[];return l.each(b[e],function(b){if(null!=b){var e;if(!(e=f.lookup(c,b))){var h={type:b.type,name:b.name};b["data-rhtags"]&&(h["data-rhtags"]=b["data-rhtags"]+"+"+d),b.url||(h[p]=[]);var i=l.makeRelativeUrl(""+d,a);null!=b.url&&(h.url=""+encodeURI(i)+b.url),null==b.url&&(h[f.keys]=[]),c.push(h),e=c[c.length-1]}f.addElement(b,e[f.keys],d,f.keys),g.push(f.addElement(b,e[p],d,p))}},f),g}()}},{key:"showItem",value:function(a){var b=k.get(m("KEY_INDEX_FILTER"));return!b||a.toLocaleLowerCase().indexOf(b.toLocaleLowerCase())!==-1}},{key:"showCategory",value:function(a,b){if(b>0)return!1;var c=this.alphaText(a);return!(this.alhpabet.indexOf(c)>-1)&&(this.alhpabet+=c,!0)}},{key:"showNextLevel",value:function(a){for(var b=a.getAttribute("data-indexid"),c=this.widget.get("show."+b),e=d({},b,!c);b;)b=b.substr(0,b.lastIndexOf("_")),e[b]=!0;return this.widget.publish("show",e)}},{key:"alphaText",value:function(a){return a.toUpperCase().charAt(0)}},{key:"getIndexData",value:function(){return k.subscribeOnce(m("KEY_PUBLISH_BASE_URL"),function(){try{var a=k.get(m("KEY_PUBLISH_BASE_URL")),b=rh._.splitUrl(a),c=b.pathname;if(c&&!l.isEmptyString(c)){var d=l.mapToEncodedString(l.extend(l.addPathNameKey({area:o.area(),prj:o.project(),type:o.type(),agt:"ndx",mgr:"agm"})));return n.get(c+"?"+d).success(function(a,b){a=JSON.parse(a);var c=[],d=[],e=a.allProjects,f=a,g=f.masterProjects;e.length&&(e[0]=l.ensureSlash(e[0]));var h=function(a,b){return l.each(a,function(a){return b.push(l.makeRelativeUrl(a,e[0]))})};h(e,c),h(g,d);var i=function(a,b,c){l.isEmptyString(a)&&(c[b]=".")};return l.each(c,i),l.each(d,i),k.publish(m("KEY_PROJECT_LIST"),c),k.publish(m("KEY_MASTER_PROJECT_LIST"),d)})}}catch(e){if(rh._debug)return rh._d("warn",e.message)}})}}]),c}(rh.NavController),r.initClass(),r}();rh.controller("IndexController",r)},{}],4:[function(a,b,c){"use strict";var rh=a("../../src/lib/rh"),d=rh._;d.findEditDist=function(a,b){if(a==b)return 0;for(var c=[],d=[],e=0;e<b.length+1;e++)c.push(e),d.push(0);for(var e=0;e<a.length;e++){d[0]=e+1;for(var f=0;f<b.length;f++){var g=void 0;g=a[e]==b[f]?0:1,d[f+1]=Math.min(d[f]+1,c[f+1]+1,c[f]+g)}for(var f=0;f<c.length;f++)c[f]=d[f]}return d[d.length-1]}},{"../../src/lib/rh":25}],5:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(a,b){return function(){return a.apply(b,arguments)}},rh=a("../../src/lib/rh"),g=a("../../src/responsive_help/utils/node_utils"),h=rh._,i=rh.$,j=rh.model,k=rh.consts,l=k("KEY_TOC_DRILL_DOWN"),m=700,n=void 0,o=void 0;n=function(){var a=function(){function a(){d(this,a)}return e(a,[{key:"sync",value:function(a,b){var c=void 0;return a.updateActiveBookInfo(0,"_"),c=a.widget.node,this.reset(b),this.syncToProjectToc(a,c.children,function(b){return function(c){return b.syncToTocItem(a,c)}}(this))}},{key:"reset",value:function(a){var b=void 0;return this.parseTocInfo(a),b=this.order.lastIndexOf("@"),this.parentOrder=b!==-1?this.order.substring(0,b):""}},{key:"parseTocInfo",value:function(a){var b=void 0;return this.order=a.childOrder||"",b=h.splitAndTrim(a.childPrefix,"."),this.tocPath=h.reduce(b,function(a,b){var c=void 0,d=void 0;return c=h.splitAndTrim(b,"@"),(d=c.shift())&&a.push({bookNo:h.parseInt(d,0),order:c.length>0?"@"+c.join("@"):""}),a},[]),b=h.splitAndTrim(a.topicID||"0","_"),this.bookNos=h.map(b.shift().split("."),function(a){return h.parseInt(a,0)}),this.pageNo=h.parseInt(b.shift(),0)}},{key:"syncToProjectToc",value:function(a,b,c){var d=void 0,e=void 0,f=void 0;if(this.tocPath.length>0){if(d=0,f=this.tocPath.shift(),e=h.findIndex(b,function(b){var c=void 0;return c=i.dataset(b,"childorder")||"",!(c!==f.order||!a.isBookNode(b)||(d++,d!==f.bookNo))}),e!==-1)return a.openBook(b[e],!0,function(d){return function(){return h.defer(function(){var f=void 0,g=void 0;if(f=b[e+1],g=f.children&&f.children[0])return d.syncToProjectToc(a,g.children,c)})}}(this))}else if(c)return c(b)}},{key:"syncToTocItem",value:function(a,b,c){var d=void 0,e=void 0,f=void 0;return null==c&&(c=1),e=0,d=0,f=null,h.any(b,function(b){return function(g){var j=void 0,k=void 0,l=void 0,n=void 0,o=void 0;if(k=i.dataset(g,"childorder")||"",k===b.order&&(a.isBookNode(g)&&(j=g,f=j),j&&d++,b.bookNos[0]===d)){if(a.isPageNode(g)&&(n=g),n&&e++,1===b.bookNos.length)0===b.pageNo?(o=g,f&&a.openBook(f,!0,function(){return a.updateBookInfo()})):n&&e===b.pageNo&&(o=g),a.updateBookInfo(),o&&a.selectLink(o,!0,c);else if(f&&(l=i.hasClass(g,"child")))return b.bookNos.shift(),a.openBook(f,!0,function(){return h.defer(function(){var c=void 0;if(c=g.children&&g.children[0])return b.syncToTocItem(a,c.children,m)})}),!0;return null!=o}}}(this))}}]),a}();return a}(),o=function(){var a=void 0,b=void 0,c=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0;c="expanded",a="active",b="collapsing",o="expanding",v="loading-book",w="selected",t="show_child",r="bookid",p="active_bookid",s="level",q="active_level",u=".p.toc";var x="curtoc",y="data-tocitem",z=k("KEY_TOC_BREADCRUMBS"),A=function(){function A(a){var b=this;d(this,A),this.widget=a,this.subscribeTopicID=f(this.subscribeTopicID,this),this.urls=[],this.onClick=f(this.onClick,this),this.updateBookInfo=f(this.updateBookInfo,this),this._data={},this.projectAbsRef=[],null==this.syncToc&&(this.syncToc=new n),this.widget.publish(s,0),this.widget.publish(r,"_"),rh.model.subscribe(u,function(a){b.widget.publish(x,a),b.widget.publish("curlevel",0)}),this.widget.subscribe(k("KEY_TOC_SELECT_ITEM"),this.selectTocItem.bind(this)),j.subscribe(k("KEY_TOC_BACK_BUTTON_PRESSED"),this.onBackButtonClicked.bind(this)),j.subscribeOnce([k("EVT_PROJECT_LOADED"),k("KEY_TOC_ORDER")],function(a){return function(){return j.get(k("KEY_PUBLISH_MODE"))?a.getTOCData():a.loadToc(u,"",function(){return a.widget.publish(k("EVT_TOC_LOADED"),!0),h.defer(function(){return a.widget.subscribe(rh.consts("KEY_TOPIC_ID"),a.subscribeTopicID)})})}}(this))}return e(A,[{key:"expandBook",value:function(a,b,c,d){this.selectTocItem({id:b});var e=i.getAttribute(c,"data-itemkey");rh.model.publish("EVT_TOC_LOADEDgototab",{tab:0,key:e,item:d})}},{key:"updateBookInfo",value:function(){var a=void 0,b=void 0;if(a=this.widget.get(p),null!=a&&a!==this.widget.get(r)&&this.widget.publish(r,a),b=this.widget.get(q),null!=b&&b!==this.widget.get(s))return this.widget.publish(s,b)}},{key:"updateActiveBookInfo",value:function(a,b){return this.widget.publish(p,b),this.widget.publish(q,a)}},{key:"getText",value:function(a){return a.textContent.trim()}},{key:"_getPreviousItemNode",value:function(a){var b=this.pid(i.getAttribute(a,"data-itemid"));return i.find(this.widget.node,'[data-itemid="'+b+'"]')[0]}},{key:"updateBreadcrumbInfo",value:function(a){var b=a,c=void 0,d=[];if(this.isTOCItem(a)){for(d.push(this._createBreadcrumbItem(b));c=this._getPreviousItemNode(b);)d.push(this._createBreadcrumbItem(c)),b=c;d.reverse(),d.length>0&&(d[d.length-1].lastNode=!0),h.each(d,function(a){h.extend(a,{relUrl:h.makeRelativeUrl(h.makeFullUrl(h.get(a,"url")),h.makeFullUrl(h.get(h.last(d),"url")))})}),d.curlevel=this.widget.get("curlevel"),this.widget.publish(z,d),j.publish(k("EVT_UPDATE_BREADCRUMBS"),d)}}},{key:"_createBreadcrumbItem",value:function(a){var b=a;this.hasTOCItemLink(a)||(b=this._findFirstLink(a));var c=b&&(i.getAttribute(b,"href")||i.getAttribute(b,"link"))||"#";return{id:i.getAttribute(a,"data-itemid"),text:this.getText(a),url:c,hasUrl:this.hasTOCItemLink(a),lastNode:!1}}},{key:"isTOCItem",value:function(a){return"LI"===i.nodeName(a)||i.getAttribute(a,y)}},{key:"_findFirstLink",value:function(a){var b={that:this},c=g.parentNode(a);return b.bookid=i.getAttribute(a,"data-itemid"),i.traverseNode(c,this._findLinkFn,null,null,b),b.linkNode}},{key:"_isParentTocItem",value:function(a){return this.bookNode!==a&&this.that.isTOCItem(a)}},{key:"_findLinkFn",value:function(a){var b=i.getAttribute(a,"data-itemid");return b===this.bookid&&(this.bookFound=!0),!this.bookFound||!this.that.hasTOCItemLink(a)||void 0!==this.linkNode||(this.linkNode=a,!1)}},{key:"nextLevel",value:function(a){var b=void 0;return b=h.parseInt(i.dataset(a,"itemlevel"),0),i.hasClass(a,c)?b:b+1}},{key:"onClick",value:function(a){var b=void 0,c=void 0,d=void 0,e=void 0;if(e=a.currentTarget,b=a.target,c=this.hasLink(b),d=this.getItemNode(b,e),this.isBookNode(d)&&(c&&this.selectedNode!==d&&this.isOpenBook(d)||(this.toggleBook(d,!1),this.updateBreadcrumbInfo(d))),!(!c||this.isUrlNode(d)&&this.hasExternalLink(b)))return this.selectLink(d,!1)}},{key:"selectLink",value:function(a,b,c){if(null==c&&(c=m),this.selectedNode&&(i.removeClass(this.selectedNode,w),i.removeAttribute(this.selectedNode.firstElementChild,"aria-selected")),b&&this.selectedNode!==a&&h.delay(function(){return a.scrollIntoView(!0)},c),this.selectedNode=a,a)return this.updateBreadcrumbInfo(a),j.publish(k("EVT_TOC_SELECTED_ITEM_CHANGED")),i.setAttribute(this.selectedNode.firstElementChild,"aria-selected","true"),i.addClass(a,w)}},{key:"selectTocItem",value:function(a){var b=a.id+"_0";if(b){for(var c={},d=-1;b;)d++,c[b]=!0,b=b.substr(0,b.lastIndexOf("_"));this.widget.publish("show_child",c),this.widget.publish("curlevel",d),a.url&&rh.model.publish("EVT_TOC_LOADEDgototab",{tab:0,item:{url:a.url}})}}},{key:"getItemNode",value:function(a,b){return h.findParentNode(a,b,this.isTOCItem)}},{key:"getChildItemNode",value:function(a,b){return i.find(a,function(a){return"LI"===i.nodeName(a)||i.getAttribute(a,y)})}},{key:"hasTOCItemLink",value:function(a){var b=i.getAttribute(a,"data-haslink");return"true"===b}},{key:"hasLink",value:function(a){var b=void 0;return b=i.getAttribute(a,"href"),b&&"#"!==b}},{key:"isBookNode",value:function(a){return i.hasClass(a,"book")}},{key:"isTopicNode",value:function(a){return i.hasClass(a,"item")}},{key:"isUrlNode",value:function(a){return i.hasClass(a,"url")}},{key:"isPageNode",value:function(a){return this.isTopicNode(a)||this.isUrlNode(a)}},{key:"isOpenBook",value:function(b){return this.widget.get(l)?i.hasClass(b,a):i.hasClass(b,c)}},{key:"hasExternalLink",value:function(a){var b=void 0;return b=i.getAttribute(a,"href"),!(!b||h.isRelativeUrl(b))&&!h.isUrlAllowdInIframe(b)}},{key:"getBookNode",value:function(a,b){var c=void 0;return c=this.getItemNode(a,b),this.isBookNode(c)?c:null}},{key:"animateCollapse",value:function(a){return h.each([a,a.nextElementSibling],function(a){return i.addClass(a,b),h.delay(function(){return i.removeClass(a,b)},m)})}},{key:"animateExpand",value:function(a){return h.each([a,a.nextElementSibling],function(a){return i.addClass(a,o),h.delay(function(){return i.removeClass(a,o)},m)})}},{key:"toggleBook",value:function(a,b){return null==b&&(b=!0),this.isOpenBook(a)?this.closeBook(a):this.openBook(a,b)}},{key:"onBackButtonClicked",value:function(){var a=this,b=document.getElementsByClassName("expanded active")&&document.getElementsByClassName("expanded active")[0];b&&(this.closeBook(b),h.defer(function(){a.widget.subscribe(p,function(a){var b=void 0;b="_"!==a,j.publish(rh.consts("KEY_SHOW_TOC_BACK_BUTTON"),b)})}))}},{key:"closeBook",value:function(a){var b=void 0,d=void 0;if(b=i.dataset(a,"itemid"),d=""+t+b,!1!==this.widget.get(d)&&this.widget.publish(d,!1),this.updateActiveBookInfo(this.nextLevel(a),this.pid(b)),this.updateBookInfo(),i.hasClass(a,c))return i.removeClass(a,c),this.animateCollapse(a)}},{key:"openBook",value:function(a,b,d){j.publish(rh.consts("KEY_SHOW_TOC_BACK_BUTTON"),!0);var e=void 0,f=void 0,g=void 0,h=void 0;return null==d&&(d=this.updateBookInfo),g=i.dataset(a,"itemkey"),f=i.dataset(a,"itemid"),e=i.dataset(a,"childorder"),h=""+t+f,!0!==this.widget.get(h)&&this.widget.publish(h,!0),this.updateActiveBookInfo(this.nextLevel(a),f),this.widget.get(g)?(i.hasClass(a,c)||(i.addClass(a,c),this.animateExpand(a)),d()):(i.addClass(a,v),b&&a.scrollIntoView(!1),this.loadToc(g,e,function(b){return function(){return i.removeClass(a,v),i.addClass(a,c),b.animateExpand(a),d()}}(this)))}},{key:"extractTempData",value:function(a){var b=void 0;return a&&"error"===a.type?b=[]:(b=this.widget.get(rh.consts("KEY_TEMP_DATA")),this.widget.publish(rh.consts("KEY_TEMP_DATA")),b)}},{key:"loadToc",value:function(a,b,c){var d=void 0,e=void 0,f=void 0,g=void 0;return g=this.parseKey(a),d=g.absRef,e=g.key,f=d?d+"/":"",h.loadScript(f+"whxdata/"+e+".new.js",!0,function(e){return function(f){var g=void 0;return g=e.extractTempData(f)||[],h.each(g,function(a){if(a.absRef=d,"remoteitem"===a.type&&(a.url=a.url&&decodeURI(a.url)),b)return a.childOrder=b}),e.loadRefToc(g,function(b){if(e.widget.publish(a,b),c)return c()})}}(this))}},{key:"loadRefToc",value:function(a,b){var c=this,d=void 0,e=void 0,f=void 0;if(null==a&&(a=[]),e=h.findIndex(a,function(a){if(a.ref)return!0}),e!==-1){f=a[e],d=f.absRef||"",d&&(d+="/"),d+=f.ref;var g=j.get(k("KEY_TOC_ORDER")),i="";return g[d]&&(i=g[d].order),h.loadScript(d+"/whxdata/toc.new.js",!0,function(f){var g=void 0;return g=c.extractTempData(f)||[],h.each(g,function(a){if(a.absRef=d,i)return a.childOrder=i}),Array.prototype.splice.apply(a,[e,1].concat(g)),c.loadRefToc(a,b)})}if(b)return b(a)}},{key:"getTOCData",value:function(){return j.subscribeOnce(k("KEY_PUBLISH_BASE_URL"),function(a){return function(){var b;try{return j.subscribe(k("KEY_PROJECT_LIST"),function(b){return j.subscribe(k("KEY_MASTER_PROJECT_LIST"),function(c){var d,e;return e=c.length,d=[],h.each(c,function(a){return a=h.makeRelativeUrl(a,b[0]),a&&(a+="/"),h.loadScript(a+"whxdata/toc.new.js",!0,function(b){return function(c){var f;return f=b.extractTempData(c)||[],h.each(f,function(b){b.absRef=a}),b.loadRefToc(f,function(a){if(e--,d=d.concat(a),0===e)return b.widget.publish(u,d),b.widget.publish(k("EVT_TOC_LOADED"),!0),b.widget.subscribe(rh.consts("KEY_TOPIC_ID"),b.subscribeTopicID)})}}(this))},a)})})}catch(c){if(b=c,rh._debug)return rh._d("warn",b.message)}}}(this))}},{key:"nextChildOrder",value:function(a){var b=void 0;return b=a.split("@"),b[b.length-1]=1+h.parseInt(b[b.length-1],0),b.join("@")}},{key:"childOrder",value:function(a){return a?a+"@1":"@1"}},{key:"pid",value:function(a){var b=void 0;return b=a.split("_"),b.pop(),b.join("_")||"_"}},{key:"key",value:function(a,b){var c=void 0;return null==a&&(a=""),c=h.findIndex(this.projectAbsRef,function(b){return b===a}),c===-1&&(c=this.projectAbsRef.length,this.projectAbsRef.push(a)),".p.child_toc."+c+"."+b}},{key:"parseKey",value:function(a){var b=void 0,c=void 0,d=void 0;return a=a.substring(3),c=a.split("."),d=c.pop(),b=this.projectAbsRef[c.pop()]||"",{key:d,absRef:b}}},{key:"url",value:function B(a,b){var c=void 0,d=void 0,e=void 0,f=void 0,B=void 0;return a.url?"remoteitem"===a.type?encodeURI(a.url):(f=a.absRef?h.ensureSlash(a.absRef):"",B=""+f+a.url,c=h.extractHashString(B),(a.tocid||c.length>0)&&(c=c&&"#"+c,d=h.filePath(B),e=h.extractParamString(B),e.length>0&&(e+="&"),a.tocid&&(e="?"+e+"rhtocid=_"+a.tocid),B=""+d+e+(c||"")),this.urls.push(B),encodeURI(B)):"#"}},{key:"tags",value:function(a){var b=void 0;return b=a.absRef?"+"+a.absRef:"",a["data-rhtags"]?a["data-rhtags"]+b:""}},{key:"subscribeTopicID",value:function(a){var b=this,c=void 0,d=void 0;null==a&&(a={}),d=h.hashParams().rhtocid,d?(c=this.getPathfromId(d),this.selectTocById(c,this.widget.node)):rh.model.subscribe(rh.consts("KEY_MASTER_PROJECT_LIST"),function(c){return b.syncToc.sync(b,a)})}},{key:"subscribeBookId",value:function(a){var b=void 0,c=void 0;if(a)return c=this.getPathfromId(a),this.selectTocById(c,this.widget.node,null,b)}},{key:"getPathfromId",value:function(a){var b=void 0;return b=a.split("_"),b.shift(),b=h.map(b,function(a){return h.parseInt(a,0)})}},{key:"selectTocById",value:function(a,b,c,d){var e=void 0,f=void 0;if(null==c&&(c=1),b&&b.children&&(f=a.shift(),e=h.find(b.children,function(a){if(this.isBookNode(a)||this.isPageNode(a)){if(0===f)return!0;f--}return!1},this)))return 0===a.length&&this.selectLink(e,!0,c),this.isBookNode(e)?this.openBook(e,!0,function(b){return function(){return h.defer(function(){var c=void 0,d=void 0;return 0===a.length?b.updateBookInfo():(c=e.nextElementSibling,d=c.children&&c.children[0],b.selectTocById(a,d,m))})}}(this)):this.updateBookInfo()}}]),A}();return A.prototype["class"]=function(a){return"remoteitem"===a.type?"url":a.type},A}(),rh.controller("TocController",o)},{"../../src/lib/rh":25,"../../src/responsive_help/utils/node_utils":68}],6:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../src/lib/rh"),f=rh._,g=(rh.$,rh.model),h=rh.consts,i=function(){function a(){var b=this;d(this,a),this.data={"":{order:"",nextChild:0}},g.subscribeOnce(h("KEY_PROJECT_LIST"),function(a){f.each(a,function(c){c=f.makeRelativeUrl(b.trimFirst(c,"."),a[0]),b.childOrder(c)}),g.publish(h("KEY_TOC_ORDER"),b.data)})}return e(a,[{key:"trimFirst",value:function(a,b){return a=a.length&&a[0]===b&&a[1]!==b?a.substring(1):a}},{key:"childOrder",value:function(a){if(a=this.trimFirst(a,"/"),!this.data[a]){var b=a;b=b.substring(0,b.lastIndexOf("/")),b=b.substring(0,b.lastIndexOf("/"));var c=this.data[b];c.nextChild++,this.data[a]={order:c.order+"@"+c.nextChild,nextChild:0}}return this.data[a].order}}]),a}();new i},{"../../src/lib/rh":25}],7:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=window,rh=e.rh,f=rh._,g=(rh.$,function h(){d(this,h);var a=function(a){var b=rh.model.get("t.brsmap");if(null!=b){var c=b.n&&b.n[0]||"",d=b.p&&b.p[0]||"",e=window.decodeURI(document.location.href);return f.isEmptyString(c)||(c=window._getRelativeFileName(e,c)),f.isEmptyString||(d=window._getRelativeFileName(e,d)),rh.model.publish("l.brsBack",d),rh.model.publish("l.brsNext",c)}},b=function(){var a=rh.model.get(rh.consts("KEY_UI_MODE")),b=rh.model.get("l.brsBack"),c=rh.model.get("l.brsNext"),d=!(a||!b&&!c);return rh.model.publish("l.show_brs",d)};rh.model.subscribe("t.topicurl",f.debounce(a,200)),rh.model.subscribe("t.brsmap",f.debounce(a,200)),rh.model.subscribe("l.brsBack",b),rh.model.subscribe("l.brsNext",b),rh.model.subscribe(rh.consts("KEY_UI_MODE"),b)});rh.widgets.BrowseSequenceBuilder=g},{}],8:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=window,rh=f.rh,g=rh._,h=(rh.$,rh.consts),i=rh.storage,j=rh._params.filter,k=function(){var a=void 0,b=void 0,c=void 0;return k=function(){function f(a){d(this,f),this.getUnchecked=this.getUnchecked.bind(this),this.handleTagStates=this.handleTagStates.bind(this),i.init(h("HELP_ID")),this.allTagNames=this.computeNames(rh.model.get(h("KEY_MERGED_FILTER_KEY"))),this.prepareTagStates(),this.handleTagStates(rh.model.get(h("KEY_PROJECT_TAG_STATES"))),rh.model.subscribe(h("KEY_PROJECT_TAG_STATES"),g.debounce(this.handleTagStates,300),{initDone:!0})}return e(f,null,[{key:"initClass",value:function(){a=":",b=";",c=","}}]),e(f,[{key:"computeNames",value:function(a){return g.reduce(a,function(a,b){return a.push(b.children?this.computeNames(b.children):b.name),a},[],this)}},{key:"getUnchecked",value:function(a,b){return g.filter(this.allTagNames[a],function(a){return-1===b.indexOf(a)})}},{key:"computeExpression",value:function(a){if(!a||!this.allTagNames)return rh.model.publish(h("KEY_TAG_EXPRESSION"),[]);var b=g.reduce(a,function(a,b,c){if(g.isString(b))a.push({c:[b],u:[]});else if(null!=b){var d=void 0;(d=g.compact(b))&&d.length>0&&a.push({c:d,u:this.getUnchecked(c,d)})}return a},[],this);return rh.model.publish(h("KEY_TAG_EXPRESSION"),b)}},{key:"handleTagStates",value:function(a){return null==a&&(a={}),this.computeExpression(a),i.persist("tag_states",a)}},{key:"prepareTagStates",value:function(){var a=this;return rh.model.subscribe(h("KEY_PROJECT_FILTER_TYPE"),function(){var b=void 0;if(j){var d=rh.model.get(h("KEY_MERGED_FILTER_KEY"));b=a.parseUrlFilter(d,j.split(c))}if(b||(b=i.fetch("tag_states")),b||(b=g.clone(rh.model.get(h("KEY_DEFAULT_FILTER")))),b)return rh.model.publish(h("KEY_PROJECT_TAG_STATES"),b)})}},{key:"parseFilterElemnt",value:function(c,d){var e=d.split(a),f=e[0],h=e[1]&&e[1].split(b),i=g.findIndex(c,function(a){return null!=h==(null!=a.children)&&a.display===f});return{index:i,elements:h}}},{key:"parseUrlFilter",value:function(a,b){if(b||b.length){var c="radio"===rh.model.get(h("KEY_PROJECT_FILTER_TYPE")),d=!0;return g.reduce(b,function(b,e,f){var g=void 0,h=this.parseFilterElemnt(a,e);if(f=h.index,g=h.elements,f!==-1){var i=a[f];i.children?b[f]=this.parseUrlFilter(i.children,g):c&&!d||(d=!1,b[f]=i.name)}return b},{},this)}}}]),f}(),k.initClass(),k}();rh.widgets.ExpressionBuilder=k},{}],9:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];
d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=window,rh=f.rh,g=rh._,h=rh.$,i=rh.consts,j=function(){var a=void 0,b=void 0,c=void 0;return j=function(){function f(a){d(this,f),this.click=this.click.bind(this),this.widget=a}return e(f,null,[{key:"initClass",value:function(){a="group",b="item",c=i("KEY_PROJECT_FILTER_TYPE")}}]),e(f,[{key:"click",value:function(a){var b=a.currentTarget,c=a.target,d=this.getItemNode(c,b),e=""+i("KEY_PROJECT_TAG_STATES")+this.getItemKey(d),f=this.widget.get(e);return"radio"!==this.filterType()?this.handleCheckboxClick(d,e,f):this.handleRadioClick(d,e,f),g.preventDefault(a)}},{key:"handleRadioClick",value:function(a,b,c){if(!this.isGroupNode(a)&&!c){var d=g.splitKey(b),e=d.parentKey,f=d.key,h={};return h[f]=this.getItemValue(a),this.widget.publish(e,h)}}},{key:"handleCheckboxClick",value:function(a,b,c){var d=void 0;if(this.isGroupNode(a)){var e=g.any(c,function(a){return a});return d=e?void 0:this.getGroupItemExprs(a),this.widget.publish(b,d)}return d=c?void 0:this.getItemValue(a),this.widget.publish(b,d)}},{key:"getItemNode",value:function(a,b){return g.findParentNode(a,b,function(a){return"LI"===h.nodeName(a)})}},{key:"getItemValue",value:function(a){return h.dataset(a,"itemvalue")}},{key:"getGroupItemExprs",value:function(a){var b=h.dataset(a,"itemkey"),c=this.widget.get(""+this.widget.key+b);return g.map(c.children,function(a){return a.name})}},{key:"getItemKey",value:function(a){return h.dataset(a,"itemkey")}},{key:"isGroupNode",value:function(b){return h.hasClass(b,a)}},{key:"isItemNode",value:function(a){return h.hasClass(a,b)}},{key:"class",value:function(c){return c.children?a:b}},{key:"value",value:function(a){return a.children?null:a.name}},{key:"filterType",value:function(){return this.widget.get(c)||"checkbox"}},{key:"inputType",value:function(a){var b=this.filterType();return a.children&&"radio"===b&&(b=void 0),b}}]),f}(),j.initClass(),j}();rh.controller("FilterController",j)},{}],10:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=window,rh=f.rh,g=rh.model,h=rh._,i=rh.consts,j=rh.apiClient,k=rh.rhs,l=function(){var a=void 0;return l=function(){function b(){d(this,b);var c=3e3;g.subscribeOnce(i("EVT_PROJECT_LOADED"),function(){return g.subscribeOnce(i("KEY_PUBLISH_MODE"),function(b){if(b){var d=d||a(),e=[],f=h.debounce(function(){return j.post(d,JSON.stringify(e)).error(function(a,b){if(rh._debug)return rh._d("error","Filter report status ",b)})},c,!1);return g.subscribe(i("KEY_TAG_EXPRESSION"),function(a){e=[];var b=rh.model.get(i("KEY_MERGED_FILTER_KEY")),c=!0,d=!1,g=void 0;try{for(var h,j=Array.from(a)[Symbol.iterator]();!(c=(h=j.next()).done);c=!0){var k=h.value,l=!0,m=!1,n=void 0;try{for(var o,p=Array.from(k.c)[Symbol.iterator]();!(l=(o=p.next()).done);l=!0){var q,r=o.value;(q=rh.filterObject.lookup(b,r,!1))&&e.push(q.display)}}catch(s){m=!0,n=s}finally{try{!l&&p["return"]&&p["return"]()}finally{if(m)throw n}}}}catch(s){d=!0,g=s}finally{try{!c&&j["return"]&&j["return"]()}finally{if(d)throw g}}if(e.length>0)return f()})}})})}return e(b,null,[{key:"initClass",value:function(){a=function(){var a=document.location.origin,b=g.get(i("KEY_PUBLISH_BASE_URL")).substr(a.length);if(b&&!h.isEmptyString(b)){var c=h.mapToEncodedString(h.extend(h.addPathNameKey({area:k.area(),prj:k.project(),type:k.type(),agt:"fltRpt",mgr:"agm"})));return b+"?"+c}}}}]),b}(),l.initClass(),l}();new l},{}],11:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=rh._,f=rh.$,g=rh.consts,h=rh.model,i=rh.KEYS;h.publish(g("KEY_SHOW_TAGS"),"true"===rh._params.showtags),h.publish(g("KEY_IFRAME_EVENTS"),{click:!0});var j=void 0,k={},l=function(){var a=e.hashParams();return h.publish(g("EVT_HASH_CHANGE"),{oldMap:k,newMap:a},{sync:!0}),k=a},m=function(){var a=e.extractParamString(document.location.href),b=e.urlParams(a),c=e.extractHashString(document.location.href),d=e.hashParams(c),f=g("RHMAPNO"),h=g("HASH_KEY_TOPIC");if(!(f in b||h in d))return document.location=g("DEFAULT_TOPIC")};e.addEventListener(window,"hashchange",l),e.addEventListener(window,"orientationchange",function(a){if(h.publish(g("EVT_ORIENTATION_CHANGE"),null),h.get(g("KEY_SCREEN_IPAD"))){var b=void 0;if(b=e.getTopicFrame()){var c=b.style.display;return b.style.display="none",b.offsetHeight,e.defer(function(){return b.style.display=c,e.delay(function(){return b.offsetHeight,e.delay(function(){return b.offsetHeight},500)},200)})}}}),h.subscribe(g("EVT_WIDGET_LOADED"),function(){var a=void 0;h.subscribe(g("KEY_MERGED_FILTER_KEY"),function(){return new rh.widgets.ExpressionBuilder}),new rh.widgets.BrowseSequenceBuilder,l(),rh.layoutPrint=window.print,window.print=function(){return h.publish(g("EVT_PRINT_TOPIC"),null)},e.addEventListener(document,"keyup",function(a){a.ctrlKey&&a.keyCode===i.HOME&&h.publish(g("EVT_FOCUS_ELEMENT_IN_IFRAME"),null)});var b=e.getFileName(document.location.href);if(b===g("TOPIC_FILE")){var c=m();if(c)return c}if(a=e.getTopicFrame())return a.onload=function(){var a=h.get(g("KEY_TOPIC_IN_IFRAME"));if(j&&a!==j){var b=e.extractHashString(a);b=e.isEmptyString(b)?null:"#"+f.cssEscape(b),h.publish(g("EVT_FOCUS_ELEMENT_IN_IFRAME"),b)}j=a,h.publish(g("EVT_TOPIC_LOADED"),null),h.publish(g("EVT_UPDATE_BREADCRUMBS"),h.get(g("KEY_TOC_BREADCRUMBS")))};var d=e.extractParamString(document.location.href),k=e.urlParams(d),n=g("RHMAPNO");return n in k?document.location=g("TOPIC_FILE")+"?"+d:void 0}),h.subscribe(g("EVT_BOOKMARK")+"#content_top_placeholder",function(){return h.publish(g("EVT_SCROLL_TO_TOP"),null)}),h.subscribe(g("KEY_PROJECT_LIST"),function(){return rh.filterObject=new rh.MergeProj}),h.subscribe(g("EVT_PROJECT_LOADED"),function(){var a="deviceready";return document.addEventListener(a,function(){if(null!=window.cordova)return h.publish(g("KEY_MOBILE_APP_MODE"),!0)})}),h.subscribe(g("GO_TO_DEFAULT_TOPIC"),function(){e.goToDefaultTopic()})},{}],12:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){var rh=void 0,a=void 0,b=void 0;return f=function(){function c(e,f){d(this,c);var g=(null!=f?f.removeClasses:void 0)||["hide-children","loading"];b.each(g,function(b){return a.removeClass(e.node,b)}),b.each(null!=f?f.addClasses:void 0,function(b){return a.addClass(e.node,b)})}return e(c,null,[{key:"initClass",value:function(){var c=window;rh=c.rh;var d=rh;a=d.$;var e=rh;b=e._}}]),c}(),f.initClass(),f}();window.rh.controller("JsLoadingController",f)},{}],13:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=(rh._,rh.$),f=rh.consts;rh.model.subscribe(f("EVT_WIDGET_BEFORELOAD"),function(){if(null!==e("a.wShow",0)){var a=e(".contenttopic",0);return e.setAttribute(a,"data-rhwidget","Basic"),e.setAttribute(a,"data-class","govt_csh:@.l.csh_mode;govt_nocsh:!@.l.csh_mode")}})},{}],14:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=window,rh=f.rh,g=rh._,h=rh.model,i=rh.consts,j=function(){var a=void 0,b=void 0,c=void 0,f=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0;return j=function(){function j(){d(this,j),a.push("."),b.push("."),c.push("."),p()}return e(j,null,[{key:"initClass",value:function(){a=[],b=[],c=[],f="projectdata.js",k="remote",l="project",m="url",n=0,o=function(d){var e=d+"/"+f;return window.xmlJsReader.loadFile(e,function(d,e){var f=void 0,j=0;if(n++,null!=d){var o=d.getElementsByTagName(l)[0];f=o.getElementsByTagName(k),j=f.length}else if(e.length>0){var q=b.indexOf(e[0]);q>-1&&b.splice(q,1)}if(g.each(f,function(d){var f=e+"/"+d.getAttribute(m);return a.push(f),b.push(f),c.push(f)}),p(),0===c.length&&n===a.length)return h.publish(i("KEY_PROJECT_LIST"),b),h.publish(i("KEY_MASTER_PROJECT_LIST"),["."])},d)},p=function(){return function(){for(var a=[];c.length>0;){var b=c.splice(0,1);a.push(o(b))}return a}()}}}]),j}(),j.initClass(),j}();h.subscribe(i("EVT_PROJECT_LOADED"),function(){return g.defer(function(){if(!h.get(i("KEY_PUBLISH_MODE"))&&!window.gbPreviewMode)return new j})})},{}],15:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){var rh=void 0,a=void 0,b=void 0,c=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0;return f=function(){function f(a){var b=this;d(this,f),this.triggerDelayLoadWidgets=this.triggerDelayLoadWidgets.bind(this),this.widget=a,this.init(),this.subscribeActiveTab(),this.subscribeToLocations(),this.subscribeScreens(),this.widget.subscribe(c("EVT_PROJECT_LOADED"),function(){return b.subscribeUIMode(),b.subscribeMergedFilter(),b.subscribeTopicClick(),b.subscribeTopicScroll(),b.subscribForSearchResult(),b.subscribeTopicNavigate(),b.subscribeToDelayLoadEvents(),b.widget.publish(c("KEY_IFRAME_EVENTS"),{click:!0,scroll:!1})})}return e(f,null,[{key:"initClass",value:function(){var d=window;rh=d.rh;var e=rh;a=e._;var f=rh;b=f.$;var u=rh;c=u.consts,g=c("KEY_FEATURE"),h=c("KEY_FILTER_LOCATION"),i=c("KEY_SEARCH_LOCATION"),j=c("KEY_ACTIVE_TAB"),k=c("KEY_UI_MODE"),l=c("KEY_MOBILE_TOC_DRILL_DOWN"),m=c("KEY_TOC_DRILL_DOWN"),n="desktop",o="tablet",p="phone",q="filter"!==rh._params.hideUI,r={desktop:["toc","idx","glo","filter","fts"],tablet:["toc","idx","glo","filter","fts"],phone:["toc","idx","glo","filter","fts"]},s={desktop:["toc","idx","glo","filter","fts"],tablet:["toc","idx","glo","filter","fts"],phone:["toc","idx","glo"]},t={idx:{evt:"EVT_LOAD_IDX",f_key:"delay_load_idx"},glo:{evt:"EVT_LOAD_GLO",f_key:"delay_load_glo"}}}}]),e(f,[{key:"init",value:function(){return this.screens=this.widget.get(c("KEY_SCREEN_NAMES")),rh.storage.init(c("HELP_ID")),this.activeScreen=a.find(this.screens,function(a){return this.widget.get(c("KEY_SCREEN")+"."+a+".attached")},this),null==this.activeScreen&&(this.activeScreen=this.widget.get(c("KEY_DEFAULT_SCREEN"))),this.assureLocations(this.activeScreen),this.initDefauls(),this.initActiveTab()}},{key:"initDefauls",value:function(){var b=this.widget.get(c("KEY_DEFAULT_TAB"));return this.hasFeature(b)||(b=null),this.defaultTabs={},a.each(this.screens,function(c){return r[c]=a.filter(r[c],function(a){return this.hasFeature(a)},this),s[c]=a.filter(s[c],function(a){return this.hasFeature(a)},this),this.defaultTabs[c]=b&&-1!==r[c].indexOf(b)?b:r[c][0]},this)}},{key:"initActiveTab",value:function(){var a=rh.storage.fetch("activetab");if(void 0!==a&&a&&this.hasFeature(a))return this.widget.publish(j,a)}},{key:"isValidTab",value:function(a,b){return null==b&&(b=this.activeScreen),!(!a||!this.hasFeature(a))&&((b!==n||!("filter"===a&&"content"===this.widget.get(h)||"fts"===a&&"content"===this.widget.get(i)))&&-1!==r[b].indexOf(a))}},{key:"defaultTab",value:function u(b){null==b&&(b=this.activeScreen);var u=this.defaultTabs[b];return this.isValidTab(u)||(u=a.find(r[b],function(a){return this.isValidTab(a)},this)),u}},{key:"assureValidActiveTab",value:function(a){null==a&&(a=this.activeScreen);var b=this.widget.get(j);if(a===n||b)return this.isValidTab(b)||(b=this.defaultTab()),this.widget.publish(j,b)}},{key:"toggleSideBar",value:function(){return this.widget.get(j)?this.widget.publish(j,null):this.widget.publish(j,this.lastMobileTab||this.defaultTab())}},{key:"toggleActiveTab",value:function(a){return this.widget.publish(j,this.isDesktopScreen()||a!==this.widget.get(j)?a:null)}},{key:"navigateTabList",value:function(b,c){var d=null;if("Return"===b.key||" "===b.key)return this.toggleActiveTab(c);if(d="ArrowRight"===b.key||"ArrowDown"===b.key||"ArrowLeft"!==b.key&&"ArrowUp"!==b.key&&null,null!==d){var e=b.target.parentElement;if(e){var f=e.children,g=a.findIndex(f,function(a){return 0==a.getAttribute("tabindex")});return d===!0?g===f.length-1?g=0:g++:d===!1&&(0===g?g=f.length-1:g--),a.each(f,function(a,b){a.setAttribute("tabindex",b===g?0:-1),b===g&&a.focus()}),!1}}}},{key:"triggerDelayLoadWidgets",value:function(a){var b=t[a];if(b&&this.hasFeature(b.f_key))return this.widget.publish(c(b.evt),!0)}},{key:"subscribeToDelayLoadEvents",value:function(){return this.widget.subscribe(j,this.triggerDelayLoadWidgets)}},{key:"filterDone",value:function(){return this.widget.publish(j,this.searchMode?"fts":null)}},{key:"hasFeature",value:function(a){return void 0===a||!1!==this.widget.get(g+"."+a)}},{key:"subscribeUIMode",value:function(){var a=this,b=function(){if(a.isValidTab("fts"))return a.isDesktopScreen()&&"tabbar"!==a.widget.get(i)?void 0:a.widget.publish(j,"fts")};if(this.widget.subscribe(k,function(b){return a.widget.publish("active_content",b)}),this.widget.subscribe("active_content",function(c){return a.isMobileScreen()&&!c?a.widget.publish(j,null):"search"===c?b():void 0},{initDone:!0}),"search"===this.widget.get("active_content"))return b()}},{key:"subscribeMergedFilter",value:function(){var a=this,b=void 0;if(this.widget.get(b=g+".filter"))return this.widget.subscribe(c("KEY_MERGED_FILTER_KEY"),function(c){return a.widget.publish(b,!!(c&&c.length&&q)),a.assureValidActiveTab()})}},{key:"subscribeTopicClick",value:function(){var a=this;return this.widget.subscribe(c("EVT_CLICK_INSIDE_IFRAME"),function(){if(a.activeScreen===p&&a.widget.get(j))return a.toggleSideBar()})}},{key:"subscribeTopicNavigate",value:function(){var b=this;return this.widget.subscribe(c("EVT_NAVIGATE_TO_URL"),function(c){if(c.absUrl&&a.isUrlAllowdInIframe(c.absUrl))return b.widget.publish("active_content",null)})}},{key:"subscribeTopicScroll",value:function(){var a=this;return this.widget.subscribe(c("EVT_SCROLL_INSIDE_IFRAME"),function(b){var c="down"===b.dir||b.scrollTop>10;a.widget.publish("hide_header",c);var d="down"===b.dir&&b.scrollTop>10;return a.widget.publish("hide_mobile_functions",d)})}},{key:"subscribeActiveTab",value:function(){var a=this;return this.widget.subscribe(j,function(b){return rh.storage.persist("activetab",b),a.setFocusInTab(b),a.isMobileScreen()?(a.isSidebarTab(b)&&(a.lastMobileTab=b),a.searchMode="fts"===b||a.searchMode&&"filter"===b):a.searchMode=!1})}},{key:"setFocusInTab",value:function(b){var c;switch(b){case"fts":c="wSearchField";break;case"idx":c="IdxFilter";break;case"glo":c="GloFilter";break;default:return}var d=document.getElementsByClassName(c);d&&d.length&&a.defer(function(){d[0].focus()})}},{key:"subscribeScreens",value:function(){return a.each(this.screens,function(a){var b=this,d=c("KEY_SCREEN")+"."+a+".attached";return this.widget.get(d)&&this.handleScreen(!0,a),this.widget.subscribe(d,function(c){return b.handleScreen(c,a)},{initDone:!0})},this)}},{key:"subscribeToLocations",value:function(){var a=this;return this.widget.subscribe(i,function(){return a.assureValidActiveTab(a.activeScreen)}),this.widget.subscribe(h,function(){return a.assureValidActiveTab(a.activeScreen)})}},{key:"subscribForSearchResult",value:function(){var b=this,d=function(){var a=b.widget.get(c("KEY_TAG_EXPRESSION")),d=b.widget.get(c("KEY_ONSEARCH_TAG_EXPR"));if(d&&d!==JSON.stringify(a))return b.widget.publish(c("EVT_SEARCH_TERM"),!0)};return this.widget.subscribe(c("KEY_TAG_EXPRESSION"),a.debounce(function(){if((!b.isValidTab("fts")||"fts"===b.widget.get(j))&&b.isSearchMode(b.widget.get(j)))return d()},300)),this.widget.subscribe(j,function(a){if("fts"===a)return d()})}},{key:"isMobileScreen",value:function(){return this.activeScreen===p}},{key:"isDesktopScreen",value:function(){return this.activeScreen===n}},{key:"isTabletScreen",value:function(){return this.activeScreen===o}},{key:"isSidebarTab",value:function(a){return a&&-1!==s[this.activeScreen].indexOf(a)}},{key:"isSearchMode",value:function(a){var b=this.widget.get("active_content");return"fts"===a||"search"===b&&this.isDesktopScreen()&&"content"===this.widget.get(i)}},{key:"handleScreen",value:function(a,b){return a?(this.activeScreen=b,this.handleAttached(b)):this.handleDetached(b)}},{key:"handleDetached",value:function(b){var c=this;return a.defer(function(){if(b===n)return c.widget.publish(j,"search"===c.widget.get("active_content")&&c.isValidTab("fts")?"fts":null)})}},{key:"handleAttached",value:function(a){return this.assureLocations(a),this.assureValidActiveTab(a),this.assureTOCMode(a)}},{key:"assureLocations",value:function(a){return null==a&&(a=this.activeScreen),this.widget.publish(i,a===n?this.widget.get(c("KEY_DEFAULT_SEARCH_LOCATION")):a===o?"tabbar":"content"),this.widget.publish(h,a===n||a===o?"tabbar":"content")}},{key:"assureTOCMode",value:function(a){return null==a&&(a=this.activeScreen),this.widget.publish(m,a!==n&&this.widget.get(l))}},{key:"newSearch",value:function(a,b,c){return}},{key:"isTagStatesChanged",value:function(){var b=a.compactObject(this.widget.get(c("KEY_PROJECT_TAG_STATES"))),d=a.compactObject(this.widget.get(c("KEY_DEFAULT_FILTER")));return!a.isEqual(b,d)}},{key:"setDefaultTagStates",value:function(){var b=this.widget.get(c("KEY_DEFAULT_FILTER"));return this.widget.publish(c("KEY_PROJECT_TAG_STATES"),a.clone(b))}}]),f}(),f.initClass(),f}();window.rh.controller("ModernLayoutController",f)},{}],16:[function(a,b,c){"use strict";(function(){var a,b,c,d,rh;rh=window.rh,d=rh.model,b=rh._,c=rh.consts,a=function(){function a(){this.tagCombs=[],this.idmap={},this.filter=[],this.grpType="group",this.dataLoaded=!1,this.loadTagData(d.get(c("KEY_PROJECT_LIST"))),this.caption=this.type=this.defFilter=void 0}var e;return a.prototype.updateTagCombs=function(a){var e,f;if(f=d.get(c("KEY_PROJECT_TAG_COMBINATIONS")),null!=f)return a=b.parseProjectName(a),null!=(e=this.idmap)[a]?e[a]:e[a]=f},a.prototype.lookup=function(a,b,c){var d,e,f,g,h;if(null==c&&(c=!0),null!=a&&null!=b)for(g=0,h=a.length;g<h&&(d=a[g],null==d||(e=d.name||d.display,c===(null!=d.children)&&e===b?f=d:null==d.children||c||(f=this.lookup(d.children,b,c)),null==f));g++);return f},e=function(a){var b;return b={type:"group",display:a,children:[]}},a.prototype.addTag=function(a,b){var c;if(null==this.lookup(this.filter,b.name,!1))return c={display:b.display,name:b.name},a.push(c)},a.prototype.addGroup=function(a){var b,c,d,f,g;for(c=this.lookup(this.filter,a.display),null==c&&(c=e(a.display),this.filter.push(c)),g=a.children,d=0,f=g.length;d<f;d++)b=g[d],null!=b&&null==b.children&&this.addTag(c.children,b);if(0===c.children.length&&this.filter.indexOf(c)>-1)return this.filter.splice(this.filter.indexOf(c),1)},a.prototype.updateFilter=function(a){var c,e,f,g,h;for(c=b.extractTempData(a,d,{}),this.caption||(this.caption=c.caption),this.type||(this.type=c.type),"undefined"==typeof this.defFilter&&(this.defFilter=c["default"]),c=c.tags||[],h=[],f=0,g=c.length;f<g;f++)e=c[f],null!=e&&(null!=e.children?h.push(this.addGroup(e)):h.push(this.addTag(this.filter,e)));return h},a.prototype.onLoadScript=function(a,b,e){if(this.updateTagCombs(b),this.updateFilter(a),!e)return d.publish(c("KEY_MERGED_FILTER_KEY"),this.filter),d.publish(c("KEY_MERGED_PROJECT_MAP"),this.idmap),d.publish(c("KEY_PROJECT_FILTER_CAPTION"),this.caption),d.publish(c("KEY_PROJECT_FILTER_TYPE"),this.type),d.publish(c("KEY_DEFAULT_FILTER"),this.defFilter),this.dataLoaded=!0},a.prototype.loadTagData=function(a){var d,e,f,g,h;if(!this.dataLoaded){d=a.length,h=[];var i={project:g,count:d};for(e=0,f=a.length;e<f;e++)g=a[e],null!=g?(g&&(g+="/"),i.project=g,h.push(b.loadScript(""+g+c("PATH_PROJECT_TAGDATA_FILE"),!1,this.getLoadCallback(i)))):h.push(void 0);return h}},a.prototype.getLoadCallback=function(a){var b=this,c=a.project;return function(d){return b.onLoadScript(d,c,--a.count)}},a}(),rh.MergeProj=a}).call(void 0)},{}],17:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=rh._,f=rh.consts,g=rh.model,h=null;h=g.subscribe(f("KEY_TAG_EXPRESSION"),function(){var a=!1;return function(){if(h&&h(),!a)return a=!0,g.subscribe(f("KEY_SEARCHED_TERM"),function(){return g.publish(f("KEY_ONSEARCH_TAG_EXPR"),JSON.stringify(g.get(f("KEY_TAG_EXPRESSION"))))})}}()),g.subscribe(f("EVT_SEARCH_TERM"),function(){var a=g.get(f("KEY_CAN_HANDLE_SEARCH")),b=g.get(f("KEY_SEARCH_TERM"))||null,c={};c[f("HASH_KEY_RH_SEARCH")]=b,c[f("HASH_KEY_UIMODE")]="search",g.publish(f("DESKTOP_SIDEBAR_VISIBLE"),!0);var d="tabbar"===g.get(f("KEY_DEFAULT_SEARCH_LOCATION"));d&&g.publish(f("KEY_ACTIVE_TAB"),"fts");var h=e.urlParam(f("HASH_KEY_RH_HIGHLIGHT"),document.location.href);return b!==h&&(c[f("HASH_KEY_RH_HIGHLIGHT")]=""),a!==!0?document.location=window.gRootRelPath+"/"+(window.gSearchPageFilePath||f("START_FILEPATH"))+("?#"+e.mapToEncodedString(c)):(g.publish(f("EVT_QUERY_SEARCH_RESULTS"),!0),e.defer(function(){return e.updateHashMap(c,!0)}))}),g.subscribe(f("EVT_PROJECT_LOADED"),function(){return rh.model.get(rh.consts("KEY_CLASSIC_OUTPUT"))&&window.readSetting(RHANDSEARCH,function(a){return g.publish(f("KEY_AND_SEARCH"),a)}),g.subscribe(f("KEY_AND_SEARCH"),function(a){if(rh.model.get(rh.consts("KEY_CLASSIC_OUTPUT")))return saveSetting(RHANDSEARCH,"1"===a?"1":"0",!0)})}),g.subscribe(f("EVT_QUERY_SEARCH_RESULTS"),function(){if(rh.model.get(rh.consts("KEY_CLASSIC_OUTPUT")))return window.doSearch()})},{}],18:[function(a,b,c){"use strict";var d=window,rh=d.rh,e=rh._,f=rh.$,g=rh.consts,h=rh.model;e.getRootUrl=function(){var a=null;return function(){return null!=a?a:a=""+e.getHostFolder()+g("START_FILEPATH")}}(),e.getDefaultTopic=function(a){var b=window.gDefaultTopic&&window.gDefaultTopic.substring(1);if(b&&b.endsWith("rhpj")){var c="./mergedProjects/"+b.substring(0,b.length-5),d=c+"/whxdata/projectsettings.js";e.loadScript(d,!0,function(){b=e.exports(),b=c+"/"+b,window.gDefaultTopic="#"+b,a(b)})}else a(b)},e.runTopicLoadingAnimation=function(){var a=null,b=!1;return function(c){return b=c,c?(null==a&&(a=e.debounce(function(){return h.publish(g("EVT_TOPIC_LOADING"),b)},700)),a()):(a=null,h.publish(g("EVT_TOPIC_LOADING"),!1))}}(),e.getTopicFrame=function(){var a=window.gTopicFrameName||"rh_default_topic_frame_name";return f("[name="+a+"]",0)},e.goToDefaultTopic=function(){var a={};return e.getDefaultTopic(function(b){a[g("HASH_KEY_TOPIC")]=b,e.updateHashMap(a,!0)}),!1}},{}],19:[function(a,b,c){Object.getPrototypeOf||(Object.getPrototypeOf=function(a){if(a!==Object(a))throw TypeError("Object.getPrototypeOf called on non-object");return a.__proto__||a.constructor.prototype||Object.prototype}),"function"!=typeof Object.getOwnPropertyNames&&(Object.getOwnPropertyNames=function(a){if(a!==Object(a))throw TypeError("Object.getOwnPropertyNames called on non-object");var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}),"function"!=typeof Object.create&&(Object.create=function(a,b){function c(){}if("object"!=typeof a)throw TypeError();c.prototype=a;var d=new c;if(a&&(d.constructor=c),void 0!==b){if(b!==Object(b))throw TypeError();Object.defineProperties(d,b)}return d}),function(){if(!Object.defineProperty||!function(){try{return Object.defineProperty({},"x",{}),!0}catch(a){return!1}}()){var a=Object.defineProperty;Object.defineProperty=function(b,c,d){if(a)try{return a(b,c,d)}catch(e){}if(b!==Object(b))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in d&&Object.prototype.__defineGetter__.call(b,c,d.get),Object.prototype.__defineSetter__&&"set"in d&&Object.prototype.__defineSetter__.call(b,c,d.set),"value"in d&&(b[c]=d.value),b}}}(),"function"!=typeof Object.defineProperties&&(Object.defineProperties=function(a,b){if(a!==Object(a))throw TypeError("Object.defineProperties called on non-object");var c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&Object.defineProperty(a,c,b[c]);return a}),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw TypeError("Object.keys called on non-object");var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw TypeError("Bind must be called on a function");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a,b.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(d.prototype=this.prototype),e.prototype=new d,e}),Array.isArray=Array.isArray||function(a){return Boolean(a&&"[object Array]"===Object.prototype.toString.call(Object(a)))},Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),isNaN(d)?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d))));for(var e=d>=0?Math.min(d,c-1):c-Math.abs(d);e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.every||(Array.prototype.every=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw TypeError();var d,e=arguments[1];for(d=0;d<c;d++)if(d in b&&!a.call(e,b[d],d,b))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw TypeError();var d,e=arguments[1];for(d=0;d<c;d++)if(d in b&&a.call(e,b[d],d,b))return!0;return!1}),Array.prototype.forEach||(Array.prototype.forEach=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw TypeError();var d,e=arguments[1];for(d=0;d<c;d++)d in b&&a.call(e,b[d],d,b)}),Array.prototype.map||(Array.prototype.map=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw TypeError();var d=[];d.length=c;var e,f=arguments[1];for(e=0;e<c;e++)e in b&&(d[e]=a.call(f,b[e],e,b));return d}),Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw TypeError();var d,e=[],f=arguments[1];for(d=0;d<c;d++)if(d in b){var g=b[d];a.call(f,g,d,b)&&e.push(g)}return e}),Array.prototype.reduce||(Array.prototype.reduce=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw TypeError();if(0===c&&1===arguments.length)throw TypeError();var d,e=0;if(arguments.length>=2)d=arguments[1];else for(;;){if(e in b){d=b[e++];break}if(++e>=c)throw TypeError()}for(;e<c;)e in b&&(d=a.call(void 0,d,b[e],e,b)),e++;return d}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(a){if(void 0===this||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw TypeError();if(0===c&&1===arguments.length)throw TypeError();var d,e=c-1;if(arguments.length>=2)d=arguments[1];else for(;;){if(e in this){d=this[e--];break}if(--e<0)throw TypeError()}for(;e>=0;)e in b&&(d=a.call(void 0,d,b[e],e,b)),e--;return d}),String.prototype.trim||(String.prototype.trim=function(){return String(this).replace(/^\s+/,"").replace(/\s+$/,"")}),Date.now||(Date.now=function(){return Number(new Date)}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){function a(a){return("00"+a).slice(-2)}function b(a){return("000"+a).slice(-3)}return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+b(this.getUTCMilliseconds())+"Z"})},{}],20:[function(require,module,exports){function __cons(t,a){return eval("new t("+a.map(function(a,b){return"a["+b+"]"}).join(",")+")")}!function(a){"use strict";function b(b){return b===a?J:b}function c(a,b){for(var c=Object.getOwnPropertyDescriptor(a,b),d=Object.getPrototypeOf(a);!c&&d;)c=Object.getOwnPropertyDescriptor(d,b),d=Object.getPrototypeOf(d);return c}function d(a,b,c,d){b in a&&!d&&!I||("function"==typeof c?Object.defineProperty(a,b,{value:c,configurable:!0,enumerable:!1,writable:!0}):Object.defineProperty(a,b,{value:c,configurable:!1,enumerable:!1,writable:!1}))}function e(a,b,c){Object.defineProperty(a,b,{value:c,configurable:!1,enumerable:!1,writable:!0})}function f(){function a(a){var b=a.valueOf,d=C(null);return Object.defineProperty(a,"valueOf",{value:function(c){return function(e){return e===c?d:b.apply(a,arguments)}}(c),configurable:!0,writeable:!0,enumerable:!1}),d}function b(a){var b="function"==typeof a.valueOf&&a.valueOf(c);return b===a?null:b}var c=C(null);return{clear:function(){c=C(null)},remove:function(a){var c=b(a);return!(!c||!s(c,"value"))&&(delete c.value,!0)},get:function(a,c){var d=b(a);return d&&s(d,"value")?d.value:c},has:function(a){var c=b(a);return Boolean(c&&s(c,"value"))},set:function(c,d){var e=b(c)||a(c);e.value=d}}}function g(b){switch(typeof b){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";default:return null===b?"null":b instanceof a.Symbol?"symbol":"object"}}function h(a){return a=Number(a),L(a)?0:0===a||a===1/0||a===-(1/0)?a:(a<0?-1:1)*U(R(a))}function i(a){return a>>>0}function j(a){if(null===a||a===J)throw TypeError();return Object(a)}function k(a){var b=h(a);return b<=0?0:b===1/0?9007199254740991:X(b,9007199254740991)}function l(a){return"function"==typeof a}function m(a){return!!/Constructor/.test(Object.prototype.toString.call(a))||(!!/Function/.test(Object.prototype.toString.call(a))||"function"==typeof a)}function n(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case"undefined":return!0;case"number":return a!==a&&b!==b||(0===a&&0===b?1/a===1/b:a===b);case"boolean":case"string":case"object":default:return a===b}}function o(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case"undefined":return!0;case"number":return a!==a&&b!==b||a===b;case"boolean":case"string":case"object":default:return a===b}}function p(a,b){var c=j(a);return c[b]}function q(a,b){var c=p(a,b);if(c===J||null===c)return J;if(!l(c))throw TypeError();return c}function r(a,b){for(;a;){if(Object.prototype.hasOwnProperty.call(a,b))return!0;if("object"!==g(a))return!1;var c=Object.getPrototypeOf(a);if(c===a)return!1;a=c}return!1}function s(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function t(a,b){arguments.length<2&&(b=q(a,fa));var c=b.call(a);if("object"!==g(c))throw TypeError();return c}function u(a,b){if(arguments.length<2)var c=a.next();else c=a.next(b);if("object"!==g(c))throw TypeError();return c}function v(a){return console.assert("object"===g(a)),a.value}function w(a,b){var c=u(a,b),d=c.done;return Boolean(d)!==!0&&c}function x(a,b){console.assert("boolean"===g(b));
var c={};return c.value=a,c.done=b,c}function y(a,b,c){var d=function(){b.apply(J,c)};K(d)}function z(a){}function A(a){var b=[];if(Object(a)!==a)return b;for(var c=new Set;null!==a;)Object.getOwnPropertyNames(a).forEach(function(d){if(!c.has(d)){var e=Object.getOwnPropertyDescriptor(a,d);e&&(c.add(d),e.enumerable&&b.push(d))}}),a=Object.getPrototypeOf(a);return b[fa]()}function B(a){return Object.getOwnPropertyNames(a)}function C(a,b){return Object.create(a,b)}function D(){}function E(a,b){var c=String(a),d=new D;return e(d,"[[IteratedString]]",c),e(d,"[[StringIteratorNextIndex]]",0),e(d,"[[StringIterationKind]]",b),d}function F(){}function G(a,b){var c=j(a),d=new F;return e(d,"[[IteratedObject]]",c),e(d,"[[ArrayIteratorNextIndex]]",0),e(d,"[[ArrayIterationKind]]",b),d}var H,I=!1,J=void 0,K=function(a,b){return a?function(b){a.resolve().then(function(){b()})}:b?function(a){b(a)}:function(a){setTimeout(a,0)}}(a.Promise,a.setImmediate),L=a.isNaN,M=a.parseInt,N=a.parseFloat,O=Math.E,P=Math.LOG10E,Q=Math.LOG2E,R=Math.abs,S=Math.ceil,T=Math.exp,U=Math.floor,V=Math.log,W=Math.max,X=Math.min,Y=Math.pow,Z=Math.random,$=Math.sqrt,_=String.prototype.match,aa=String.prototype.replace,ba=String.prototype.search,ca=String.prototype.split,da=Object.create(null);!function(){function c(a){return Array(a+1).join("x").replace(/x/g,function(){return Z()<.5?"â":"â"})}function f(a){if(!(this instanceof f))return new f(a,g);if(this instanceof f&&arguments[1]!==g)throw TypeError();var b=a===J?J:String(a);return e(this,"[[SymbolData]]",c(128)),e(this,"[[Description]]",b),h[this]=this,this}var g=Object.create(null),h={};H=function(a){return h[a]};var i=[];"Symbol"in a&&!I||(a.Symbol=f),d(f,"for",function(a){for(var b=String(a),c=0;c<i.length;++c){var d=i[c];if(n(d["[[key]]"],b))return d["[[symbol]]"]}var e=f(a);return i.push({"[[key]]":b,"[[symbol]]":e}),e}),d(a.Symbol,"iterator",a.Symbol("Symbol.iterator")),d(f,"keyFor",function(a){if(!(a instanceof f))throw TypeError();for(var b=0;b<i.length;++b){var c=i[b];if(n(c["[[symbol]]"],a))return c["[[key]]"]}return J}),d(a.Symbol,"match",a.Symbol("Symbol.match")),d(a.Symbol,"replace",a.Symbol("Symbol.replace")),d(a.Symbol,"search",a.Symbol("Symbol.search")),d(a.Symbol,"split",a.Symbol("Symbol.split")),d(a.Symbol,"toStringTag",a.Symbol("Symbol.toStringTag")),Object.defineProperty(f.prototype,"toString",{value:function(){var a=b(this),c=a["[[Description]]"];return"Symbol("+(c===J?"":c)+a["[[SymbolData]]"]+")"},configurable:!0,writeable:!0,enumerable:!1}),Object.defineProperty(f.prototype,"valueOf",{value:function(){throw TypeError()},configurable:!0,writeable:!0,enumerable:!1})}(),console.assert("symbol"==typeof a.Symbol()||H(String(a.Symbol("x")))!==J);var ea={},fa=a.Symbol.iterator,ga=a.Symbol.match,ha=a.Symbol.replace,ia=a.Symbol.search,ja=a.Symbol.split,ka=a.Symbol.toStringTag;d(Object,"assign",function(a,b){var c=j(a);if(arguments.length<2)return c;for(var d=1;d<arguments.length;){var e=arguments[d++];if(e===J||null===e)var f=[];else{var g=j(e);f=B(g)}for(var h=0;h<f.length;++h){var i=f[h],k=Object.getOwnPropertyDescriptor(g,i);if(k!==J&&k.enumerable){var l=g[i];c[i]=l}}}return c}),function(){function b(a){return!H(a)}var c="symbol"==typeof a.Symbol(),e=Object.getOwnPropertyNames,f=Object.keys,g="object"==typeof window?e(window):[];d(Object,"getOwnPropertyNames",function(a){if("[object Window]"===Object.prototype.toString.call(a))try{return e(a).filter(b)}catch(c){return g.slice()}return e(a).filter(b)},!c),d(Object,"getOwnPropertySymbols",function(a){return e(a).filter(H).map(H)},!c),d(Object,"keys",function(a){return f(a).filter(b)},!c)}(),d(Object,"is",function(a,b){return n(a,b)}),d(Object,"setPrototypeOf",function(a,b){if("object"!==g(a))throw TypeError();if("object"!==g(b)&&"null"!==g(b))throw TypeError();return a.__proto__=b,a});var la=Object.prototype.toString;d(Object.prototype,"toString",function(){var a=b(this);return a===Object(a)&&ka in a?"[object "+a[ka]+"]":la.apply(a,arguments)}),d(a.Symbol.prototype,a.Symbol.toStringTag,"Symbol"),d(Number,"EPSILON",function(){var a,b;for(a=1;1+a!==1;a/=2)b=a;return b}()),d(Number,"isFinite",function(a){return"number"===g(a)&&(a===a&&a!==+(1/0)&&a!==-(1/0))}),d(Number,"isInteger",function(a){if("number"!==g(a))return!1;if(a!==a||a===+(1/0)||a===-(1/0))return!1;var b=h(a);return b===a}),d(Number,"isNaN",function(a){return"number"===g(a)&&a!==a}),d(Number,"isSafeInteger",function(a){if("number"!==g(a))return!1;if(a!==a||a===+(1/0)||a===-(1/0))return!1;var b=h(a);return b===a&&R(b)<=9007199254740991}),d(Number,"MAX_SAFE_INTEGER",9007199254740991),d(Number,"MIN_SAFE_INTEGER",-9007199254740991),d(Number,"parseFloat",N),d(Number,"parseInt",M),d(Math,ka,"Math"),d(Math,"acosh",function(a){return a=Number(a),V(a+$(a*a-1))}),d(Math,"asinh",function(a){if(a=Number(a),n(a,-0))return a;var b=$(a*a+1);return V(b===-a?0:a+b)}),d(Math,"atanh",function(a){return a=Number(a),0===a?a:V((1+a)/(1-a))/2}),d(Math,"cbrt",function(a){if(a=Number(a),L(a/a))return a;var b=Y(R(a),1/3),c=a/b/b;return b+b*(c-b)/(2*b+c)}),d(Math,"clz32",function(a){function b(a){return 240&a?128&a?0:64&a?1:32&a?2:3:8&a?4:4&a?5:2&a?6:1&a?7:8}return a=i(a),4278190080&a?b(a>>24):16711680&a?b(a>>16)+8:65280&a?b(a>>8)+16:b(a)+24}),d(Math,"cosh",function(a){return a=Number(a),(Y(O,a)+Y(O,-a))/2}),d(Math,"expm1",function(a){return a=Number(a),n(a,-0)?-0:R(a)<1e-5?a+.5*a*a:T(a)-1}),d(Math,"fround",function(a){return L(a)?NaN:1/a===+(1/0)||1/a===-(1/0)||a===+(1/0)||a===-(1/0)?a:new Float32Array([a])[0]}),d(Math,"hypot",function(){for(var a=[],b=0,c=!1,d=0;d<arguments.length;++d){var e=R(Number(arguments[d]));if(e===1/0)return e;e!==e&&(c=!0),e>b&&(b=e),a[d]=e}if(c)return NaN;if(0===b)return 0;var f=0;for(d=0;d<a.length;++d){var g=a[d]/b;f+=g*g}return b*$(f)}),d(Math,"imul",function(a,b){var c=i(a),d=i(b),e=c>>>16&65535,f=65535&c,g=d>>>16&65535,h=65535&d;return f*h+(e*h+f*g<<16>>>0)|0},"imul"in Math&&0===Math.imul(1,2147483648)),d(Math,"log1p",function(a){return a=Number(a),a<-1?NaN:n(a,-0)?-0:R(a)>1e-4?V(1+a):(-.5*a+1)*a}),d(Math,"log10",function(a){return a=Number(a),V(a)*P}),d(Math,"log2",function(a){return a=Number(a),V(a)*Q}),d(Math,"sign",function(a){return a=Number(a),a<0?-1:a>0?1:a}),d(Math,"sinh",function(a){return a=Number(a),n(a,-0)?a:(Y(O,a)-Y(O,-a))/2}),d(Math,"tanh",function(a){a=Number(a);var b=Y(O,2*a)-1,c=Y(O,2*a)+1;return n(a,-0)?a:b===c?1:b/c}),d(Math,"trunc",function(a){return a=Number(a),L(a)?NaN:a<0?S(a):U(a)});var ma=function(){var a={},b=Symbol();return a[Symbol.match]=function(){return b},"".match(a)===b}();d(String,"fromCodePoint",function(){for(var a=arguments,b=a.length,c=[],d=0;d<b;){var e=a[d],f=Number(e);if(!n(f,h(f))||f<0||f>1114111)throw RangeError("Invalid code point "+f);f<65536?c.push(String.fromCharCode(f)):(f-=65536,c.push(String.fromCharCode((f>>10)+55296)),c.push(String.fromCharCode(f%1024+56320))),d+=1}return c.join("")}),d(String,"raw",function qa(a){var b=[].slice.call(arguments,1),c=Object(a),d=c.raw,qa=Object(d),e=qa.length,f=k(e);if(f<=0)return"";for(var g=[],h=0;;){var i=qa[h],j=String(i);if(g.push(j),h+1===f)return g.join("");i=b[h];var l=String(i);g.push(l),h+=1}}),d(String.prototype,"codePointAt",function(a){var c=b(this),d=String(c),e=h(a),f=d.length;if(e<0||e>=f)return J;var g=d.charCodeAt(e);if(g<55296||g>56319||e+1===f)return g;var i=d.charCodeAt(e+1);return i<56320||i>57343?g:1024*(g-55296)+(i-56320)+65536}),d(String.prototype,"endsWith",function(a){var c=arguments[1],d=b(this),e=String(d),f=String(a),g=e.length,i=c===J?g:h(c),j=X(W(i,0),g),k=f.length,l=j-k;return!(l<0)&&e.substring(l,l+k)===f}),d(String.prototype,"includes",function(a){var c=arguments[1],d=b(this),e=String(d),f=String(a),g=h(c),i=e.length,j=X(W(g,0),i);return e.indexOf(f,j)!==-1}),d(String.prototype,"match",function(a){var c=b(this),d=String(c);if(r(a,ga))var e=a;else e=new RegExp(a);return e[ga](d)},!ma),d(String.prototype,"repeat",function(a){var c=b(this),d=String(c),e=h(a);if(e<0)throw RangeError();if(e===1/0)throw RangeError();var f=new Array(e+1).join(d);return f}),d(String.prototype,"replace",function(a,c){var d=b(this);return r(a,ha)?a[ha](d,c):aa.call(d,a,c)},!ma),d(String.prototype,"search",function(a){var c=b(this),d=String(c);if(r(a,ia))var e=a;else e=new RegExp(a);return e[ia](d)},!ma),d(String.prototype,"split",function(a,c){var d=b(this);return r(a,ja)?a[ja](d,c):ca.call(d,a,c)},!ma),d(String.prototype,"startsWith",function(a){var c=arguments[1],d=b(this),e=String(d),f=String(a),g=h(c),i=e.length,j=X(W(g,0),i),k=f.length;return!(k+j>i)&&e.substring(j,j+k)===f}),d(String.prototype,fa,function(){return E(this,"value")});var na=Object.create(ea);D.prototype=na,d(na,"next",function(){var a=j(this),b=String(a["[[IteratedString]]"]),c=a["[[StringIteratorNextIndex]]"],d=b.length;if(c>=d)return e(a,"[[StringIteratorNextIndex]]",1/0),x(J,!0);var f=b.codePointAt(c);return e(a,"[[StringIteratorNextIndex]]",c+(f>65535?2:1)),x(String.fromCodePoint(f),!1)}),d(na,ka,"String Iterator"),"flags"in RegExp.prototype||Object.defineProperty(RegExp.prototype,"flags",{get:function(){var a=String(this);return a.substring(a.lastIndexOf("/")+1)}}),d(RegExp.prototype,ga,function(a){var c=b(this);return _.call(a,c)}),d(RegExp.prototype,ha,function(a,c){var d=b(this);return aa.call(a,d,c)}),d(RegExp.prototype,ia,function(a){var c=b(this);return ba.call(a,c)}),d(RegExp.prototype,ja,function(a,c){var d=b(this);return ca.call(a,d,c)}),d(Array,"from",function(a){var c=arguments[1],d=arguments[2],e=b(this);if(c===J)var f=!1;else{if(!l(c))throw TypeError();var g=d;f=!0}var h=q(a,fa);if(h!==J){if(m(e))var i=new e;else i=new Array(0);for(var n=t(a,h),o=0;;){var p=w(n);if(p===!1)return i.length=o,i;var r=v(p);if(f)var s=c.call(g,r);else s=r;i[o]=s,o+=1}}var u=j(a),x=u.length,y=k(x);for(i=m(e)?new e(y):new Array(y),o=0;o<y;){var z=u[o];s=f?c.call(g,z,o):z,i[o]=s,o+=1}return i.length=y,i}),d(Array,"of",function(){var a,c=arguments,d=c.length,e=i(d),f=b(this);m(f)?(a=new f(e),a=j(a)):a=new Array(e);for(var g=0;g<e;)a[g]=c[g],g+=1;return a.length=e,a}),d(Array.prototype,"copyWithin",function(a,b){var c=arguments[2],d=j(this),e=d.length,f=k(e);f=W(f,0);var g,i=h(a);g=i<0?W(f+i,0):X(i,f);var l,m=h(b);l=m<0?W(f+m,0):X(m,f);var n;n=c===J?f:h(c);var o;o=n<0?W(f+n,0):X(n,f);var p,q=X(o-l,f-g);for(l<g&&g<l+q?(p=-1,l=l+q-1,g=g+q-1):p=1;q>0;){var s=String(l),t=String(g),u=r(d,s);if(u){var v=d[s];d[t]=v}else delete d[t];l+=p,g+=p,q-=1}return d});var oa="entries"in Array.prototype&&"next"in[].entries();d(Array.prototype,"entries",function(){return G(this,"key+value")},!oa),d(Array.prototype,"fill",function(a){var b=arguments[1],c=arguments[2],d=j(this),e=d.length,f=k(e);f=W(f,0);var g,i=h(b);g=i<0?W(f+i,0):X(i,f);var l;l=c===J?f:h(c);var m;for(m=l<0?W(f+l,0):X(l,f);g<m;){var n=String(g);d[n]=a,g+=1}return d}),d(Array.prototype,"find",function(a){var b=j(this),c=b.length,d=h(c);if(!l(a))throw TypeError();for(var e=arguments.length>1?arguments[1]:J,f=0;f<d;){var g=String(f),i=r(b,g);if(i){var k=b[g],m=a.call(e,k,f,b);if(Boolean(m))return k}++f}return J}),d(Array.prototype,"findIndex",function(a){var b=j(this),c=b.length,d=k(c);if(!l(a))throw TypeError();for(var e=arguments.length>1?arguments[1]:J,f=0;f<d;){var g=String(f),h=r(b,g);if(h){var i=b[g],m=a.call(e,i,f,b);if(Boolean(m))return f}++f}return-1}),d(Array.prototype,"keys",function(){return G(this,"key")},!oa),d(Array.prototype,"values",function(){return G(this,"value")},!oa),d(Array.prototype,fa,Array.prototype.values);var pa=Object.create(ea);F.prototype=pa,d(pa,"next",function(){var a=b(this);if("object"!==g(a))throw TypeError();var c,d,f=a["[[IteratedObject]]"],h=a["[[ArrayIteratorNextIndex]]"],j=a["[[ArrayIterationKind]]"],k=f.length,l=i(k);if(j.indexOf("sparse")!==-1)for(var m=!1;!m&&h<l;)c=String(h),m=r(f,c),m||(h+=1);if(h>=l)return e(a,"[[ArrayIteratorNextIndex]]",1/0),x(J,!0);if(c=h,e(a,"[[ArrayIteratorNextIndex]]",h+1),j.indexOf("value")!==-1&&(d=f[c]),j.indexOf("key+value")!==-1)return x([c,d],!1);if(j.indexOf("key")!==-1)return x(c,!1);if("value"===j)return x(d,!1);throw Error("Internal error")}),d(pa,ka,"Array Iterator"),["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(c){if(c in a){var e=a[c];d(e,"from",function(a){var c=arguments[1],d=arguments[2],e=b(this);if(!m(e))throw TypeError();if(c===J)var f=!1;else{if(l(c))throw TypeError();var g=d;f=!0}var h=q(a,fa);if(h!==J){for(var i=t(a,h),n=[],o=!0;o!==!1;)if(o=w(i),o!==!1){var p=v(o);n.push(p)}for(var r=n.length,s=new e(r),u=0;u<r;){var x=n.shift();if(f)var y=c.call(g,x);else y=x;s[u]=y,++u}return console.assert(0===n.length),s}var z=j(a),A=z.length;for(r=k(A),s=new e(r),u=0;u<r;)x=z[u],y=f?c.call(g,x,u):x,s[u]=y,++u;return s}),d(e,"of",function(){for(var a=arguments,c=a.length,d=b(this),e=new d(c),f=0;f<c;)e[f]=a[f],++f;return e}),d(e.prototype,"copyWithin",Array.prototype.copyWithin),d(e.prototype,"entries",Array.prototype.entries),d(e.prototype,"every",Array.prototype.every),d(e.prototype,"fill",function(a){var b=arguments[1],c=arguments[2],d=j(this),e=d.length,f=k(e);f=W(f,0);var g,i=h(b);g=i<0?W(f+i,0):X(i,f);var l;l=c===J?f:h(c);var m;for(m=l<0?W(f+l,0):X(l,f);g<m;){var n=String(g);d[n]=a,g+=1}return d}),d(e.prototype,"filter",function(a){var b=arguments[1],c=j(this),d=c.length,e=k(d);if(!l(a))throw TypeError();for(var f=b,g=c.constructor,h=[],i=0,m=0;i<e;){var n=c[i],o=a.call(f,n,i,c);o&&(h.push(n),++m),++i}for(var p=new g(m),q=0,r=0;r<h.length;++r){var s=h[r];p[q]=s,++q}return p}),d(e.prototype,"find",Array.prototype.find),d(e.prototype,"findIndex",Array.prototype.findIndex),d(e.prototype,"forEach",Array.prototype.forEach),d(e.prototype,"indexOf",Array.prototype.indexOf),d(e.prototype,"join",Array.prototype.join),d(e.prototype,"keys",Array.prototype.keys),d(e.prototype,"lastIndexOf",Array.prototype.lastIndexOf),d(e.prototype,"map",function(a){var b=arguments[1],c=j(this),d=c.length,e=k(d);if(!l(a))throw TypeError();var f=b,g=J,h=c.constructor;m(h)&&(g=new h(e)),g===J&&(g=new Array(e));for(var i=0;i<e;){var n=r(c,i);if(n){var o=c[i],p=a.call(f,o,i,c);g[i]=p}++i}return g}),d(e.prototype,"reduce",Array.prototype.reduce),d(e.prototype,"reduceRight",Array.prototype.reduceRight),d(e.prototype,"reverse",Array.prototype.reverse),d(e.prototype,"slice",function(a,b){var c=j(this),d=c.length,e=k(d),f=h(a),g=f<0?W(e+f,0):X(f,e),i=b===J?e:h(b),l=i<0?W(e+i,0):X(i,e),n=l-g,o=c.constructor;if(!m(o))throw TypeError();for(var p=new o(n),q=0;g<l;){var r=c[g];p[q]=r,++g,++q}return p}),d(e.prototype,"some",Array.prototype.some),d(e.prototype,"sort",function(){function a(a,c){return console.assert("number"===g(a)&&"number"===g(c)),a!==a&&c!==c?0:a!==a?1:c!==c?-1:b!==J?b(a,c):a<c?-1:a>c?1:0}var b=arguments[0];return Array.prototype.sort.call(this,a)}),d(e.prototype,"values",Array.prototype.values),d(e.prototype,fa,e.prototype.values),d(e.prototype,ka,c)}}),function(){function c(){var a=b(this),c=arguments[0];if("object"!==g(a))throw TypeError();if("[[MapData]]"in a)throw TypeError();if(c!==J){var d=a.set;if(!l(d))throw TypeError();var f=t(j(c))}if(e(a,"[[MapData]]",{keys:[],values:[]}),f===J)return a;for(;;){var h=w(f);if(h===!1)return a;var i=v(h);if("object"!==g(i))throw TypeError();var k=i[0],m=i[1];d.call(a,k,m)}return a}function f(a,b){var c;if(b===b)return a.keys.indexOf(b);for(c=0;c<a.keys.length;c+=1)if(o(a.keys[c],b))return c;return-1}function h(){}function i(a,b){if("object"!==g(a))throw TypeError();if(!("[[MapData]]"in a))throw TypeError();if(a["[[MapData]]"]===J)throw TypeError();var c=new h;return e(c,"[[Map]]",a),e(c,"[[MapNextIndex]]",0),e(c,"[[MapIterationKind]]",b),c}"Map"in a&&!I&&!function(){try{return new a.Map([]),!1}catch(b){return!0}}()&&!function(){try{return!(new a.Map).entries().next}catch(b){return!0}}()&&1===new a.Map([["a",1]]).size||(a.Map=c);var k={};c.prototype=k,d(c.prototype,"clear",function(){var a=b(this);if("object"!==g(a))throw TypeError();if(!("[[MapData]]"in a))throw TypeError();if(a["[[MapData]]"]===J)throw TypeError();var c=a["[[MapData]]"];return c.keys.length=0,c.values.length=0,J}),d(c.prototype,"delete",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(!("[[MapData]]"in c))throw TypeError();if(c["[[MapData]]"]===J)throw TypeError();var d=c["[[MapData]]"],e=f(d,a);return!(e<0)&&(d.keys[e]=da,d.values[e]=da,!0)}),d(c.prototype,"entries",function(){var a=b(this);if("object"!==g(a))throw TypeError();return i(a,"key+value")}),d(c.prototype,"forEach",function(a){var c=arguments[1],d=b(this);if("object"!==g(d))throw TypeError();if(!("[[MapData]]"in d))throw TypeError();if(d["[[MapData]]"]===J)throw TypeError();var e=d["[[MapData]]"];if(!l(a))throw TypeError("First argument to forEach is not callable.");for(var f=0;f<e.keys.length;++f)e.keys[f]!==da&&a.call(c,e.values[f],e.keys[f],d);return J}),d(c.prototype,"get",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(!("[[MapData]]"in c))throw TypeError();if(c["[[MapData]]"]===J)throw TypeError();var d=c["[[MapData]]"],e=f(d,a);return e>=0?d.values[e]:J}),d(c.prototype,"has",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(!("[[MapData]]"in c))throw TypeError();if(c["[[MapData]]"]===J)throw TypeError();var d=c["[[MapData]]"];return f(d,a)>=0}),d(c.prototype,"keys",function(){var a=b(this);if("object"!==g(a))throw TypeError();return i(a,"key")}),d(c.prototype,"set",function(a,c){var d=b(this);if("object"!==g(d))throw TypeError();if(!("[[MapData]]"in d))throw TypeError();if(d["[[MapData]]"]===J)throw TypeError();var e=d["[[MapData]]"],h=f(e,a);return h<0&&(h=e.keys.length),n(a,-0)&&(a=0),e.keys[h]=a,e.values[h]=c,d}),Object.defineProperty(c.prototype,"size",{get:function(){var a=b(this);if("object"!==g(a))throw TypeError();if(!("[[MapData]]"in a))throw TypeError();if(a["[[MapData]]"]===J)throw TypeError();for(var c=a["[[MapData]]"],d=0,e=0;e<c.keys.length;++e)c.keys[e]!==da&&(d+=1);return d}}),d(c.prototype,"values",function(){var a=b(this);if("object"!==g(a))throw TypeError();return i(a,"value")}),d(c.prototype,fa,function(){var a=b(this);if("object"!==g(a))throw TypeError();return i(a,"key+value")}),d(a.Map.prototype,ka,"Map");var m=Object.create(ea);h.prototype=m,d(m,"next",function(){var a=b(this);if("object"!==g(a))throw TypeError();for(var c=a["[[Map]]"],d=a["[[MapNextIndex]]"],f=a["[[MapIterationKind]]"],h=c["[[MapData]]"];d<h.keys.length;){var i={key:h.keys[d],value:h.values[d]};if(d=d+=1,e(a,"[[MapNextIndex]]",d),i.key!==da)return"key"===f?x(i.key,!1):"value"===f?x(i.value,!1):x([i.key,i.value],!1)}return x(J,!0)}),d(m,ka,"Map Iterator")}(),function(){function c(){var a=b(this),c=arguments[0];if("object"!==g(a))throw TypeError();if("[[SetData]]"in a)throw TypeError();if(c!==J){var d=a.add;if(!l(d))throw TypeError();var f=t(j(c))}if(e(a,"[[SetData]]",[]),f===J)return a;for(;;){var h=w(f);if(h===!1)return a;var i=v(h);d.call(a,i)}return a}function f(a,b){var c;if(b===b)return a.indexOf(b);for(c=0;c<a.length;c+=1)if(o(a[c],b))return c;return-1}function h(){}function i(a,b){if("object"!==g(a))throw TypeError();if(!("[[SetData]]"in a))throw TypeError();if(a["[[SetData]]"]===J)throw TypeError();var c=new h;return e(c,"[[IteratedSet]]",a),e(c,"[[SetNextIndex]]",0),e(c,"[[SetIterationKind]]",b),c}"Set"in a&&!I&&!function(){try{return!(new a.Set).entries().next}catch(b){return!0}}()&&1===new a.Set([1]).size||(a.Set=c);var k={};c.prototype=k,d(c.prototype,"add",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(!("[[SetData]]"in c))throw TypeError();if(c["[[SetData]]"]===J)throw TypeError();n(a,-0)&&(a=0);var d=c["[[SetData]]"],e=f(d,a);return e<0&&(e=c["[[SetData]]"].length),c["[[SetData]]"][e]=a,c}),d(c.prototype,"clear",function(){var a=b(this);if("object"!==g(a))throw TypeError();if(!("[[SetData]]"in a))throw TypeError();if(a["[[SetData]]"]===J)throw TypeError();var c=a["[[SetData]]"];return c.length=0,J}),d(c.prototype,"delete",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(!("[[SetData]]"in c))throw TypeError();if(c["[[SetData]]"]===J)throw TypeError();var d=c["[[SetData]]"],e=f(d,a);return!(e<0)&&(d[e]=da,!0)}),d(c.prototype,"entries",function(){var a=b(this);if("object"!==g(a))throw TypeError();return i(a,"key+value")}),d(c.prototype,"forEach",function(a){var c=arguments[1],d=b(this);if("object"!==g(d))throw TypeError();if(!("[[SetData]]"in d))throw TypeError();if(d["[[SetData]]"]===J)throw TypeError();var e=d["[[SetData]]"];if(!l(a))throw TypeError("First argument to forEach is not callable.");for(var f=0;f<e.length;++f)e[f]!==da&&a.call(c,e[f],e[f],d)}),d(c.prototype,"has",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(!("[[SetData]]"in c))throw TypeError();if(c["[[SetData]]"]===J)throw TypeError();var d=c["[[SetData]]"];return f(d,a)!==-1}),Object.defineProperty(c.prototype,"size",{get:function(){var a=b(this);if("object"!==g(a))throw TypeError();if(!("[[SetData]]"in a))throw TypeError();if(a["[[SetData]]"]===J)throw TypeError();for(var c=a["[[SetData]]"],d=0,e=0;e<c.length;++e)c[e]!==da&&(d+=1);return d}}),d(c.prototype,"values",function(){var a=b(this);if("object"!==g(a))throw TypeError();return i(a,"value")}),c.prototype.keys=c.prototype.values,d(c.prototype,fa,function(){var a=b(this);if("object"!==g(a))throw TypeError();return i(a)}),d(a.Set.prototype,ka,"Set");var m=Object.create(ea);h.prototype=m,d(m,"next",function(){var a=b(this);if("object"!==g(a))throw TypeError();for(var c=a["[[IteratedSet]]"],d=a["[[SetNextIndex]]"],f=a["[[SetIterationKind]]"],h=c["[[SetData]]"];d<h.length;){var i=h[d];if(d=d+=1,e(a,"[[SetNextIndex]]",d),i!==da)return"key+value"===f?x([i,i],!1):x(i,!1)}return x(J,!0)}),d(m,ka,"Set Iterator")}(),function(){function c(){var a=b(this),c=arguments[0];if("object"!==g(a))throw TypeError();if("[[WeakMapData]]"in a)throw TypeError();if(c!==J){var d=a.set;if(!l(d))throw TypeError();var h=t(j(c))}if(e(a,"[[WeakMapData]]",new f),h===J)return a;for(;;){var i=w(h);if(i===!1)return a;var k=v(i);if("object"!==g(k))throw TypeError();var m=k[0],n=k[1];d.call(a,m,n)}return a}"WeakMap"in a&&!I||(a.WeakMap=c);var h={};c.prototype=h,d(c.prototype,"delete",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(c["[[WeakMapData]]"]===J)throw TypeError();if("object"!==g(a))throw TypeError("Expected object");return c["[[WeakMapData]]"].remove(a)}),d(c.prototype,"get",function(a,c){var d=b(this);if("object"!==g(d))throw TypeError();if(d["[[WeakMapData]]"]===J)throw TypeError();if("object"!==g(a))throw TypeError("Expected object");return d["[[WeakMapData]]"].get(a,c)}),d(c.prototype,"has",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(c["[[WeakMapData]]"]===J)throw TypeError();if("object"!==g(a))throw TypeError("Expected object");return c["[[WeakMapData]]"].has(a)}),d(c.prototype,"set",function(a,c){var d=b(this);if("object"!==g(d))throw TypeError();if(d["[[WeakMapData]]"]===J)throw TypeError();if("object"!==g(a))throw TypeError("Expected object");return d["[[WeakMapData]]"].set(a,c),d}),d(a.WeakMap.prototype,ka,"WeakMap"),function(){var b=new a.WeakMap,c=a.WeakMap.prototype.set;d(a.WeakMap.prototype,"set",function(){return c.apply(this,arguments),this},b.set({},0)!==b)}()}(),function(){function c(){var a=b(this),c=arguments[0];if("object"!==g(a))throw TypeError();if("[[WeakSetData]]"in a)throw TypeError();if(c!==J){var d=a.add;if(!l(d))throw TypeError();var h=t(j(c))}if(e(a,"[[WeakSetData]]",new f),h===J)return a;for(;;){var i=w(h);if(i===!1)return a;var k=v(i);d.call(a,k)}return a}"WeakSet"in a&&!I||(a.WeakSet=c);var h={};c.prototype=h,d(c.prototype,"add",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(c["[[WeakSetData]]"]===J)throw TypeError();if("object"!==g(a))throw TypeError("Expected object");return c["[[WeakSetData]]"].set(a,!0),c}),d(c.prototype,"delete",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(c["[[WeakSetData]]"]===J)throw TypeError();if("object"!==g(a))throw TypeError("Expected object");return c["[[WeakSetData]]"].remove(a)}),d(c.prototype,"has",function(a){var c=b(this);if("object"!==g(c))throw TypeError();if(c["[[WeakSetData]]"]===J)throw TypeError();if("object"!==g(a))throw TypeError("Expected object");return c["[[WeakSetData]]"].has(a)}),d(a.WeakSet.prototype,ka,"WeakSet"),function(){var b=new a.WeakSet,c=a.WeakSet.prototype.add;d(a.WeakSet.prototype,"add",function(){return c.apply(this,arguments),this},b.add({})!==b)}()}(),function(){"ArrayBuffer"in a&&(d(ArrayBuffer,"isView",function(a){return"object"===g(a)&&("buffer"in a&&a.buffer instanceof ArrayBuffer)}),d(ArrayBuffer.prototype,ka,"ArrayBuffer"))}(),function(){"DataView"in a&&d(DataView.prototype,ka,"DataView")}(),d(JSON,ka,"JSON"),d(ea,fa,function(){return this}),function(){function c(a){var b={"[[value]]":!1},c=h();e(c,"[[Promise]]",a),e(c,"[[AlreadyResolved]]",b);var d=f();return e(d,"[[Promise]]",a),e(d,"[[AlreadyResolved]]",b),{"[[Resolve]]":c,"[[Reject]]":d}}function f(){var a=function(b){console.assert("object"===g(a["[[Promise]]"]));var c=a["[[Promise]]"],d=a["[[AlreadyResolved]]"];return d["[[value]]"]?J:(e(d,"[[value]]",!0),q(c,b))};return a}function h(){var a=function(b){console.assert("object"===g(a["[[Promise]]"]));var c=a["[[Promise]]"],d=a["[[AlreadyResolved]]"];if(d["[[value]]"])return J;if(e(d,"[[value]]",!0),n(b,c)){var f=TypeError();return q(c,f)}if("object"!==g(b))return i(c,b);try{var h=b.then}catch(h){return q(c,h)}return l(h)?(y("PromiseJobs",u,[c,b,h]),J):i(c,b)};return a}function i(a,b){console.assert("pending"===a["[[PromiseState]]"]);var c=a["[[PromiseFulfillReactions]]"];return e(a,"[[PromiseResult]]",b),e(a,"[[PromiseFulfillReactions]]",J),e(a,"[[PromiseRejectReactions]]",J),e(a,"[[PromiseState]]","fulfilled"),r(c,b)}function j(a){return k(J,a)}function k(a,b){console.assert(m(b));var c={};e(c,"[[Promise]]",a),e(c,"[[Resolve]]",J),e(c,"[[Reject]]",J);var d=o();e(d,"[[Capability]]",c);var f=a=new b(d);if(e(c,"[[Promise]]",a),!l(c["[[Resolve]]"]))throw TypeError();if(!l(c["[[Reject]]"]))throw TypeError();if("object"===g(f)&&!n(a,f))throw TypeError();return c}function o(){var a=function(b,c){console.assert(a["[[Capability]]"]);var d=a["[[Capability]]"];if(d["[[Resolve]]"]!==J)throw TypeError();if(d["[[Reject]]"]!==J)throw TypeError();return e(d,"[[Resolve]]",b),e(d,"[[Reject]]",c),J};return a}function p(a){return"object"===g(a)&&("[[PromiseState]]"in a&&a["[[PromiseState]]"]!==J)}function q(a,b){console.assert("pending"===a["[[PromiseState]]"]);var c=a["[[PromiseRejectReactions]]"];return e(a,"[[PromiseResult]]",b),e(a,"[[PromiseFulfillReactions]]",J),e(a,"[[PromiseRejectReactions]]",J),e(a,"[[PromiseState]]","rejected"),r(c,b)}function r(a,b){for(var c=0,d=a.length;c<d;++c)y("PromiseJobs",s,[a[c],b]);return J}function s(a,b){var c,d,e=a["[[Capabilities]]"],f=a["[[Handler]]"];try{if("Identity"===f)c=b;else{if("Thrower"===f)throw b;c=f.call(J,b)}}catch(c){return d=e["[[Reject]]"].call(J,c),void z(d)}d=e["[[Resolve]]"].call(J,c),z(d)}function u(a,b,d){var e=c(a);try{var f=d.call(b,e["[[Resolve]]"],e["[[Reject]]"])}catch(f){var g=e["[[Reject]]"].call(J,f);return void z(g)}z(f)}function x(a){var b={configurable:!1,enumerable:!1,writable:!0,value:J};Object.defineProperty(this,"[[PromiseState]]",b),Object.defineProperty(this,"[[PromiseConstructor]]",b),Object.defineProperty(this,"[[PromiseResult]]",b),Object.defineProperty(this,"[[PromiseFulfillReactions]]",b),Object.defineProperty(this,"[[PromiseRejectReactions]]",b);var c=this;if("object"!==g(c))throw new TypeError;if(!("[[PromiseState]]"in c))throw TypeError();if(c["[[PromiseState]]"]!==J)throw TypeError();if(!l(a))throw TypeError();return e(c,"[[PromiseConstructor]]",x),A(c,a)}function A(a,b){console.assert("[[PromiseState]]"in a),console.assert(l(b)),e(a,"[[PromiseState]]","pending"),e(a,"[[PromiseFulfillReactions]]",[]),e(a,"[[PromiseRejectReactions]]",[]);var d=c(a);try{var f=b.call(J,d["[[Resolve]]"],d["[[Reject]]"])}catch(f){d["[[Reject]]"].call(J,f)}return a}function B(){var a=function(b){var c=a["[[AlreadyCalled]]"];if(c.value)return J;c.value=!0;var d=a["[[Index]]"],e=a["[[Values]]"],f=a["[[Capabilities]]"],g=a["[[RemainingElements]]"];try{e[d]=b}catch(h){return f["[[Reject]]"].call(J,h),f["[[Promise]]"]}return g.value-=1,0===g.value?f["[[Resolve]]"].call(J,e):J};return a}d(x,"all",function(a){var c=b(this),d=j(c);try{var f=t(a)}catch(g){return d["[[Reject]]"].call(J,g),d["[[Promise]]"]}for(var h=[],i={value:1},k=0;;){try{var l=w(f)}catch(g){return d["[[Reject]]"].call(J,g),d["[[Promise]]"]}if(!l){if(i.value-=1,0===i.value){d["[[Resolve]]"].apply(J,h)}return d["[[Promise]]"]}try{var m=v(l)}catch(g){return d["[[Reject]]"].call(J,g),d["[[Promise]]"]}try{var n=c.resolve(m)}catch(g){return d["[[Reject]]"].call(J,g),d["[[Promise]]"]}var o=B();e(o,"[[AlreadyCalled]]",{value:!1}),e(o,"[[Index]]",k),e(o,"[[Values]]",h),e(o,"[[Capabilities]]",d),e(o,"[[RemainingElements]]",i),i.value+=1;try{n.then(o,d["[[Reject]]"])}catch(g){return d["[[Reject]]"].call(J,g),d["[[Promise]]"]}k+=1}}),x.prototype={},d(x,"race",function(a){var c=b(this),d=j(c);try{var e=t(a)}catch(f){return d["[[Reject]]"].call(J,f),d["[[Promise]]"]}for(;;){try{var g=w(e)}catch(f){return d["[[Reject]]"].call(J,f),d["[[Promise]]"]}if(!g)return d["[[Promise]]"];try{var h=v(g)}catch(f){return d["[[Reject]]"].call(J,f),d["[[Promise]]"]}try{var i=c.resolve(h)}catch(f){return d["[[Reject]]"].call(J,f),d["[[Promise]]"]}try{i.then(d["[[Resolve]]"],d["[[Reject]]"])}catch(f){return d["[[Reject]]"].call(J,f),d["[[Promise]]"]}}}),d(x,"reject",function(a){var c=b(this),d=j(c);d["[[Reject]]"].call(J,a);return d["[[Promise]]"]}),d(x,"resolve",function(a){var c=b(this);if(p(a)){var d=a["[[PromiseConstructor]]"];if(n(d,c))return a}var e=j(c);e["[[Resolve]]"].call(J,a);return e["[[Promise]]"]}),d(x.prototype,"catch",function(a){var b=this;return b.then(J,a)}),x.prototype.constructor=x,d(x.prototype,"then",function(a,b){var c=this;if(!p(c))throw TypeError();l(a)||(a="Identity"),l(b)||(b="Thrower");var d=c.constructor,e=j(d),f={"[[Capabilities]]":e,"[[Handler]]":a},g={"[[Capabilities]]":e,"[[Handler]]":b};if("pending"===c["[[PromiseState]]"])c["[[PromiseFulfillReactions]]"].push(f),c["[[PromiseRejectReactions]]"].push(g);else if("fulfilled"===c["[[PromiseState]]"]){var h=c["[[PromiseResult]]"];y("PromiseJobs",s,[f,h])}else if("rejected"===c["[[PromiseState]]"]){var i=c["[[PromiseResult]]"];y("PromiseJobs",s,[g,i])}return e["[[Promise]]"]}),"Promise"in a&&!I||(a.Promise=x),"cast"in a.Promise&&(a.Promise.resolve=a.Promise.cast)}(),d(Promise.prototype,ka,"Promise"),function(){"Reflect"in a&&!I||(a.Reflect={}),d(Reflect,"apply",function(a,b,c){if(!l(a))throw TypeError();return Function.prototype.apply.call(a,b,c)}),d(Reflect,"construct",function(a,b){return __cons(a,b)}),d(Reflect,"defineProperty",function(a,b,c){try{return Object.defineProperty(a,b,c),!0}catch(d){return!1}}),d(Reflect,"deleteProperty",function(a,b){try{return delete a[b],!s(a,b)}catch(c){return!1}}),d(Reflect,"enumerate",function(a){a=j(a);var b=A(a);return b}),d(Reflect,"get",function(a,b,d){a=j(a),b=String(b),d=d===J?a:j(d);var e=c(a,b);return e&&"get"in e?Function.prototype.call.call(e.get,d):a[b]}),d(Reflect,"getOwnPropertyDescriptor",Object.getOwnPropertyDescriptor),d(Reflect,"getPrototypeOf",Object.getPrototypeOf),d(Reflect,"has",function(a,b){return String(b)in j(a)}),d(Reflect,"isExtensible",Object.isExtensible),d(Reflect,"ownKeys",function(a){var b=j(a);return Object.getOwnPropertyNames(b)}),d(Reflect,"preventExtensions",function(a){try{return Object.preventExtensions(a),!0}catch(b){return!1}}),d(Reflect,"set",function(a,b,d,e){a=j(a),b=String(b),e=e===J?a:j(e);var f=c(a,b);try{return f&&"set"in f?Function.prototype.call.call(f.set,e,d):a[b]=d,!0}catch(g){return!1}}),d(Reflect,"setPrototypeOf",function(a,b){try{return a.__proto__=b,Reflect.getPrototypeOf(a)===b}catch(c){return!1}})}()}(self)},{}],21:[function(a,b,c){!function(){var a=function(b){var c=new a.Builder;
return c.pipeline.add(a.trimmer,a.stopWordFilter,a.stemmer),c.searchPipeline.add(a.stemmer),b.call(c,c),c.build()};a.version="2.3.9",a.utils={},a.utils.warn=function(a){return function(b){a.console&&console.warn&&console.warn(b)}}(this),a.utils.asString=function(a){return void 0===a||null===a?"":a.toString()},a.utils.clone=function(a){if(null===a||void 0===a)return a;for(var b=Object.create(null),c=Object.keys(a),d=0;d<c.length;d++){var e=c[d],f=a[e];if(Array.isArray(f))b[e]=f.slice();else{if("string"!=typeof f&&"number"!=typeof f&&"boolean"!=typeof f)throw new TypeError("clone is not deep and does not support nested objects");b[e]=f}}return b},a.FieldRef=function(a,b,c){this.docRef=a,this.fieldName=b,this._stringValue=c},a.FieldRef.joiner="/",a.FieldRef.fromString=function(b){var c=b.indexOf(a.FieldRef.joiner);if(c===-1)throw"malformed field ref string";var d=b.slice(0,c),e=b.slice(c+1);return new a.FieldRef(e,d,b)},a.FieldRef.prototype.toString=function(){return void 0==this._stringValue&&(this._stringValue=this.fieldName+a.FieldRef.joiner+this.docRef),this._stringValue},a.Set=function(a){if(this.elements=Object.create(null),a){this.length=a.length;for(var b=0;b<this.length;b++)this.elements[a[b]]=!0}else this.length=0},a.Set.complete={intersect:function(a){return a},union:function(){return this},contains:function(){return!0}},a.Set.empty={intersect:function(){return this},union:function(a){return a},contains:function(){return!1}},a.Set.prototype.contains=function(a){return!!this.elements[a]},a.Set.prototype.intersect=function(b){var c,d,e,f=[];if(b===a.Set.complete)return this;if(b===a.Set.empty)return b;this.length<b.length?(c=this,d=b):(c=b,d=this),e=Object.keys(c.elements);for(var g=0;g<e.length;g++){var h=e[g];h in d.elements&&f.push(h)}return new a.Set(f)},a.Set.prototype.union=function(b){return b===a.Set.complete?a.Set.complete:b===a.Set.empty?this:new a.Set(Object.keys(this.elements).concat(Object.keys(b.elements)))},a.Set.prototype.add=function(a){this.contains(a)||(this.elements[a]=!0,this.length+=1)},a.Set.prototype.toArray=function(a){var b=Object.keys(this.elements);return a&&(b=b.map(function(b){return a(b)})),b},a.idf=function(a,b){var c=0;for(var d in a)"_index"!=d&&(c+=Object.keys(a[d]).length);var e=(b-c+.5)/(c+.5);return Math.log(1+Math.abs(e))},a.idf1=function(a,b){var c=(b-a+.5)/(a+.5);return Math.log(1+Math.abs(c))},a.Token=function(a,b){this.str=a||"",this.metadata=b||{}},a.Token.prototype.toString=function(){return this.str},a.Token.prototype.update=function(a){return this.str=a(this.str,this.metadata),this},a.Token.prototype.clone=function(b){return b=b||function(a){return a},new a.Token(b(this.str,this.metadata),this.metadata)},a.tokenizer=function(b,c){if(null==b||void 0==b)return[];if(Array.isArray(b))return b.map(function(b){return new a.Token(a.utils.asString(b).toLowerCase(),a.utils.clone(c))});for(var d=b.toString().toLowerCase(),e=d.length,f=[],g=0,h=0;g<=e;g++){var i=d.charAt(g),j=g-h;if(i.match(a.tokenizer.separator)||g==e){if(j>0){var k=a.utils.clone(c)||{};k.position=[h,j],k.index=f.length,f.push(new a.Token(d.slice(h,g),k))}h=g+1}}return f},a.tokenizer.separator=/[\s\-]+/,a.Pipeline=function(){this._stack=[]},a.Pipeline.registeredFunctions=Object.create(null),a.Pipeline.registerFunction=function(b,c){c in this.registeredFunctions&&a.utils.warn("Overwriting existing registered function: "+c),b.label=c,a.Pipeline.registeredFunctions[b.label]=b},a.Pipeline.warnIfFunctionNotRegistered=function(b){var c=b.label&&b.label in this.registeredFunctions;c||a.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",b)},a.Pipeline.load=function(b){var c=new a.Pipeline;return b.forEach(function(b){var d=a.Pipeline.registeredFunctions[b];if(!d)throw new Error("Cannot load unregistered function: "+b);c.add(d)}),c},a.Pipeline.prototype.add=function(){var b=Array.prototype.slice.call(arguments);b.forEach(function(b){a.Pipeline.warnIfFunctionNotRegistered(b),this._stack.push(b)},this)},a.Pipeline.prototype.after=function(b,c){a.Pipeline.warnIfFunctionNotRegistered(c);var d=this._stack.indexOf(b);if(d==-1)throw new Error("Cannot find existingFn");d+=1,this._stack.splice(d,0,c)},a.Pipeline.prototype.before=function(b,c){a.Pipeline.warnIfFunctionNotRegistered(c);var d=this._stack.indexOf(b);if(d==-1)throw new Error("Cannot find existingFn");this._stack.splice(d,0,c)},a.Pipeline.prototype.remove=function(a){var b=this._stack.indexOf(a);b!=-1&&this._stack.splice(b,1)},a.Pipeline.prototype.run=function(a){for(var b=this._stack.length,c=0;c<b;c++){for(var d=this._stack[c],e=[],f=0;f<a.length;f++){var g=d(a[f],f,a);if(null!==g&&void 0!==g&&""!==g)if(Array.isArray(g))for(var h=0;h<g.length;h++)e.push(g[h]);else e.push(g)}a=e}return a},a.Pipeline.prototype.runString=function(b,c){var d=new a.Token(b,c);return this.run([d]).map(function(a){return a.toString()})},a.Pipeline.prototype.reset=function(){this._stack=[]},a.Pipeline.prototype.toJSON=function(){return this._stack.map(function(b){return a.Pipeline.warnIfFunctionNotRegistered(b),b.label})},a.Vector=function(a){this._magnitude=0,this.elements=a||[]},a.Vector.prototype.positionForIndex=function(a){if(0==this.elements.length)return 0;for(var b=0,c=this.elements.length/2,d=c-b,e=Math.floor(d/2),f=this.elements[2*e];d>1&&(f<a&&(b=e),f>a&&(c=e),f!=a);)d=c-b,e=b+Math.floor(d/2),f=this.elements[2*e];return f==a?2*e:f>a?2*e:f<a?2*(e+1):void 0},a.Vector.prototype.insert=function(a,b){this.upsert(a,b,function(){throw"duplicate index"})},a.Vector.prototype.upsert=function(a,b,c){this._magnitude=0;var d=this.positionForIndex(a);this.elements[d]==a?this.elements[d+1]=c(this.elements[d+1],b):this.elements.splice(d,0,a,b)},a.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var a=0,b=this.elements.length,c=1;c<b;c+=2){var d=this.elements[c];a+=d*d}return this._magnitude=Math.sqrt(a)},a.Vector.prototype.dot=function(a){for(var b=0,c=this.elements,d=a.elements,e=c.length,f=d.length,g=0,h=0,i=0,j=0;i<e&&j<f;)g=c[i],h=d[j],g<h?i+=2:g>h?j+=2:g==h&&(b+=c[i+1]*d[j+1],i+=2,j+=2);return b},a.Vector.prototype.similarity=function(a){return this.dot(a)/this.magnitude()||0},a.Vector.prototype.toArray=function(){for(var a=new Array(this.elements.length/2),b=1,c=0;b<this.elements.length;b+=2,c++)a[c]=this.elements[b];return a},a.Vector.prototype.toJSON=function(){return this.elements},a.stemmer=function(){var a={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},b={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},c="[^aeiou]",d="[aeiouy]",e=c+"[^aeiouy]*",f=d+"[aeiou]*",g="^("+e+")?"+f+e,h="^("+e+")?"+f+e+"("+f+")?$",i="^("+e+")?"+f+e+f+e,j="^("+e+")?"+d,k=new RegExp(g),l=new RegExp(i),m=new RegExp(h),n=new RegExp(j),o=/^(.+?)(ss|i)es$/,p=/^(.+?)([^s])s$/,q=/^(.+?)eed$/,r=/^(.+?)(ed|ing)$/,s=/.$/,t=/(at|bl|iz)$/,u=new RegExp("([^aeiouylsz])\\1$"),v=new RegExp("^"+e+d+"[^aeiouwxy]$"),w=/^(.+?[^aeiou])y$/,x=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,y=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,z=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,A=/^(.+?)(s|t)(ion)$/,B=/^(.+?)e$/,C=/ll$/,D=new RegExp("^"+e+d+"[^aeiouwxy]$"),E=function(c){var d,e,f,g,h,i,j;if(c.length<3)return c;if(f=c.substr(0,1),"y"==f&&(c=f.toUpperCase()+c.substr(1)),g=o,h=p,g.test(c)?c=c.replace(g,"$1$2"):h.test(c)&&(c=c.replace(h,"$1$2")),g=q,h=r,g.test(c)){var E=g.exec(c);g=k,g.test(E[1])&&(g=s,c=c.replace(g,""))}else if(h.test(c)){var E=h.exec(c);d=E[1],h=n,h.test(d)&&(c=d,h=t,i=u,j=v,h.test(c)?c+="e":i.test(c)?(g=s,c=c.replace(g,"")):j.test(c)&&(c+="e"))}if(g=w,g.test(c)){var E=g.exec(c);d=E[1],c=d+"i"}if(g=x,g.test(c)){var E=g.exec(c);d=E[1],e=E[2],g=k,g.test(d)&&(c=d+a[e])}if(g=y,g.test(c)){var E=g.exec(c);d=E[1],e=E[2],g=k,g.test(d)&&(c=d+b[e])}if(g=z,h=A,g.test(c)){var E=g.exec(c);d=E[1],g=l,g.test(d)&&(c=d)}else if(h.test(c)){var E=h.exec(c);d=E[1]+E[2],h=l,h.test(d)&&(c=d)}if(g=B,g.test(c)){var E=g.exec(c);d=E[1],g=l,h=m,i=D,(g.test(d)||h.test(d)&&!i.test(d))&&(c=d)}return g=C,h=l,g.test(c)&&h.test(c)&&(g=s,c=c.replace(g,"")),"y"==f&&(c=f.toLowerCase()+c.substr(1)),c};return function(a){return a.update(E)}}(),a.Pipeline.registerFunction(a.stemmer,"stemmer"),a.generateStopWordFilter=function(a){var b=a.reduce(function(a,b){return a[b]=b,a},{});return function(a){if(a&&b[a.toString()]!==a.toString())return a}},a.stopWordFilter=a.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),a.Pipeline.registerFunction(a.stopWordFilter,"stopWordFilter"),a.trimmer=function(a){return a.update(function(a){return a.replace(/^\W+/,"").replace(/\W+$/,"")})},a.Pipeline.registerFunction(a.trimmer,"trimmer"),a.TokenSet=function(){this["final"]=!1,this.edges={},this.id=a.TokenSet._nextId,a.TokenSet._nextId+=1},a.TokenSet._nextId=1,a.TokenSet.fromArray=function(b){for(var c=new a.TokenSet.Builder,d=0,e=b.length;d<e;d++)c.insert(b[d]);return c.finish(),c.root},a.TokenSet.fromClause=function(b){return"editDistance"in b?a.TokenSet.fromFuzzyString(b.term,b.editDistance):a.TokenSet.fromString(b.term)},a.TokenSet.fromFuzzyString=function(b,c){for(var d=new a.TokenSet,e=[{node:d,editsRemaining:c,str:b}];e.length;){var f=e.pop();if(f.str.length>0){var g,h=f.str.charAt(0);h in f.node.edges?g=f.node.edges[h]:(g=new a.TokenSet,f.node.edges[h]=g),1==f.str.length&&(g["final"]=!0),e.push({node:g,editsRemaining:f.editsRemaining,str:f.str.slice(1)})}if(0!=f.editsRemaining){if("*"in f.node.edges)var i=f.node.edges["*"];else{var i=new a.TokenSet;f.node.edges["*"]=i}if(0==f.str.length&&(i["final"]=!0),e.push({node:i,editsRemaining:f.editsRemaining-1,str:f.str}),f.str.length>1&&e.push({node:f.node,editsRemaining:f.editsRemaining-1,str:f.str.slice(1)}),1==f.str.length&&(f.node["final"]=!0),f.str.length>=1){if("*"in f.node.edges)var j=f.node.edges["*"];else{var j=new a.TokenSet;f.node.edges["*"]=j}1==f.str.length&&(j["final"]=!0),e.push({node:j,editsRemaining:f.editsRemaining-1,str:f.str.slice(1)})}if(f.str.length>1){var k,l=f.str.charAt(0),m=f.str.charAt(1);m in f.node.edges?k=f.node.edges[m]:(k=new a.TokenSet,f.node.edges[m]=k),1==f.str.length&&(k["final"]=!0),e.push({node:k,editsRemaining:f.editsRemaining-1,str:l+f.str.slice(2)})}}}return d},a.TokenSet.fromString=function(b){for(var c=new a.TokenSet,d=c,e=0,f=b.length;e<f;e++){var g=b[e],h=e==f-1;if("*"==g)c.edges[g]=c,c["final"]=h;else{var i=new a.TokenSet;i["final"]=h,c.edges[g]=i,c=i}}return d},a.TokenSet.prototype.toArray=function(){for(var a=[],b=[{prefix:"",node:this}];b.length;){var c=b.pop(),d=Object.keys(c.node.edges),e=d.length;c.node["final"]&&(c.prefix.charAt(0),a.push(c.prefix));for(var f=0;f<e;f++){var g=d[f];b.push({prefix:c.prefix.concat(g),node:c.node.edges[g]})}}return a},a.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var a=this["final"]?"1":"0",b=Object.keys(this.edges).sort(),c=b.length,d=0;d<c;d++){var e=b[d],f=this.edges[e];a=a+e+f.id}return a},a.TokenSet.prototype.intersect=function(b){for(var c=new a.TokenSet,d=void 0,e=[{qNode:b,output:c,node:this}];e.length;){d=e.pop();for(var f=Object.keys(d.qNode.edges),g=f.length,h=Object.keys(d.node.edges),i=h.length,j=0;j<g;j++)for(var k=f[j],l=0;l<i;l++){var m=h[l];if(m==k||"*"==k){var n=d.node.edges[m],o=d.qNode.edges[k],p=n["final"]&&o["final"],q=void 0;m in d.output.edges?(q=d.output.edges[m],q["final"]=q["final"]||p):(q=new a.TokenSet,q["final"]=p,d.output.edges[m]=q),e.push({qNode:o,output:q,node:n})}}}return c},a.TokenSet.Builder=function(){this.previousWord="",this.root=new a.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},a.TokenSet.Builder.prototype.insert=function(b){var c,d=0;if(b<this.previousWord)throw new Error("Out of order word insertion");for(var e=0;e<b.length&&e<this.previousWord.length&&b[e]==this.previousWord[e];e++)d++;this.minimize(d),c=0==this.uncheckedNodes.length?this.root:this.uncheckedNodes[this.uncheckedNodes.length-1].child;for(var e=d;e<b.length;e++){var f=new a.TokenSet,g=b[e];c.edges[g]=f,this.uncheckedNodes.push({parent:c,"char":g,child:f}),c=f}c["final"]=!0,this.previousWord=b},a.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},a.TokenSet.Builder.prototype.minimize=function(a){for(var b=this.uncheckedNodes.length-1;b>=a;b--){var c=this.uncheckedNodes[b],d=c.child.toString();d in this.minimizedNodes?c.parent.edges[c["char"]]=this.minimizedNodes[d]:(c.child._str=d,this.minimizedNodes[d]=c.child),this.uncheckedNodes.pop()}},a.Index=function(a){this.invertedIndex=a.invertedIndex,this.fieldVectors=a.fieldVectors,this.tokenSet=a.tokenSet,this.fields=a.fields,this.pipeline=a.pipeline,this.documentCount=a.documentCount},a.Index.prototype.search=function(b){return this.query(function(c){var d=new a.QueryParser(b,c);d.parse()})},a.Index.prototype.query=function(b,c){for(var d=new a.Query(this.fields),e=new a.QueryOpts(c),f=Object.create(null),g=Object.create(null),h=Object.create(null),i=Object.create(null),j=Object.create(null),k=[],l=Object.create(null),m=e.get("proximityScoring"),n=0;n<this.fields.length;n++)g[this.fields[n]]=new a.Vector;b.call(d,d);for(var n=0;n<d.clauses.length;n++){var o=d.clauses[n],p=null,q=a.Set.empty,r=o.name;p=o.usePipeline?this.pipeline.runString(o.term,{fields:o.fields}):[o.term],m&&k.findIndex(function(a){return a===r})===-1&&(k.push(r),l[r]=new a.Set(p));for(var s=0;s<p.length;s++){var t=p[s];m&&l[r].add(t),o.term=t;var u=a.TokenSet.fromClause(o),v=this.tokenSet.intersect(u).toArray();if(0===v.length&&o.presence===a.Query.presence.REQUIRED){for(var w=0;w<o.fields.length;w++){var x=o.fields[w];i[x]=a.Set.empty}break}for(var y=0;y<v.length;y++){var z=v[y],A=this.invertedIndex[z],B=A._index;m&&l[r].add(z);for(var w=0;w<o.fields.length;w++){var x=o.fields[w],C=A[x],D=Object.keys(C),E=z+"/"+x,F=new a.Set(D);if(o.presence==a.Query.presence.REQUIRED&&(q=q.union(F),void 0===i[x]&&(i[x]=a.Set.complete)),o.presence!=a.Query.presence.PROHIBITED){if(g[x].upsert(B,o.boost,function(a,b){return a+b}),!h[E]){for(var G=0;G<D.length;G++){var H,I=D[G],J=new a.FieldRef(I,x),K=C[I];void 0===(H=f[J])?f[J]=new a.MatchData(z,x,K):H.add(z,x,K)}h[E]=!0}}else void 0===j[x]&&(j[x]=a.Set.empty),j[x]=j[x].union(F)}}}if(o.presence===a.Query.presence.REQUIRED)for(var w=0;w<o.fields.length;w++){var x=o.fields[w];i[x]=i[x].intersect(q)}}for(var L=a.Set.complete,M=a.Set.empty,n=0;n<this.fields.length;n++){var x=this.fields[n];i[x]&&(L=L.intersect(i[x])),j[x]&&(M=M.union(j[x]))}var N=Object.keys(f),O=[],P=Object.create(null);if(d.isNegated()){N=Object.keys(this.fieldVectors);for(var n=0;n<N.length;n++){var J=N[n],Q=a.FieldRef.fromString(J);f[J]=new a.MatchData}}for(var n=0;n<N.length;n++){var Q=a.FieldRef.fromString(N[n]),R=Q.docRef;if(L.contains(R)&&!M.contains(R)){var S,T=this.fieldVectors[Q],U=g[Q.fieldName].similarity(T);if(void 0!==(S=P[R]))S.score+=U,S.matchData.combine(f[Q]);else{var V={ref:R,score:U,matchData:f[Q]};P[R]=V,O.push(V)}}}if(m)for(var W=this.getTermFieldBoost(b),n=0;n<O.length;n++){var S=O[n];S.proximityScore=a.computeProximityScore(S.matchData,{terms:k,termsMap:l,fields:this.fields,boost:W,windowThreshold:e.get("windowThreshold"),orderSimilarity:e.get("orderSimilarity")})}var X=a.Index.compareFn(e);return X?O.sort(X):O},a.Index.prototype.toJSON=function(){var b=Object.keys(this.invertedIndex).sort().map(function(a){return[a,this.invertedIndex[a]]},this),c=Object.keys(this.fieldVectors).map(function(a){return[a,this.fieldVectors[a].toJSON()]},this);return{version:a.version,fields:this.fields,fieldVectors:c,invertedIndex:b,pipeline:this.pipeline.toJSON()}},a.Index.load=function(b){var c={},d={},e=b.fieldVectors,f=Object.create(null),g=b.invertedIndex,h=new a.TokenSet.Builder,i=a.Pipeline.load(b.pipeline),j=b.documentCount;b.version!=a.version&&a.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+a.version+"' does not match serialized index '"+b.version+"'");for(var k=0;k<e.length;k++){var l=e[k],m=l[0],n=l[1];d[m]=new a.Vector(n)}for(var k=0;k<g.length;k++){var l=g[k],o=l[0],p=l[1];h.insert(o),f[o]=p}return h.finish(),c.fields=b.fields,c.fieldVectors=d,c.invertedIndex=f,c.tokenSet=h.root,c.pipeline=i,c.documentCount=j,new a.Index(c)},a.Index.mergeResults=function(b,c,d,e){if(!b||0===b.length)return b;var f,g,h=new a.QueryOpts(e),i=[],j=[],k=Object.create(null),l=Object.create(null),m=Object.create(null),n=[],o=0,p=Object.create(null),q=Object.create(null),r=Object.create(null),s=Object.create(null),t=h.get("proximityScoring");if(b.forEach(function(b){var c,d=n.findIndex(function(a){return a===b.index}),e=b.queryTerm;if(d===-1&&(n.push(b.index),d=n.length-1,m[d]=[]),j.findIndex(function(a){return a===e})===-1&&j.push(e),p[e]?p[e]+=1:p[e]=1,q[d]?q[d][e]?q[d][e]+=1:q[d][e]=1:(q[d]=Object.create(null),q[d][e]=1),v=k[e])for(var f in b.matchData.metadata)v.add(f);else k[e]=new a.Set(Object.keys(b.matchData.metadata));void 0!==(c=l[b.ref])?(c.score+=b.score,c.matchData.combine(b.matchData)):(l[b.ref]=b,m[d].push(b),i.push(b))}),o=n.reduce(function(a,b){return a+b.documentCount},0),n.forEach(function(b,c){j.forEach(function(d){s[c]||(s[c]=Object.create(null)),s[c][d]=a.idf1(q[c][d],b.documentCount),r[d]||(r[d]=a.idf1(p[d],o))})}),i.forEach(function(a){var b=n.findIndex(function(b){return b===a.index});a.score/=s[b][a.queryTerm],a.score*=r[a.queryTerm]}),t)for(var u in m){var v,w,x,y=m[u];f=n[u],g=null,c&&(x=c.findIndex(function(a){return a.index===f}),x!==-1&&(w=c[x].clauses,g=f.getTermFieldBoost(function(a){return d.call(this,a,w)}))),y.forEach(function(b){b.proximityScore=a.computeProximityScore(b.matchData,{terms:j,termsMap:k,fields:f.fields,boost:g,windowThreshold:h.get("windowThreshold"),orderSimilarity:h.get("orderSimilarity")})})}var z=a.Index.compareFn(h);return z?i.sort(z):i},a.Index.compareFn=function(a){var b;return a.get("proximityScoring")?b=function(a,b){return a.proximityScore!==b.proximityScore?b.proximityScore-a.proximityScore:b.score-a.score}:a.get("sort")&&(b=function(a,b){return b.score-a.score}),b},a.Index.prototype.getTermFieldBoost=function(b){var c=Object.create(null),d=new a.Query(this.fields);b.call(d,d);for(var e=0;e<d.clauses.length;e++){var f=d.clauses[e],g=null;g=f.usePipeline?this.pipeline.runString(f.term,{fields:f.fields}):[f.term];for(var h=0;h<g.length;h++){for(var i=g[h],j=0;j<f.fields.length;j++){var k=f.fields[j],l=i+"/"+k;c[l]=f.boost}f.term=i;for(var m=a.TokenSet.fromClause(f),n=this.tokenSet.intersect(m).toArray(),o=0;o<n.length;o++)for(var p=n[o],j=0;j<f.fields.length;j++){var k=f.fields[j],l=p+"/"+k;c[l]||(c[l]=f.boost)}}}return c},a.Builder=function(){this._ref="id",this._fields=Object.create(null),this._documents=Object.create(null),this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=a.tokenizer,this.pipeline=new a.Pipeline,this.searchPipeline=new a.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]},a.Builder.prototype.ref=function(a){this._ref=a},a.Builder.prototype.field=function(a,b){if(/\//.test(a))throw new RangeError("Field '"+a+"' contains illegal character '/'");this._fields[a]=b||{}},a.Builder.prototype.b=function(a){a<0?this._b=0:a>1?this._b=1:this._b=a},a.Builder.prototype.k1=function(a){this._k1=a},a.Builder.prototype.add=function(b,c){var d=b[this._ref],e=Object.keys(this._fields);this._documents[d]=c||{},this.documentCount+=1;for(var f=0;f<e.length;f++){var g=e[f],h=this._fields[g].extractor,i=h?h(b):b[g],j=this.tokenizer(i,{fields:[g]}),k=this.pipeline.run(j),l=new a.FieldRef(d,g),m=Object.create(null);this.fieldTermFrequencies[l]=m,this.fieldLengths[l]=0,this.fieldLengths[l]+=k.length;for(var n=0;n<k.length;n++){var o=k[n];if(void 0==m[o]&&(m[o]=0),m[o]+=1,void 0==this.invertedIndex[o]){var p=Object.create(null);p._index=this.termIndex,this.termIndex+=1;for(var q=0;q<e.length;q++)p[e[q]]=Object.create(null);this.invertedIndex[o]=p}void 0==this.invertedIndex[o][g][d]&&(this.invertedIndex[o][g][d]=Object.create(null));for(var r=0;r<this.metadataWhitelist.length;r++){var s=this.metadataWhitelist[r],t=o.metadata[s];void 0==this.invertedIndex[o][g][d][s]&&(this.invertedIndex[o][g][d][s]=[]),this.invertedIndex[o][g][d][s].push(t)}}}},a.Builder.prototype.calculateAverageFieldLengths=function(){for(var b=Object.keys(this.fieldLengths),c=b.length,d={},e={},f=0;f<c;f++){var g=a.FieldRef.fromString(b[f]),h=g.fieldName;e[h]||(e[h]=0),e[h]+=1,d[h]||(d[h]=0),d[h]+=this.fieldLengths[g]}for(var i=Object.keys(this._fields),f=0;f<i.length;f++){var j=i[f];d[j]=d[j]/e[j]}this.averageFieldLength=d},a.Builder.prototype.createFieldVectors=function(){for(var b={},c=Object.keys(this.fieldTermFrequencies),d=c.length,e=Object.create(null),f=0;f<d;f++){for(var g=a.FieldRef.fromString(c[f]),h=g.fieldName,i=this.fieldLengths[g],j=new a.Vector,k=this.fieldTermFrequencies[g],l=Object.keys(k),m=l.length,n=this._fields[h].boost||1,o=this._documents[g.docRef].boost||1,p=0;p<m;p++){var q,r,s,t=l[p],u=k[t],v=this.invertedIndex[t]._index;void 0===e[t]?(q=a.idf(this.invertedIndex[t],this.documentCount),e[t]=q):q=e[t],r=q*((this._k1+1)*u)/(this._k1*(1-this._b+this._b*(i/this.averageFieldLength[h]))+u),r*=n,r*=o,s=Math.round(1e3*r)/1e3,j.insert(v,s)}b[g]=j}this.fieldVectors=b},a.Builder.prototype.createTokenSet=function(){this.tokenSet=a.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},a.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new a.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})},a.Builder.prototype.use=function(a){var b=Array.prototype.slice.call(arguments,1);b.unshift(this),a.apply(this,b)},a.MatchData=function(a,b,c){for(var d=Object.create(null),e=Object.keys(c||{}),f=0;f<e.length;f++){var g=e[f];d[g]=c[g].slice()}this.metadata=Object.create(null),void 0!==a&&(this.metadata[a]=Object.create(null),this.metadata[a][b]=d)},a.MatchData.prototype.combine=function(a){for(var b=Object.keys(a.metadata),c=0;c<b.length;c++){var d=b[c],e=Object.keys(a.metadata[d]);void 0==this.metadata[d]&&(this.metadata[d]=Object.create(null));for(var f=0;f<e.length;f++){var g=e[f],h=Object.keys(a.metadata[d][g]);void 0==this.metadata[d][g]&&(this.metadata[d][g]=Object.create(null));for(var i=0;i<h.length;i++){var j=h[i];void 0==this.metadata[d][g][j]?this.metadata[d][g][j]=a.metadata[d][g][j]:this.metadata[d][g][j]=this.metadata[d][g][j].concat(a.metadata[d][g][j])}}}},a.MatchData.prototype.add=function(a,b,c){if(!(a in this.metadata))return this.metadata[a]=Object.create(null),void(this.metadata[a][b]=c);if(!(b in this.metadata[a]))return void(this.metadata[a][b]=c);for(var d=Object.keys(c),e=0;e<d.length;e++){var f=d[e];f in this.metadata[a][b]?this.metadata[a][b][f]=this.metadata[a][b][f].concat(c[f]):this.metadata[a][b][f]=c[f]}},a.Query=function(a){this.clauses=[],this.allFields=a},a.Query.wildcard=new String("*"),a.Query.wildcard.NONE=0,a.Query.wildcard.LEADING=1,a.Query.wildcard.TRAILING=2,a.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3},a.Query.prototype.clause=function(b){return"fields"in b||(b.fields=this.allFields),"boost"in b||(b.boost=1),"usePipeline"in b||(b.usePipeline=!0),"wildcard"in b||(b.wildcard=a.Query.wildcard.NONE),b.wildcard&a.Query.wildcard.LEADING&&b.term.charAt(0)!=a.Query.wildcard&&(b.term="*"+b.term),b.wildcard&a.Query.wildcard.TRAILING&&b.term.slice(-1)!=a.Query.wildcard&&(b.term=""+b.term+"*"),"presence"in b||(b.presence=a.Query.presence.OPTIONAL),this.clauses.push(b),this},a.Query.prototype.isNegated=function(){for(var b=0;b<this.clauses.length;b++)if(this.clauses[b].presence!=a.Query.presence.PROHIBITED)return!1;return!0},a.Query.prototype.term=function(b,c){if(Array.isArray(b))return b.forEach(function(b){this.term(b,a.utils.clone(c))},this),this;var d=c||{};return d.term=b.toString(),this.clause(d),this},a.QueryParseError=function(a,b,c){this.name="QueryParseError",this.message=a,this.start=b,this.end=c},a.QueryParseError.prototype=new Error,a.QueryLexer=function(a){this.lexemes=[],this.str=a,this.length=a.length,this.pos=0,this.start=0,this.escapeCharPositions=[]},a.QueryLexer.prototype.run=function(){for(var b=a.QueryLexer.lexText;b;)b=b(this)},a.QueryLexer.prototype.sliceString=function(){for(var a=[],b=this.start,c=this.pos,d=0;d<this.escapeCharPositions.length;d++)c=this.escapeCharPositions[d],a.push(this.str.slice(b,c)),b=c+1;return a.push(this.str.slice(b,this.pos)),this.escapeCharPositions.length=0,a.join("")},a.QueryLexer.prototype.emit=function(a){this.lexemes.push({type:a,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},a.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},a.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return a.QueryLexer.EOS;var b=this.str.charAt(this.pos);return this.pos+=1,b},a.QueryLexer.prototype.width=function(){return this.pos-this.start},a.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},a.QueryLexer.prototype.backup=function(){this.pos-=1},a.QueryLexer.prototype.acceptDigitRun=function(){var b,c;do b=this.next(),c=b.charCodeAt(0);while(c>47&&c<58);b!=a.QueryLexer.EOS&&this.backup()},a.QueryLexer.prototype.more=function(){return this.pos<this.length},a.QueryLexer.EOS="EOS",a.QueryLexer.FIELD="FIELD",a.QueryLexer.TERM="TERM",a.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",a.QueryLexer.BOOST="BOOST",a.QueryLexer.PRESENCE="PRESENCE",a.QueryLexer.lexField=function(b){return b.backup(),b.emit(a.QueryLexer.FIELD),b.ignore(),a.QueryLexer.lexText},a.QueryLexer.lexTerm=function(b){if(b.width()>1&&(b.backup(),b.emit(a.QueryLexer.TERM)),b.ignore(),b.more())return a.QueryLexer.lexText},a.QueryLexer.lexEditDistance=function(b){return b.ignore(),b.acceptDigitRun(),b.emit(a.QueryLexer.EDIT_DISTANCE),a.QueryLexer.lexText},a.QueryLexer.lexBoost=function(b){return b.ignore(),b.acceptDigitRun(),b.emit(a.QueryLexer.BOOST),a.QueryLexer.lexText},a.QueryLexer.lexEOS=function(b){b.width()>0&&b.emit(a.QueryLexer.TERM)},a.QueryLexer.termSeparator=a.tokenizer.separator,a.QueryLexer.lexText=function(b){for(;;){var c=b.next();if(c==a.QueryLexer.EOS)return a.QueryLexer.lexEOS;if(92!=c.charCodeAt(0)){if(":"==c)return a.QueryLexer.lexField;if("~"==c)return b.backup(),b.width()>0&&b.emit(a.QueryLexer.TERM),a.QueryLexer.lexEditDistance;if("^"==c)return b.backup(),b.width()>0&&b.emit(a.QueryLexer.TERM),a.QueryLexer.lexBoost;if("+"==c&&1===b.width())return b.emit(a.QueryLexer.PRESENCE),a.QueryLexer.lexText;if("-"==c&&1===b.width())return b.emit(a.QueryLexer.PRESENCE),a.QueryLexer.lexText;if(c.match(a.QueryLexer.termSeparator))return a.QueryLexer.lexTerm}else b.escapeCharacter()}},a.QueryParser=function(b,c){this.lexer=new a.QueryLexer(b),this.query=c,this.currentClause={},this.lexemeIdx=0},a.QueryParser.prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var b=a.QueryParser.parseClause;b;)b=b(this);return this.query},a.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},a.QueryParser.prototype.consumeLexeme=function(){var a=this.peekLexeme();return this.lexemeIdx+=1,a},a.QueryParser.prototype.nextClause=function(){var a=this.currentClause;this.query.clause(a),this.currentClause={}},a.QueryParser.parseClause=function(b){var c=b.peekLexeme();if(void 0!=c)switch(c.type){case a.QueryLexer.PRESENCE:return a.QueryParser.parsePresence;case a.QueryLexer.FIELD:return a.QueryParser.parseField;case a.QueryLexer.TERM:return a.QueryParser.parseTerm;default:var d="expected either a field or a term, found "+c.type;throw c.str.length>=1&&(d+=" with value '"+c.str+"'"),new a.QueryParseError(d,c.start,c.end)}},a.QueryParser.parsePresence=function(b){var c=b.consumeLexeme();if(void 0!=c){switch(c.str){case"-":b.currentClause.presence=a.Query.presence.PROHIBITED;break;case"+":b.currentClause.presence=a.Query.presence.REQUIRED;break;default:var d="unrecognised presence operator'"+c.str+"'";throw new a.QueryParseError(d,c.start,c.end)}var e=b.peekLexeme();if(void 0==e){var d="expecting term or field, found nothing";throw new a.QueryParseError(d,c.start,c.end)}switch(e.type){case a.QueryLexer.FIELD:return a.QueryParser.parseField;case a.QueryLexer.TERM:return a.QueryParser.parseTerm;default:var d="expecting term or field, found '"+e.type+"'";throw new a.QueryParseError(d,e.start,e.end)}}},a.QueryParser.parseField=function(b){var c=b.consumeLexeme();if(void 0!=c){if(b.query.allFields.indexOf(c.str)==-1){var d=b.query.allFields.map(function(a){return"'"+a+"'"}).join(", "),e="unrecognised field '"+c.str+"', possible fields: "+d;throw new a.QueryParseError(e,c.start,c.end)}b.currentClause.fields=[c.str];var f=b.peekLexeme();if(void 0==f){var e="expecting term, found nothing";throw new a.QueryParseError(e,c.start,c.end)}switch(f.type){case a.QueryLexer.TERM:return a.QueryParser.parseTerm;default:var e="expecting term, found '"+f.type+"'";throw new a.QueryParseError(e,f.start,f.end)}}},a.QueryParser.parseTerm=function(b){var c=b.consumeLexeme();if(void 0!=c){b.currentClause.term=c.str.toLowerCase(),c.str.indexOf("*")!=-1&&(b.currentClause.usePipeline=!1);var d=b.peekLexeme();if(void 0==d)return void b.nextClause();switch(d.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;case a.QueryLexer.PRESENCE:return b.nextClause(),a.QueryParser.parsePresence;default:var e="Unexpected lexeme type '"+d.type+"'";throw new a.QueryParseError(e,d.start,d.end)}}},a.QueryParser.parseEditDistance=function(b){var c=b.consumeLexeme();if(void 0!=c){var d=parseInt(c.str,10);if(isNaN(d)){var e="edit distance must be numeric";throw new a.QueryParseError(e,c.start,c.end)}b.currentClause.editDistance=d;var f=b.peekLexeme();if(void 0==f)return void b.nextClause();switch(f.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;case a.QueryLexer.PRESENCE:return b.nextClause(),a.QueryParser.parsePresence;default:var e="Unexpected lexeme type '"+f.type+"'";throw new a.QueryParseError(e,f.start,f.end)}}},a.QueryParser.parseBoost=function(b){var c=b.consumeLexeme();if(void 0!=c){var d=parseInt(c.str,10);if(isNaN(d)){var e="boost must be numeric";throw new a.QueryParseError(e,c.start,c.end)}b.currentClause.boost=d;var f=b.peekLexeme();if(void 0==f)return void b.nextClause();switch(f.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),
a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;case a.QueryLexer.PRESENCE:return b.nextClause(),a.QueryParser.parsePresence;default:var e="Unexpected lexeme type '"+f.type+"'";throw new a.QueryParseError(e,f.start,f.end)}}},a.TermPosition=function(a,b,c){this.pos=a,this.term=b,this.expandedTerm=c},a.Interval=function(a,b,c){this.left=a,this.right=b,this.positions=[].concat(c),this.similarity=1,this.length=Math.abs(this.right.pos-this.left.pos)},a.computeProximityScore=function(b,c){var d=b.metadata,e=0;if(!d)return e;var f=c.terms||[],g=c.boost||{},h=c.termsMap||{},i=c.orderSimilarity!==!1;if(f.length<2)return e;var j,k=c.fields||[],l={},m=k.reduce(function(a,b){var c=f.reduce(function(a,c,e){l[c]=e+1;var f=(h[c]?h[c].toArray():[]).reduce(function(a,c){return l[c]=e+1,d[c]&&d[c][b]&&d[c][b].position?a.concat(d[c][b].position.map(function(a){return{pos:a[0]+1e3*(a[2]||0),expandedTerm:c}})):a},[]);return f.sort(function(a,b){return a.pos-b.pos}),a[c]=f,a},{});return a[b]=c,a},{}),n=c.windowThreshold||50,o=Object.keys(m).reduce(function(b,c){var d=m[c],e=a.getIntervals(f,d);return e=e.filter(function(a){return a.length<n}),b[c]=e,b},{});if(i){for(var p=new a.Vector,q=0;q<f.length;q++)p.insert(q,l[f[q]]);j=function(b){return a.getSimilarity(b,p,l)}}return e=a.getAverageCloseness(o,g,j),Math.round(1e3*e)/1e3},a.getIntervals=function(b,c){var d,e,f,g=[],h=b.reduce(function(a,b){return c[b].length>0&&a},!0);if(!h)return g;for(d=b.map(function(b){var d=c[b].shift();return new a.TermPosition(d.pos,b,d.expandedTerm)}),d.sort(function(a,b){return a.pos-b.pos}),e=d[0],f=d[d.length-1];c[e.term].length>0;){var i=c[e.term].shift(),j=new a.TermPosition(i.pos,e.term,i.expandedTerm),k=d[1];if(j.pos>f.pos)g.push(new a.Interval(e,f,d)),e=k,f=j,d.shift(),d.push(j);else if(j.pos<k.pos)e=j,d[0]=j;else{e=k,d[0]=k;for(var l=1;d[l].pos<j.pos&&l<d.length-2;)d[l]=d[l+1],l++;d[l]=j}}return g.push(new a.Interval(e,f,d)),g},a.getAverageCloseness=function(a,b,c){return b=b||{},Object.keys(a).reduce(function(d,e){var f=a[e];if(0===f.length)return d;var g=f.reduce(function(a,d){c&&(d.similarity=c(d));var f=d.positions.reduce(function(a,c){return a+(b[c.expandedTerm+"/"+e]||1)},0)/d.positions.length;return a+d.similarity*f/Math.log(d.length)},0)/f.length;return d+g},0)},a.getSimilarity=function(b,c,d){for(var e=b.positions.reduce(function(a,b){return a.findIndex(function(a){return a===b.term})===-1&&a.push(b.term),a},[]),f=new a.Vector,g=0;g<e.length;g++)f.insert(g,d[e[g]]);return c.similarity(f)},a.QueryOpts=function(a){if(this._opts={proximityScoring:!0,windowThreshold:50,orderSimilarity:!0,sort:!0},a)for(var b in a)a.hasOwnProperty(b)&&(this._opts[b]=a[b])},a.QueryOpts.prototype.get=function(a){return this._opts[a]},function(a,d){"function"==typeof define&&define.amd?define(d):"object"==typeof c?b.exports=d():a.lunr=d()}(this,function(){return a})}()},{}],22:[function(a,b,c){"use strict";a("./shim/array"),a("./shim/object")},{"./shim/array":23,"./shim/object":24}],23:[function(a,b,c){"use strict";Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(a,b){return this.indexOf(a,b)!==-1}})},{}],24:[function(a,b,c){"use strict";Object.entries||(Object.entries=function(a){for(var b=Object.keys(a),c=b.length,d=new Array(c);c--;)d[c]=[b[c],a[b[c]]];return d})},{}],25:[function(a,b,c){(function(c){(function(){"use strict";a("../frameworks/shim"),a("js-polyfills/es5"),a("js-polyfills/es6"),void 0===c.rh&&(c.rh={}),b.exports=c.rh}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../frameworks/shim":22,"js-polyfills/es5":19,"js-polyfills/es6":20}],26:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this._callback=b,this._count=0}return e(a,[{key:"signal",value:function(){this._count++,this._count>=0&&this._callback&&this._callback()}},{key:"wait",value:function(a){var b=a||1;this._count-=b}}]),a}();b.exports=f},{}],27:[function(a,b,c){"use strict";a("../lib/rh"),a("../../lenient_src/robohelp/layout/url_utils"),a("../../lenient_src/robohelp/layout/init"),a("../../lenient_src/robohelp/layout/mp"),a("../../lenient_src/robohelp/layout/expression_builder"),a("../../lenient_src/robohelp/layout/browsesequence_builder"),a("../../lenient_src/robohelp/layout/search_filed"),a("../../lenient_src/robohelp/layout/layoutfix"),a("../../lenient_src/robohelp/layout/filter_controller"),a("../../lenient_src/robohelp/layout/modern_layout_controller"),a("../../lenient_src/robohelp/layout/js_loading_controller"),a("../../lenient_src/robohelp/layout/load_projects"),a("./layout/ui/carousel"),a("./layout/home_controller"),a("../../lenient_src/layout/search_util"),a("./layout/search/suggestion/search_controller"),a("./layout/favorites_controller"),a("./layout/toc_breadcrumbs_controller.js"),a("../../lenient_src/layout/toc_order"),a("../../lenient_src/layout/toc_controller"),a("../../lenient_src/layout/index_controller"),a("../../lenient_src/layout/glossary_controller"),a("../../lenient_src/layout/event_handlers"),a("./layout/rh2017layoutcontroller"),a("./layout/modal_dialog"),a("./layout/search_result_controller.js"),a("../../lenient_src/robohelp/layout/filter_handler"),a("./layout/custom_buttons"),a("./layout/expand_all")},{"../../lenient_src/layout/event_handlers":1,"../../lenient_src/layout/glossary_controller":2,"../../lenient_src/layout/index_controller":3,"../../lenient_src/layout/search_util":4,"../../lenient_src/layout/toc_controller":5,"../../lenient_src/layout/toc_order":6,"../../lenient_src/robohelp/layout/browsesequence_builder":7,"../../lenient_src/robohelp/layout/expression_builder":8,"../../lenient_src/robohelp/layout/filter_controller":9,"../../lenient_src/robohelp/layout/filter_handler":10,"../../lenient_src/robohelp/layout/init":11,"../../lenient_src/robohelp/layout/js_loading_controller":12,"../../lenient_src/robohelp/layout/layoutfix":13,"../../lenient_src/robohelp/layout/load_projects":14,"../../lenient_src/robohelp/layout/modern_layout_controller":15,"../../lenient_src/robohelp/layout/mp":16,"../../lenient_src/robohelp/layout/search_filed":17,"../../lenient_src/robohelp/layout/url_utils":18,"../lib/rh":25,"./layout/custom_buttons":28,"./layout/expand_all":29,"./layout/favorites_controller":30,"./layout/home_controller":31,"./layout/modal_dialog":32,"./layout/rh2017layoutcontroller":33,"./layout/search/suggestion/search_controller":50,"./layout/search_result_controller.js":65,"./layout/toc_breadcrumbs_controller.js":66,"./layout/ui/carousel":67}],28:[function(a,b,c){"use strict";var rh=a("../../lib/rh"),d=rh.consts,e=rh.model,f=rh._;e.subscribe(d("KEY_CUSTOM_BUTTONS_CONFIG"),function(a){var b=f.map(a,function(a,b){return f.extend({"class":"custom-button-"+b},a)});e.publish(d("KEY_CUSTOM_BUTTONS"),b)})},{"../../lib/rh":25}],29:[function(a,b,c){"use strict";var rh=a("../../lib/rh");rh.model.csubscribe("EVT_EXPAND_COLLAPSE_ALL",function(){var a=rh.model.cget("ALL_ARE_EXPANDED");a?rh.model.cpublish("EVT_COLLAPSE_ALL"):rh.model.cpublish("EVT_EXPAND_ALL")}),rh.model.csubscribe("EVT_COLLAPSE_ALL",function(){rh.model.cpublish("ALL_ARE_EXPANDED",!1)}),rh.model.csubscribe("EVT_EXPAND_ALL",function(){rh.model.cpublish("ALL_ARE_EXPANDED",!0)})},{"../../lib/rh":25}],30:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=rh.consts,g=function(){function a(b){var c=this;d(this,a),this.widget=b,this.favStorage=new rh.Storage,this._loadFromStorage=!1,this._favMemoryStore=void 0,rh.model.subscribeOnce(f("EVT_PROJECT_LOADED"),function(){c.init()})}return e(a,[{key:"_getUniqueId",value:function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return a()+a(!0)+a(!0)+a()}},{key:"numberOfItems",value:function(a){return Object.keys(a).length}},{key:"_getFavHTMLElements",value:function(a){for(var b=document.getElementsByTagName("div"),c=[],d=0;d<b.length;d++)b[d].getAttribute(rh.consts("FAVATTRIBUTE"))===a&&c.push(b[d]);return c}},{key:"getLinkTitle",value:function(a){var b=rh.model.get(f("KEY_LNG"));return a?b&&b.unsetAsFavorite||"":b&&b.setAsFavorite||""}},{key:"_loadFavoritesFromStorage",value:function(){var a=void 0,b=this.favStorage.fetch(f("FAVSTORAGE"));return a="undefined"==typeof b||null===b?{}:JSON.parse(b)}},{key:"_loadFavorites",value:function(){return this._loadFromStorage===!1&&(this._favMemoryStore=this._loadFavoritesFromStorage()),this._favMemoryStore}},{key:"_saveFavorites",value:function(){var a=void 0;a=JSON.stringify(this._favMemoryStore),this.favStorage.persist(rh.consts("FAVSTORAGE"),a)}},{key:"_unFavoriteTopic",value:function(a){for(var b in this._favMemoryStore){var c=this._favMemoryStore[b];if(c.topic===a){delete this._favMemoryStore[b];break}}this._saveFavorites(),rh.model.publish(rh.consts("EVENTFAVCHANGE"),null)}},{key:"_favoriteTopic",value:function(a,b){this._favMemoryStore[this._getUniqueId()]={topic:a,title:b},this._saveFavorites(),rh.model.publish(rh.consts("EVENTFAVCHANGE"),null)}},{key:"getStorageId",value:function(){return"fav-"+rh._.getHostFolder()}},{key:"getTopicURL",value:function(){return rh.model.get(rh.consts("KEY_TOPIC_URL"))}},{key:"getTopicTitle",value:function(){return rh.model.get(rh.consts("KEY_TOPIC_TITLE"))}},{key:"isTopicFavorite",value:function(a){var b=void 0,c=void 0;a||(a=this.getTopicURL()),b=this._loadFavorites(),c=!1;for(var d in b){var e=b[d];if(e.topic===a){c=!0;break}}return c}},{key:"setfavoritesTitle",value:function(a){var b=this.getLinkTitle(a);rh.model.publish(f("FAVORITES_BUTTON_TITLE"),b)}},{key:"setTopicFavoriteState",value:function(){rh.model.publish(f("TOPIC_FAVORITE"),this.isTopicFavorite())}},{key:"setFavoritesList",value:function(){var a=[],b=void 0,c=this._loadFavorites();for(b in c)a.push(c[b]);rh.model.publish(f("KEY_FAVORITES"),a)}},{key:"toggleFavorite",value:function(a){a||(a=this.getTopicURL()),this.isTopicFavorite(a)?this._unFavoriteTopic(a):this._favoriteTopic(a,this.getTopicTitle()),this.setTopicFavoriteState()}},{key:"init",value:function(){this.favStorage.init(rh._.getRootUrl()),rh.model.subscribe(rh.consts("KEY_TOPIC_URL"),this.setTopicFavoriteState.bind(this)),rh.model.subscribe(rh.consts("EVENTFAVCHANGE"),this.setFavoritesList.bind(this)),rh.model.subscribe(rh.consts("TOPIC_FAVORITE"),this.setfavoritesTitle.bind(this)),this.setFavoritesList(),rh.model.publish(f("TOPIC_FAVORITE"),this.isTopicFavorite())}}]),a}();rh.controller("FavoritesController",g)},{"../../lib/rh":25}],31:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=rh._,g=function(){function a(b){d(this,a),this.widget=b}return e(a,[{key:"goToHome",value:function(a){if(rh.consts("HOME_FILEPATH")===rh._.getFileName())return this.changeToDefaultTopic(a);var b=void 0;return void 0!==a&&""!==a&&(b={rhtocid:a}),f.goToHome(b),!0}},{key:"changeToDefaultTopic",value:function(a){var b={t:window.gDefaultTopic.substring(1)};return void 0!==a&&""!==a&&(b.rhtocid=a),f.queueUpdateHashMap(b,!0),!0}}]),a}();rh.controller("HomeController",g)},{"../../lib/rh":25}],32:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=a("../utils/node_utils"),g=rh.$,h=rh._,i=function(){function a(){d(this,a)}return e(a,[{key:"createChildWidget",value:function(){this.node=g.createElement("div",this.template),f.appendChild(document.body,this.node),this.widget=new rh.Widget({node:this.node}),this.widget.init()}},{key:"setOnImageLoad",value:function(){var a=g.find(this.node,".rh-modal-content")[0];if(a){this.modalContent=a;var b=g.find(a,"img")[0];b&&(this.img=b,b.addEventListener("load",this.setModalSize.bind(this)),b.addEventListener("error",this.setModalSize.bind(this)))}}},{key:"setModalSize",value:function(){this.imageWidth=this.img.naturalWidth,this.imageHeight=this.img.naturalHeight;var a=this.calculatePosition(this.imageWidth,this.imageHeight),b=g.find(this.node,".rh-modal-container")[0];b&&this.setContainerStyle(b,a)}},{key:"setContainerStyle",value:function(a,b){var c=Math.round(b.top),d=Math.round(b.left);g.css(a,"left",d.toString()+"px"),g.css(a,"top",c.toString()+"px"),this.modalContent&&this.setImageSize(b.width,b.height),g.css(a,"display","block")}},{key:"calculateImageSize",value:function(a){var b=a.imageWidth/a.imageHeight;return a.imageWidth<a.pageWidth&&a.imageHeight<a.pageHeight?{width:a.imageWidth,height:a.imageHeight}:a.imageWidth>=a.pageWidth&&a.imageHeight<=a.pageHeight?{height:a.pageWidth/b,width:a.pageWidth}:a.imageWidth<=a.pageWidth&&a.imageHeight>=a.pageHeight?{height:a.pageHeight,width:a.pageHeight*b}:a.imageWidth>=a.pageWidth&&a.imageHeight>=a.pageHeight?this._calculateFullyExceedSize(a,b):void 0}},{key:"_calculateFullyExceedSize",value:function(a,b){var c=a.pageWidth/a.pageHeight;return b<c?{height:a.pageHeight,width:a.pageHeight*b}:{height:a.pageWidth/b,width:a.pageWidth}}},{key:"calculatePosition",value:function(a,b){var c=window.innerWidth||document.body.clientWidth,d=window.innerHeight||document.body.clientHeight;c-=70,d-=70,c=c>=0?c:0,d=d>=0?d:0;var e={imageWidth:a,imageHeight:b,pageWidth:c,pageHeight:d},f=this.calculateImageSize(e);a=f.width,b=f.height;var g=Math.max(5,(c-a)/2),h=Math.max(5,(d-b)/2);return{left:g,top:h,width:a,height:b,pageWidth:c,pageHeight:d}}},{key:"initialStyle",value:function(){return this.isImage?'style="display:none"':""}},{key:"ShowModal",value:function(a){this.isImage=a.isImage,this.createChildWidget(),this.widget.subscribe("close",this._close.bind(this)),this.widget.publish("content",a.content),h.defer(this.setOnImageLoad.bind(this))}},{key:"setImageSize",value:function(a,b){this.imageWidth>a&&g.css(this.img,"width",Math.round(a)+"px"),this.imageHeight>b&&g.css(this.img,"height",Math.round(b)+"px")}},{key:"_close",value:function(){this.widget.destruct(),this.widget=void 0,f.removeChild(this.node),this.node=void 0}},{key:"template",get:function(){var a=this.initialStyle();return'\n    <div class="rh-modal">\n        <div class="rh-modal-container" '+a+'>\n          <div class="rh-modal-content" data-html="content"></div>\n          <div class="rh-modal-close" data-click="@close(true)"> </div>\n        </div>\n    </div>'}}]),a}();h.isIframe()||rh.model.csubscribe("SHOW_MODAL",function(a){var b=new i;b.ShowModal(a)}),rh.model.csubscribe("SHOW_MODAL_IN_TOPIC",function(a){var b=new i;b.ShowModal(a)})},{"../../lib/rh":25,"../utils/node_utils":68}],33:[function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),g=rh.$,h=rh._,i=rh.consts,j=function(){function a(b){e(this,a),this.widget=b,this.topicFrame=".topic-container iframe",this.initLayout(),this.initModal()}return f(a,[{key:"isLayoutMode",value:function(a){var b=a||h.hashParams(),c=b[rh.consts("HASH_KEY_TOPIC")];return b[rh.consts("HASH_KEY_UIMODE")]!==i("HELP_SEARCH_MODE")&&(!c||"true"===b[rh.consts("HASH_HOMEPAGE_MODE")]||b[rh.consts("HASH_KEY_RH_TOCID")])}},{key:"initLayout",value:function(){var a=this;rh.model.subscribe(i("EVT_HASH_CHANGE"),function(b){var c=b.newMap,e=b.oldMap;a.isLayoutMode()?a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_LAYOUT_MODE")):"search"===c[rh.consts("HASH_KEY_UIMODE")]?(a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_SEARCH_MODE")),h.queueUpdateHashMap(d({},i("HASH_HOMEPAGE_MODE"),!1),!1)):a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_TOPIC_MODE"));var f=rh.model.get(rh.consts("KEY_FEATURE"));f&&f.showDefTopic===!1&&!c[rh.consts("HASH_KEY_RH_TOCID")]&&!e[rh.consts("HASH_KEY_TOPIC")]&&c[rh.consts("HASH_KEY_TOPIC")]?h.queueUpdateHashMap(d({},i("HASH_HOMEPAGE_MODE"),"false"),!1):e[rh.consts("HASH_KEY_TOPIC")]&&!c[rh.consts("HASH_KEY_RH_TOCID")]&&e[rh.consts("HASH_KEY_TOPIC")]!==c[rh.consts("HASH_KEY_TOPIC")]&&"true"===c[rh.consts("HASH_HOMEPAGE_MODE")]&&e[rh.consts("HASH_HOMEPAGE_MODE")]===c[rh.consts("HASH_HOMEPAGE_MODE")]&&h.queueUpdateHashMap(d({},i("HASH_HOMEPAGE_MODE"),"false"),!1)});var b=h.hashParams();this.isLayoutMode()&&"true"!==b[rh.consts("HASH_HOMEPAGE_MODE")]&&h.queueUpdateHashMap(d({},i("HASH_HOMEPAGE_MODE"),!0),!1),rh.model.subscribe("EVT_TOC_LOADEDgototab",function(b){b.key&&rh.model.subscribe(b.key,function(a,c,d){d(),b.item&&b.item.url&&!a[0].added&&(a.unshift({type:"item",url:b.item.url,name:b.item.name,added:!0}),rh.model.publish(b.key,a))}),b.item.url&&a.viewTopicInLayoutMode(b.item.url)})}},{key:"viewTopicInLayoutMode",value:function(a){var b=d({homepage:"true"},rh.consts("HASH_KEY_RH_TOCID"),!0);a&&"#"!==a&&(b.t=a),h.queueUpdateHashMap(b,!1)}},{key:"initModal",value:function(){var a=!1;document.addEventListener("keydown",function(a){27===a.keyCode&&rh._.each(g.find(".modal"),function(a){g.addClass(a,"rh-hide")})},!1),document.addEventListener("click",function(){a||rh._.each(g.find(".modal"),function(a){g.addClass(a,"rh-hide")}),a=!1}),rh._.each(g.find(".modal-content"),function(b){h.addEventListener(b,"click",function(){a=!0})})}}]),a}();rh.controller("RH2017LayoutController",j)},{"../../lib/rh":25}],34:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=function(){function a(b,c){d(this,a),this._items=b,this._max_items=c||rh.model.get(rh.consts("MAX_SEARCH_RESULTS"))||20}return e(a,[{key:"append",value:function(a){this._items=this._items.concat(a)}},{key:"merge",value:function(a){var b=this;f.each(a,function(a){b.mergeItem(a)})}},{key:"clear",value:function(){this._items=[]}},{key:"_purge",value:function(){this._items.length>this._max_items&&this._items.splice(this._max_items)}},{key:"purge",value:function(){return this._purge()}},{key:"mergeItem",value:function(a){var b=this.find_item(a);b?b.merge(a):this._items.push(a)}},{key:"find_item",value:function(a){return f.find(this._items,function(b){return b.match(a)})}},{key:"merge_item",value:function(a,b){a.probability+=b.probability,a.count=Math.max(a.count,b.count)}},{key:"_sort",value:function(){this.items.sort(this.compare_items)}},{key:"sort",value:function(){this._sort()}},{key:"compare_items",value:function(a,b){return a.compare(b)}},{key:"items",get:function(){return this._items}}]),a}();b.exports=g},{"../../../../lib/rh":25}],35:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh.consts,g=function(){function a(b){d(this,a),this._path=b||"",this.initPath()}return e(a,[{key:"getPath",value:function(){return this._path}},{key:"initPath",value:function(){"."===this._path&&(this._path=""),"."===this._path[0]&&"/"===this._path[1]&&(this._path=this._path.slice(2))}},{key:"_getModelFileName",value:function(a){var b=f("SEARCH_MODEL_ADDR");return rh.model.get(rh.consts("KEY_CLASSIC_OUTPUT"))&&(b=f("SEARCH_MODEL_ADDR_OLD")),b+a.toString()+".js"}},{key:"getModelFilePath",value:function(a){var b=this._getModelFileName(a);return this._getRelativePath(b)}},{key:"_getRelativePath",value:function(a){var b=""===this._path?a:this._path+"/"+a;return b}},{key:"_getPathKey",value:function(){return""===this._path?"":"_"+this._path+"_"}},{key:"getModelKey",value:function(a){return f("SEARCH_MODEL_KEY")+this._getPathKey()+a.toString()}},{key:"_getMapFileName",value:function(){return f(rh.model.get(rh.consts("KEY_CLASSIC_OUTPUT"))?"SEARCH_MAP_ADDR_OLD":"SEARCH_MAP_ADDR")}},{key:"getMapFilePath",value:function(){var a=this._getMapFileName();return this._getRelativePath(a)}},{key:"getIndexFilePath",value:function(){var a=f("SEARCH_INDEX_FILE");return rh.model.get(rh.consts("KEY_CLASSIC_OUTPUT"))&&(a=f("SEARCH_INDEX_FILE_OLD")),this._getRelativePath(a)}},{key:"getTopicUrl",value:function(a){return this._getRelativePath(a)}},{key:"getSearchDbFilePath",value:function(){var a=f("SEARCH_DB_FILE");return this._getRelativePath(a)}},{key:"getMetadataFilePath",value:function(){var a=f("SEARCH_METADATA_FILE");return this._getRelativePath(a)}},{key:"getTextFilePath",value:function(a){var b=f("SEARCH_TEXT_FILE"),c=this._getRelativePath(b);return c+"/"+a+".js"}}]),a}();b.exports=g},{"../../../../lib/rh":25}],36:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._;b.exports=function(){function a(b){d(this,a),this.synonymns=b||[],this.rootWords={},this.merge()}return e(a,[{key:"merge",value:function(){var a=this;this.rootWords={},f.each(this.synonymns,function(b){var c=b.words,d=b.name;f.each(c,function(b){a._add(d,b)})})}},{key:"_add",value:function(a,b){b=b.toLowerCase(),a=a.toLowerCase();var c=this.rootWords[b]||[];this.rootWords[b]=c.concat(this.rootWords[a]||[],a)}},{key:"getRoot",value:function(a){return this.rootWords[a]||a}}]),a}()},{"../../../../lib/rh":25}],37:[function(a,b,c){"use strict";var d={minPreviousThreshold:.2,previousnGram:1,max_predictions:5,PREDICTOR_SOURCE_ID:{HISTORY_PREDICTOR:0,NGRAM_PREDICTOR:1,GENERAL_PREDICTOR:2,CORRECTOR:3}};b.exports=d},{}],38:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./indices"),rh=a("../../../../lib/rh"),g=rh._,h=a("./prediction"),i=a("./consts"),j=a("./utils"),k=a("./prediction_list"),l=function(){function a(b,c){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;d(this,a),this._loader=b,this.predictions=[],this.max_predictions=e,this._callback=c}return e(a,[{key:"getCorrections",value:function(a){this._parsed_input=a,this.predictions=[],this._computePredictions();var b=this._loader.getHashes(this._parsed_input._partial);if(b)for(var c=b.length,d=0;d<c&&this.predictions.length<this.max_predictions;d++){var e=b[d];this._addCorrection(e)}this.onResultCalculated()}},{key:"clear",value:function(){this.predictions=[]}},{key:"_computePredictions",value:function(){var a=this._loader.getHashes(this._parsed_input._partial);a&&this._addCorrection(a)}},{key:"onResultCalculated",value:function(){this._callback&&this._callback(new k(this.predictions,this._parsed_input),this._loader)}},{key:"_matchCorrection",value:function(a){return this._hamming_dist=this._getDistance(a),this._hamming_dist<=2&&!this._loader.isStopWord(a)}},{key:"_addCorrection",value:function(a){if(a){var b=j.getSafeElement(a,f.MAP.WORD);if(b&&this._matchCorrection(b)){var c=this._parsed_input.replaceLastWord(b),d=this._parsed_input.completeSuggestion(c),e=new h(d,1/this._hamming_dist,2,i.PREDICTOR_SOURCE_ID.CORRECTOR);this.predictions.push(e)}}}},{key:"_getDistance",value:function(a){return g.findEditDist(this._parsed_input._partial,a)}}]),a}();b.exports=l},{"../../../../lib/rh":25,"./consts":37,"./indices":42,"./prediction":46,"./prediction_list":48,"./utils":53}],39:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./prediction_list"),g=a("./prediction_creator"),h=a("./consts"),i=a("./indices"),rh=a("../../../../lib/rh"),j=rh._,k=a("../common/merger"),l=function(){function a(b,c){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;d(this,a),this._max_predictions=e,this._loader=c,this.total_count=this._loader.getTotalCount(),this._callback=b,this._source=h.PREDICTOR_SOURCE_ID.GENERAL_PREDICTOR,this.prediction_merger=new k([],5*this.total_count)}return e(a,[{key:"clear",value:function(){this.prediction_merger.clear(),this.parsed_input=void 0}},{key:"getPredictions",value:function(a){this._init(a),this._computePredictions(),this._onResultComputed()}},{key:"_computePredictions",value:function(){var a=this._getWordHashes();a&&this._addPredictions(a)}},{key:"_isWholeWordInput",value:function(){return this.parsed_input.isWholeWord}},{key:"_getWordHashes",value:function(){return this.parsed_input.isWholeWord?this._loader.top_words:this._loader.getHashes(this.parsed_input._partial)}},{key:"_init",value:function(a){this.prediction_merger=new k([],5*this.total_count),this.parsed_input=a}},{key:"_onResultComputed",value:function(){this._callback&&this._callback(new f(this.predictions,this.parsed_input),this._loader)}},{key:"_addPredictions",value:function(a){if(a)for(var b=a.length,c=0;c<b&&this.predictions.length<this.max_predictions;c++){var d=a[c];this._addWordPrediction(d)}}},{key:"_addWordPrediction",value:function(a,b){b=b||this._matches_partially.bind(this);var c=this._loader.getModelData(a),d=this._loader.total_count;if(b(a)){var e=a[i.MAP.WORD];this._should_add_prediction(e)&&this._create_predictions(a,d,c)}}},{key:"_continueFn",value:function(){return!0}},{key:"_should_add_prediction",value:function(a){return!this._loader.isStopWord(a)&&!this.parsed_input.equalLastWord(a)}},{key:"_matches_partially",value:function(a){if(this.parsed_input.isWholeWord)return!0;var b=a[i.MAP.WORD];return this.parsed_input.comparePartial(b)}},{key:"_create_predictions",value:function(a,b,c){var d=this,e=new g({loader:this._loader,model_item:c,total_count:b,parsed_input:this.parsed_input,continueFn:this._continueFn}),f=e.getMultiPredictions(a,!0,void 0,this._source);j.each(f,function(a){void 0!==a&&d.prediction_merger.mergeItem(a)})}},{key:"_calculate_probability",value:function(a){return a/this.total_count}},{key:"predictions",get:function(){return this.prediction_merger.items}},{key:"max_predictions",set:function(a){this._max_predictions=a},get:function(){return this._max_predictions}}]),a}();b.exports=l},{"../../../../lib/rh":25,"../common/merger":34,"./consts":37,"./indices":42,"./prediction_creator":47,"./prediction_list":48}],40:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=a("./prediction"),h=a("./input_parser"),i=a("./prediction_list"),j=a("./consts"),k=function(){function a(b,c){d(this,a),this._reader=b,this._predictions=[],this._callback=c,this._source=j.PREDICTOR_SOURCE_ID.HISTORY_PREDICTOR,this._max_predictions=void 0===j._max_history_predictions?2:j._max_history_predictions}return e(a,[{key:"getPredictions",value:function(a){return this._predictions=[],this._parsed_input=a,this._computePredictions(),this._callback&&this._callback(new i(this._predictions,this._parsed_input)),this._predictions}},{key:"init",value:function(){}},{key:"clear",value:function(){this._predictions=[]}},{key:"_computePredictions",value:function(){var a=this;""!==this._parsed_input.trimmedText&&(f.each(this._reader._list,function(b){a._match(b.text)&&a._predictions.push(a._createPrediction(b))}),this._purge())}},{key:"_purge",value:function(){this._predictions.splice(this._max_predictions)}},{key:"_createPrediction",value:function(a){var b=new g(a.text,1,a.count,this._source);return b}},{key:"_match",value:function(a){if(this._parsed_input.original_text.length>a.length)return!1;var b=new h(a,(!0));return this._parsed_input.compare(b)}}]),a}();b.exports=k},{"../../../../lib/rh":25,"./consts":37,"./input_parser":43,"./prediction":46,"./prediction_list":48}],41:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=a("./utils"),h=function(){function a(){d(this,a)}return e(a,[{key:"initHistory",value:function(a){void 0===this._list&&(this._list=a||[])}},{key:"getHistory",value:function(){return this._list||[]}},{key:"_updateText",value:function(a,b){this.getHistory().splice(b,1),this.getHistory().unshift(a)}},{key:"_addNewText",value:function(a){this.getHistory().push(a)}},{key:"add",value:function(a){var b=f.findIndex(this.getHistory(),function(b){return 0===g.compareNoCase(a.text,b.text)});b>=0?this._updateText(a,b):this._addNewText(a)}},{key:"delete",value:function(a){var b=f.findIndex(this.getHistory(),function(b){return 0===g.compareNoCase(a,b.text)});b>=0&&this.getHistory().splice(b)}}]),a}();b.exports=new h},{"../../../../lib/rh":25,"./utils":53}],42:[function(a,b,c){"use strict";var d={MAP:{WORD:0,HASH:1,COUNT:2,MODEL_FILE_NO:3,MODEL_INDEX:4,TOPICS:5},MODEL:{WORD_HASH:0,COUNT:1,NEXT_MODEL:2},FIRST_PREDICTION:{NEXT:0,PREVIOUS:1}};b.exports=d},{}],43:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./utils"),rh=a("../../../../../src/lib/rh"),g=rh._,h=function(){
function a(b,c,e,f){d(this,a),this.isPrevious=f,this.selection=void 0===e?b.length:e;var g=this._calculateSeparator(b);this.isPrevious||(this.isWholeWord=c||this._isWholeWord(b,g)),this.initText(b,g)}return e(a,[{key:"initText",value:function(a,b){this._computeText(a,b),this.trimmedText=this.original_text.trim(),this.words=g.compact(this.trimmedText.split(" ")||[]),this._reverseIfPrevious(),!this.isWholeWord&&this.words.length>0&&(this._partial=this.words.splice(-1)[0])}},{key:"_computeText",value:function(a,b){this._right_text="",this._left_text="",void 0===b&&(b=a.length),this.isSplitText=!(0===b||b===a.length);var c=a.substring(0,b),d=a.substring(b);this.isPrevious?(this.original_text=d,this._left_text=c.trim()):(this.original_text=c,this._right_text=d.trim())}},{key:"equalRemaingWord",value:function(a){if(""!==this._left_text||""!==this._right_text){var b=this._getRemainigWord();if(b)return 0===f.compareNoCase(b,a)}return!1}},{key:"_getRemainigWord",value:function(){var a=this.isPrevious?this._left_text.split(" "):this._right_text.split(" ");if(a=a||[],a=g.compact(a),a.length>0)return this.isPrevious?a[a.length-1]:a[0]}},{key:"completeSuggestion",value:function(a){return this.isPrevious?0===this._left_text.length?a:this._left_text+" "+a:0===this._right_text.length?a:a+" "+this._right_text}},{key:"_calculateSeparator",value:function(a){if(this.isPrevious){if(0===this.selection)return this.isWholeWord=!0,0;if(a.length>this.selection&&" "!==a[this.selection-1]){var b=a.lastIndexOf(" ",this.selection-1);return this.isWholeWord=!1,b>=0?b+1:0}this.isWholeWord=!0}return this.selection}},{key:"_reverseIfPrevious",value:function(){this.isPrevious&&this.words.reverse()}},{key:"_isWholeWord",value:function(a,b){return this.isPrevious?0===b||a.length>b&&" "===a[b-1]:b>0&&" "===a[b-1]}},{key:"compare",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(c=void 0===c?this.words.length-1:c,this.words.length>a.words.length)return!1;for(var d=b;d<=c;d++){var e=this.words[d],g=a.words[d];if(0!==f.compareNoCase(e,g))return!1}return this.matchPartial(a,d)}},{key:"matchPartial",value:function(a,b){if(void 0===this._partial)return!0;if(a.words.length<=b)return!1;var c=a.words[b];return this.comparePartial(c)}},{key:"comparePartial",value:function(a){return this._matchExp=new RegExp("^"+this._partial,"i"),this._matchExp.test(a)}},{key:"completeWord",value:function(a){return this.isWholeWord||void 0===this._partial||0===this._partial.length?this.getTermForCompleteWord(a,this.trimmedText):this.getTermForPartialText(a)}},{key:"getTermForPartialText",value:function(a){var b=a.substring(this._partial.length,a.length);if(this.isPrevious){var c="",d=this.trimmedText.indexOf(" ");return d>=0&&(c=this.trimmedText.substring(d)),this._partial+b+c}return this.trimmedText+b}},{key:"getTermForCompleteWord",value:function(a){return this.isPrevious?a+" "+this.trimmedText:this.trimmedText+" "+a}},{key:"replaceLastWord",value:function(a){var b=this.trimmedText;if(void 0!==this._partial&&!this.isWholeWord){var c=this.trimmedText.length-this._partial.length;b=this.trimmedText.substring(0,c),b=b.trim()}return b+" "+a}},{key:"equalLastWord",value:function(a){if(0===this.words.length)return!1;var b=this.words[this.words.length-1];return 0===f.compareNoCase(b,a)}}]),a}();b.exports=h},{"../../../../../src/lib/rh":25,"./utils":53}],44:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=rh.model,h=a("./utils"),i=a("./indices"),j=a("./consts"),k=a("../common/paths"),l=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";d(this,a),this._paths=new k(b)}return e(a,[{key:"init",value:function(a){this.loadIndex(a),this.loadMap(a)}},{key:"_isIndexLoaded",value:function(){return void 0!==this.index_data}},{key:"getModelCount",value:function(){return this.index_data.Model.length}},{key:"getMapHash",value:function(a){return this._hash_to_word[a]}},{key:"getHashes",value:function(a){if(void 0!==a&&a.length>0)return this.getAplhabetHashes(a[0])}},{key:"getAplhabetHashes",value:function(a){if(this.map_data&&1===a.length){var b=a.toLowerCase();return this.map_data[b]}}},{key:"getWordModel",value:function(a,b){var c=void 0,d=this._getHashForWord(a);return d&&b&&(c=b[d[i.MAP.MODEL_INDEX]]),c}},{key:"getCount",value:function(a){var b=this._getHashForWord(a);if(b)return b[i.MAP.COUNT]}},{key:"getModelData",value:function(a){var b=a[i.MAP.MODEL_FILE_NO],c=a[i.MAP.MODEL_INDEX],d=g.get(this._paths.getModelKey(b));return d||this.loadModel(b),d&&d[c]}},{key:"_compareWordCount",value:function(a,b){var c=h.getSafeElement(a,i.MAP.COUNT),d=h.getSafeElement(b,i.MAP.COUNT);return c&&d?d-c:0}},{key:"_buildTopWords",value:function(a){a.sort(this._compareWordCount),a.splice(100*j.max_predictions),this._top_words=a}},{key:"getModelFileNo",value:function(a){var b=this._getHashForWord(a);if(b)return b[i.MAP.MODEL_FILE_NO]}},{key:"_getHashForWord",value:function(a){var b=void 0,c=this.getHashKey(a);return c&&(b=this._hash_to_word[c]),b}},{key:"getHashKey",value:function(a){if(a&&a.length>0){var b=a.toLowerCase();return this._word_hash[b]}}},{key:"loadIndex",value:function(a){var b=this;this._isIndexLoaded()===!1?f.loadScript(this._paths.getIndexFilePath(),!0,function(){b.index_data=f.exports(),b.onIndexLoaded(a)},!0):this.onIndexLoaded(a)}},{key:"loadModel",value:function(a,b){var c=[];if(void 0!==a){var d=this._paths.getModelKey(a),e=g.get(d);if(void 0===e){g.publish(d,null);var h=this._paths.getModelFilePath(a);f.loadScript(h,!0,this.getOnModelLoadFn(a,b),!0)}else null===e&&void 0!==b?g.subscribe(d,b):this.doCallback(b,e,a)}else this.doCallback(b,c,a)}},{key:"doCallback",value:function(a,b,c){a&&a(b,c)}},{key:"getOnModelLoadFn",value:function(a,b){var c=this;return function(){var d=f.exports();g.publish(c._paths.getModelKey(a),d),b&&b(d,a)}}},{key:"onMapLoaded",value:function(a){this.parseMap(),this.index_data&&a&&a(this)}},{key:"onIndexLoaded",value:function(a){this.map_data&&a&&a(this)}},{key:"parseMap",value:function(){var a=this.map_data;this._word_hash={},this._hash_to_word={};var b=[];for(var c in a){var d=a[c];this._parseWordsData(d),b=b.concat(d)}this._buildTopWords(b)}},{key:"_parseWordsData",value:function(a){var b=this;f.each(a,function(a){var c=parseInt(a[i.MAP.HASH]);if(a[i.MAP.WORD]){var d=a[i.MAP.WORD].toString();b._word_hash[d]=c}b._hash_to_word[c]=a})}},{key:"isStopWord",value:function(a){var b=f.find(this.index_data.stopWords,function(b){return 0===h.compareNoCase(a,b)});return void 0!==b}},{key:"getTotalCount",value:function(){return this.index_data.totalCount}},{key:"wordHashfromIndexKey",value:function(a,b){return f.find(this._hash_to_word,function(c){return c[i.MAP.MODEL_INDEX]===a&&c[i.MAP.MODEL_FILE_NO]===b})}},{key:"loadMap",value:function(a){var b=this;void 0===this.map_data?f.loadScript(this._paths.getMapFilePath(),!0,function(){b.map_data=f.exports(),b.onMapLoaded(a)},!0):this.onMapLoaded(a)}},{key:"top_words",get:function(){return this._top_words}},{key:"nGram",get:function(){return this.index_data.nGram}},{key:"search_model",get:function(){return this.index_data.Model}},{key:"search_map",get:function(){return this.index_data.Map}},{key:"total_count",get:function(){return this.index_data.totalCount}},{key:"stop_words",get:function(){return this.index_data.stopWords}}]),a}();b.exports=l},{"../../../../lib/rh":25,"../common/paths":35,"./consts":37,"./indices":42,"./utils":53}],45:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=a("./prediction_creator"),h=a("./prediction_list"),i=a("./consts"),j=a("./indices"),k=function(){function a(b){var c=b.loader,e=b.level,f=b.callback,g=b.previous,h=b.max_predictions,j=void 0===h?20:h;d(this,a),this.level=e,this.previous=g,this._max_predictions=j,this.predictions=[],this._callback=f,this._loader=c,this._source=i.PREDICTOR_SOURCE_ID.NGRAM_PREDICTOR}return e(a,[{key:"init",value:function(){}},{key:"clear",value:function(){this._word_model=void 0,this._prediction_array=void 0,this.parsed_input=void 0,this.predictions=[]}},{key:"getPredictions",value:function(a){this.parsed_input=a,this.predictions=[],void 0!==a&&a.words.length>=this.level?(this.word_index=a.words.length-this.level,this._word=a.words[this.word_index],this._loadInputModel(this._word,this._compute_word_predictions.bind(this))):this._onResultsComputed()}},{key:"_compute_word_predictions",value:function(a){this.predictions=[];var b=this.level,c=this._word,d=this._loader.getCount(c);this._word_model=this._loader.getWordModel(c,a),this._word_model&&(this._prediction_array=this._get_prediction_array(),this._compute_prediction_from_model(c,b,d)),this._onResultsComputed()}},{key:"_onResultsComputed",value:function(){this._callback&&this._callback(new h(this.predictions,this.parsed_input),this._loader)}},{key:"_compute_prediction_from_model",value:function(a,b,c){if(void 0!==this._prediction_array)if(this._is_my_level(b))this._compute_next_words(c);else{b--;var d=this._get_word_index(b),e=this.parsed_input.words[d],f=this._loader.getHashKey(e),g=this._get_next_model(this._prediction_array,f);g&&(c=g[j.MODEL.COUNT],this._prediction_array=g[j.MODEL.NEXT_MODEL],this._compute_prediction_from_model(e,b,c))}}},{key:"_get_next_model",value:function(a,b){if(b){var c=f.find(a,function(a){return a.length>1&&a[j.MODEL.WORD_HASH]===b});return c&&c.length>j.MODEL.NEXT_MODEL&&Array.isArray(c)?c:void 0}}},{key:"_get_word_index",value:function(a){return this.parsed_input.words.length-a}},{key:"_is_my_level",value:function(a){return 1===a}},{key:"_continueFn",value:function(){return!0}},{key:"_compute_next_words",value:function(a){var b=this._prediction_array;if(b&&b.length>0)for(var c=0;this.predictions.length<this.max_predictions&&c<b.length&&b[c].length>1;c++)if(this._matches_partially(b[c])){var d=this._create_predictions(b[c],a);this._compute_next_multi_words(d)}}},{key:"_compute_next_multi_words",value:function(a){var b=this;f.each(a,function(a){void 0!==a&&b.predictions.push(a)})}},{key:"_get_word_hash",value:function(a){return this._loader.getMapHash(a[j.MODEL.WORD_HASH])}},{key:"_matches_partially",value:function(a){if(this.parsed_input.isWholeWord)return!0;var b=this._loader.getMapHash(a[j.MODEL.WORD_HASH]);if(!b)return!1;var c=b[j.MAP.WORD];return this.parsed_input.comparePartial(c)}},{key:"_create_predictions",value:function(a,b){var c=new g({loader:this._loader,model_item:a,total_count:b,parsed_input:this.parsed_input,continueFn:this._continueFn});return c.getMultiPredictions(void 0,void 0,void 0,this._source)}},{key:"_get_prediction_array",value:function(){return this.parsed_input.isPrevious&&this._word_model.length>1?this._word_model[1]:this._word_model[0]}},{key:"_loadInputModel",value:function(a,b){var c=this._findFileIndex(a);this._loader.loadModel(c,b)}},{key:"_findFileIndex",value:function(a){return this._loader.getModelFileNo(a)}},{key:"max_predictions",set:function(a){this.max_predictions=a},get:function(){return this._max_predictions}}]),a}();b.exports=k},{"../../../../lib/rh":25,"./consts":37,"./indices":42,"./prediction_creator":47,"./prediction_list":48}],46:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./utils"),h=d(g),i=function(){function a(b,c,d,f){e(this,a),this.probability=c,this.term=b,this.count=d,this.source=f}return f(a,[{key:"merge",value:function(a){this.probability+=a.probability,this.count=Math.max(this.count,a.count)}},{key:"compare",value:function(a){return a.probability!==this.probability?a.probability-this.probability:this.term<a.term?-1:this.term>a.term?1:0}},{key:"match",value:function(a){return 0===h["default"].compareNoCase(a.term,this.term)}}]),a}();b.exports=i},{"./utils":53}],47:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./prediction"),g=a("./utils"),h=a("./indices"),i=a("./input_parser"),j=a("./consts"),k=function(){function a(b){var c=b.loader,e=b.model_item,f=b.total_count,g=b.parsed_input,h=b.continueFn;d(this,a),this._model_item=e,this.parsed_input=g||new i(""),this._init(),this._total_count=f,this._continueFn=h||this._isStopWord,this._nextModelFn=this._nextModel,this._predictions=[],this._multi_prediction=!1,this._loader=c}return e(a,[{key:"_init",value:function(){this.term="",this.probability=1,this._first_word=!0,this.isFirstLevel=!1,this._level=0}},{key:"getPrediction",value:function(a,b,c,d){return this.word_hash=a,this.isFirstLevel=b,this.previous=c,this.source=d,this.isFirstLevel&&this._appendPreviousPredictions(this._model_item),this._appendPrediction(this._model_item,a),this._createPrediction()}},{key:"getMultiPredictions",value:function(a,b,c,d){return this._multi_prediction=!0,this.word_hash=a,this.isFirstLevel=b,this.previous=c,this.source=d,this.isFirstLevel&&this._appendPreviousPredictions(this._model_item),this._appendPrediction(this._model_item,a),this._predictions}},{key:"equalRemaingWord",value:function(a){var b=this._getword(a,this.word_hash);return!(!b||!this.parsed_input.equalRemaingWord(b))}},{key:"_appendPreviousPredictions",value:function(a){var b=this._getPreviousItem(a);if(b){var c=this._getPreviousProbability(b);c>j.minPreviousThreshold&&this._appendPreviousTerm(b)}}},{key:"_getPreviousItem",value:function(a){var b=g.getFirstLevelNextModel(a,!0);if(b){var c=g.getSafeElement(b,0);return c}}},{key:"_appendPreviousTerm",value:function(a){var b=this._getword(a);if(b){if(this.parsed_input.equalLastWord(b))return;this.term=this.parsed_input.replaceLastWord(b),this._first_word=!1}}},{key:"_createPrediction",value:function(){if(""!==this.term){var a=this.parsed_input.completeSuggestion(this.term);return new f(a,this.probability,1,this.source)}}},{key:"_appendPrediction",value:function(a){if(this.probability=this.probability*this._calculateProbability(a),this._update_term(a),this._shouldCreatePrediction(a)&&this._predictions.push(this._createPrediction()),this._continueFn(a)){var b=this._nextModel(a);this._total_count=this._getCount(a),this._level++,this._first_word=!1,this.isFirstLevel=!1,this.word_hash=void 0,b&&this._appendPrediction(b)}}},{key:"_getPreviousProbability",value:function(a){var b=this._getCount(this.model_item),c=g.getCountfromModel(a);return c/b}},{key:"_update_term",value:function(a){this.parsed_input.isPrevious?this.term=this._nextTerm(a)+this.term:this.term=this.term+this._nextTerm(a)}},{key:"_getword",value:function(a,b){return b=b||this._get_word_hash(a),g.getSafeElement(b,h.MAP.WORD)}},{key:"_get_word_hash",value:function(a){return this._loader.getMapHash(a[h.MODEL.WORD_HASH])}},{key:"_nextModel",value:function(a){var b=void 0;if(b=this.isFirstLevel?g.getFirstLevelNextModel(a,this.previous):g.getNextModel(a),b&&b.length>0)return g.getFirstPrediction(b)}},{key:"_nextTerm",value:function(a){var b=this._getword(a,this.word_hash);return b?this._first_word?this.parsed_input.completeWord(b):" "+b:""}},{key:"_calculateProbability",value:function(a){var b=this._getCount(a);return b/this._total_count}},{key:"_getCount",value:function(a){return this.word_hash?g.getCountfromWordHash(this.word_hash):g.getCountfromModel(a)}},{key:"_shouldCreatePrediction",value:function(a){return this._multi_prediction&&!this._isStopWord(a)&&!this.equalRemaingWord(a)}},{key:"_isStopWord",value:function(a){var b=this._getword(a,this.word_hash);return!!b&&this._loader.isStopWord(b)}}]),a}();b.exports=k},{"./consts":37,"./indices":42,"./input_parser":43,"./prediction":46,"./utils":53}],48:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){d(this,a),this.parsed_input=c,this._list=b||[]}return e(a,[{key:"isForInput",value:function(a,b){return this.parsed_input.isPrevious?void 0!==b&&this.parsed_input.original_text===b.original_text:this.parsed_input.original_text===a.original_text}},{key:"isEmpty",value:function(){return 0===this._list.length}},{key:"predictions",get:function(){return this._list}}]),a}();b.exports=f},{}],49:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./loader"),rh=a("../../../../lib/rh"),g=rh._,h=a("./history_predictor"),i=a("./ngram_predictor"),j=a("./general_predictor"),k=a("./corrector"),l=a("./consts"),m=function(){function a(b,c){d(this,a),this._history_reader=b,this._processResultFn=c}return e(a,[{key:"_createLoaders",value:function(){return g.map(this.projectPaths,function(a){return new f(a)})}},{key:"createPredictors",value:function(a,b,c){var d=this;this._addFn=a,this._prevaddFn=b,this._addCorrectorFn=c;var e=new h(this._history_reader,this._processResultFn);this._addFn(e);var f=this._createLoaders();g.each(f,function(a){a.init(d.addPredictors.bind(d))})}},{key:"addPredictors",value:function(a){for(var b=1;b<=a.nGram;b++){var c=new i({loader:a,level:b,callback:this._processResultFn});c.init(),this._addFn(c)}for(var d=1;d<=l.previousnGram;d++){var e=new i({loader:a,level:d,callback:this._processResultFn,previous:!0});e.init(),this._prevaddFn(e)}var f=new j(this._processResultFn,a);this._addFn(f);var g=new k(a,this._processResultFn);this._addCorrectorFn(g)}},{key:"projectPaths",get:function(){return rh.model.get(rh.consts("KEY_PROJECT_LIST"))}}]),a}();b.exports=m},{"../../../../lib/rh":25,"./consts":37,"./corrector":38,"./general_predictor":39,"./history_predictor":40,"./loader":44,"./ngram_predictor":45}],50:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=rh.consts,h=a("./history_reader"),i=a("./input_parser"),j=a("../common/merger"),k=a("./topic_counter"),l=a("./utils"),m=a("./consts"),n=a("./../../../common/counting_seamaphore"),o=a("./predictors_creator"),p=a("../topic/handler"),q=5,r=function(){function a(b){var c=this;d(this,a),this.widget=b,this._predictors=[],this._correctors=[],this._previous_predictors=[],this.initHandleKeyHash(),this.max_predictions=q,this.predicton_merger=new j([],q),b.model.subscribe(g("KEY_PROJECT_LIST"),function(){c.init()})}return e(a,[{key:"init",value:function(){var a=rh.storage.fetch(g("PREV_SEARCH_KEY"));h.initHistory(a),this.create_predictors(),this.widget.model.csubscribe("EVT_CLOSE_SEARCH_SUGGESTION",this.closeSuggestions.bind(this)),rh.model.get(rh.consts("KEY_CLASSIC_OUTPUT"))||(this.search_handler=new p(this.widget),this.widget.model.csubscribe("EVT_QUERY_SEARCH_RESULTS",this.search.bind(this)),this.widget.model.csubscribe("DO_CLIENT_SEARCH",this.handleClientSearch.bind(this)))}},{key:"search",value:function(){if(!rh.rhs.doSearch()){var a=this.widget.get(g("KEY_SEARCH_TERM"));this.search_handler.showSearchResults(a)}}},{key:"handleClientSearch",value:function(a){this.search_handler.showSearchResults(a)}},{key:"create_predictors",value:function(){this._predictors=[];var a=new o(h,this.processResult.bind(this));a.createPredictors(this.addPredictor.bind(this),this.addPrevPredictor.bind(this),this.addCorrector.bind(this))}},{key:"addPredictor",value:function(a){this._predictors.push(a)}},{key:"addPrevPredictor",value:function(a){this._previous_predictors.push(a)}},{key:"addCorrector",value:function(a){this._correctors.push(a)}},{key:"showSuggestions",value:function(a){this._initSuggestions(a),this._calculateSugguestions()}},{key:"_initSuggestions",value:function(a){this._initResult(),this._initInputs(a),this._resutSeamaphore=new n(this.onResultComplete.bind(this))}},{key:"_initInputs",value:function(a){this.parsed_input=new i(a.text,(!1),a.selStart,(!1)),l.isPrevious(a)&&(this._previous_input=new i(a.text,(!1),a.selStart,(!0)))}},{key:"_calculateSugguestions",value:function(){var a=this;this._resutSeamaphore.wait(this._predictorCount()),f.each(this._predictors,function(b){b.getPredictions(a.parsed_input)}),this._previous_input&&f.each(this._previous_predictors,function(b){b.getPredictions(a._previous_input)})}},{key:"_clearPredictors",value:function(){f.each(this._predictors,function(a){a.clear()}),f.each(this._previous_predictors,function(a){a.clear()}),f.each(this._correctors,function(a){a.clear()})}},{key:"_predictorCount",value:function(){var a=this._predictors.length;return this._previous_input&&(a+=this._previous_predictors.length),a}},{key:"_initResult",value:function(){this.predicton_merger&&this.predicton_merger.clear(),this.widget.publish("selected",void 0),this._previous_input=void 0,this._computing_correction=!1}},{key:"_clearResult",value:function(){this._resetMovement(),this._previous_input=void 0,this.parsed_input=void 0,this._resutSeamaphore=void 0,this._clearPredictors()}},{key:"isSuggestionsOpen",value:function(){var a=this.widget.get(g("SEARCH_RESULTS_KEY"));return a&&a.length>0}},{key:"processResult",value:function(a,b){if(a.isForInput(this.parsed_input,this._previous_input)){if(!a.isEmpty()){var c=new k(b),d=c.computeCounts(a.predictions,this.parsed_input);this.predicton_merger.merge(d)}this._resutSeamaphore.signal()}}},{key:"onResultComplete",value:function(){this.needCorrection()?this.doCorrection():(this.predicton_merger.sort(),this.predicton_merger.purge(),this.widget.publish(g("SEARCH_RESULTS_KEY"),this.predictions),this._clearResult())}},{key:"needCorrection",value:function(){return!this._computing_correction&&0===this.predictions.length&&""!==this.parsed_input.trimmedText}},{key:"doCorrection",value:function(){var a=this;this._computing_correction=!0,this._resutSeamaphore=new n(this.onResultComplete.bind(this)),this._resutSeamaphore.wait(this._correctors.length),f.each(this._correctors,function(b){b.getCorrections(a.parsed_input)})}},{key:"canDelete",value:function(a){var b=this.predictions[a];return void 0!==b&&b.source===m.PREDICTOR_SOURCE_ID.HISTORY_PREDICTOR}},{key:"handleDelete",value:function(a){var b=this.predictions[a];this._deleteFromHistory(b.term),this._removePrediction(a),this.widget.publish("history_deleted",!0)}},{key:"_removePrediction",value:function(a){this.predictions.splice(a,1),this.widget.publish(g("SEARCH_RESULTS_KEY"),this.predictions)}},{key:"handleClick",value:function(a){var b=this.widget.get("history_deleted");if(!b){var c=this.predictions[a];if(void 0!==c){var d=c.term;this.triggerSearch(d)}}}},{key:"triggerSearch",value:function(a){this._addToHistory(a),this.closeSuggestions(),this.widget.publish(g("KEY_SEARCH_TERM"),a),this.widget.publish(rh.consts("EVT_SEARCH_TERM"),!0),this.widget.publish(rh.consts("EVT_SEARCH_IN_PROGRESS"),!0)}},{key:"handleFocusOut",value:function(a,b){var c=this.widget.get("history_deleted");c?(this.widget.publish("history_deleted",!1),this.widget.publish(b,!0)):this.widget.publish(a,!1)}},{key:"getFirstSuggestionIndex",value:function(a,b){return b?0:a-1}},{key:"getNextSuggestionIndex",value:function(a,b,c){var d=c?1:b-1;return a=void 0===a?0:a,a=(a+d)%b}},{key:"handleArrowKey",value:function(a){var b=this.widget.get("selected"),c=40===a.keyCode,d=this.getPredictionsLength();if(d>0){b=void 0===b?this.getFirstSuggestionIndex(d,c):this.getNextSuggestionIndex(b,d,c),this.widget.publish("selected",b);var e=this.getNewInputText(this.results[b]);this.widget.publish(g("KEY_SEARCH_TERM"),e)}}},{key:"getNewInputText",value:function(a){return a.term}},{key:"getPredictionsLength",value:function(){var a=void 0;return this.results=this.widget.get(g("SEARCH_RESULTS_KEY")),this.results&&(a=this.results.length),a}},{key:"closeSuggestions",value:function(){this._clearResult(),this.widget.publish("selected",void 0),this.original_parsed_input=void 0,this.widget.publish(g("SEARCH_RESULTS_KEY"),[])}},{key:"_deleteFromHistory",value:function(a){h["delete"](a),this._saveHistory()}},{key:"_addToHistory",value:function(a){a&&""!==a&&(h.add({text:a.trim(),count:10}),this._saveHistory())}},{key:"_saveHistory",value:function(){rh.storage.persist(g("PREV_SEARCH_KEY"),h.getHistory())}},{key:"handleDefault",value:function(a){if(""===a.text)this.closeSuggestions();else{var b=(a.text||"").substr(0,a.selStart);a.text=b,this.showSuggestions(a)}}},{key:"handleShowSuggestion",value:function(a){""===a.text||l.shouldShowSuggestion(a)===!1?this.closeSuggestions():this.showSuggestions(a)}},{key:"handleReturn",value:function(a){this.triggerSearch(a.text)}},{key:"_isMovementKey",value:function(a){return[38,39,40].indexOf(a)>=0}},{key:"_resetMovement",value:function(){this.original_parsed_input=void 0,this.widget.publish("selected",void 0)}},{key:"_isHandlingCursorMove",value:function(){var a=this.widget.get("selected");return void 0!==a}},{key:"initHandleKeyHash",value:function(){this.handle_key_hash={up:this.handleArrowKey.bind(this),down:this.handleArrowKey.bind(this),backspace:this.handleBackSpace.bind(this),"return":this.handleReturn.bind(this),"default":this.handleDefault.bind(this),escape:this.handleEscape.bind(this),right:this.handleRight.bind(this)}}},{key:"handleRight",value:function(a){return this._isHandlingCursorMove()?(l.shouldAppendSpace(a)&&(a.text+=" ",a.selStart+=1,this.widget.publish(g("KEY_SEARCH_TERM"),a.text)),this._resetMovement(),this.handleShowSuggestion(a),!1):(this._resetMovement(),this.handleShowSuggestion(a))}},{key:"handleBackSpace",value:function(a){return this.handleShowSuggestion(a)}},{key:"handleEscape",value:function(){this.closeSuggestions()}},{key:"handleKey",value:function(a){var b=a.keyCode,c={keyCode:b,selStart:a.target.selectionStart,text:a.target.value};this._isMovementKey(b)||this._resetMovement();var d=f.getKeyIndex(b);if(void 0===d)return!0;var e=this.handle_key_hash[d];return e?e(c):void 0}},{key:"predictions",get:function(){return this.predicton_merger.items},set:function(a){this.predicton_merger=new j(a)}}]),a}();rh.controller("SearchController",r)},{"../../../../lib/rh":25,"../common/merger":34,"../topic/handler":54,"./../../../common/counting_seamaphore":26,"./consts":37,"./history_reader":41,"./input_parser":43,"./predictors_creator":49,"./topic_counter":52,"./utils":53}],51:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this._set=b||[],this._initialised=!1}return e(a,[{key:"intersect",value:function(a){Array.isArray(a)||(a=a.set);for(var b=[],c=0,d=0,e=0;d<this._set.length&&e<a.length;)this._set[d]<a[e]?d++:this._set[d]>a[e]?e++:(b[c++]=this._set[d],d++,e++);this._set=b}},{key:"intersectOrSet",value:function(a){this._initialised?this.intersect(a):(Array.isArray(a)||(a=a.set),this.set=a,this._initialised=!0)}},{key:"intersectCount",value:function(a){Array.isArray(a)||(a=a.set);for(var b=0,c=0,d=0;c<this._set.length&&d<a.length;)this._set[c]<a[d]?c++:this._set[c]>a[d]?d++:(b++,c++,d++);return b}},{key:"set",set:function(a){this._set=a||[]},get:function(){return this._set}},{key:"length",get:function(){return this._set.length}}]),a}();b.exports=f},{}],52:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./sorted_set"),g=a("./input_parser"),h=a("./prediction"),rh=a("../../../../lib/rh"),i=rh._,j=a("./indices"),k=function(){function a(b){d(this,a),this.newPredictions=[],this.predictionSet=new f,this.inputSet=new f,this._loader=b}return e(a,[{key:"computeCounts",value:function(a,b){var c=this;return this.newPrediction=[],this.parsed_input=b,i.each(a,function(a){c.addUpdatedPrediction(a)}),this.newPredictions}},{key:"addUpdatedPrediction",value:function(a){var b=1;if(void 0!==this._loader&&(this.createPredictionSet(a),b=this.computeTopicCount()),b>0){var c=new h(a.term,a.probability,b,a.source);this.newPredictions.push(c)}}},{key:"computeTopicCount",value:function(){return this.predictionSet.set.length}},{key:"createPredictionSet",value:function(a){var b=this;this.predictionSet=new f;var c=new g(a.term,(!0));i.each(c.words,function(a,c){b._addWordToSet(a,b.predictionSet,c)})}},{key:"initInput",value:function(a){var b=this;this.inputSet=new f,i.each(a.words,function(a){b._addWordToSet(a,b.inputSet)})}},{key:"_addWordToSet",value:function(a,b){if(!this._loader.isStopWord(a)){var c=this._loader._getHashForWord(a);c&&c.length>j.MAP.TOPICS&&b.intersectOrSet(c[j.MAP.TOPICS])}}}]),a}();b.exports=k},{"../../../../lib/rh":25,"./indices":42,"./input_parser":43,"./prediction":46,"./sorted_set":51}],53:[function(a,b,c){(function(c){(function(){"use strict";var d=a("./indices"),e={getNextModel:function(a){if(a&&Array.isArray(a)&&a.length>d.MODEL.NEXT_MODEL)return a[d.MODEL.NEXT_MODEL]},getFirstLevelNextModel:function(a,b){if(a&&Array.isArray(a)){if(!b&&a.length>d.FIRST_PREDICTION.NEXT)return a[d.FIRST_PREDICTION.NEXT];if(b&&a.length>d.FIRST_PREDICTION.PREVIOUS)return a[d.FIRST_PREDICTION.PREVIOUS]}},getFirstPrediction:function(a){if(a&&Array.isArray(a)&&a.length>0&&Array.isArray(a[0]))return a[0]},compareNoCase:function(a,b){return void 0!==c.compare?c.compare(a,b):a===b?0:-1},hammingDistance:function f(a,b){for(var c=Math.min(a.length,b.length),f=0,d=0;d<c;d++)a[d]!==b[d]&&f++;return a.length>c&&(f+=a.length-c),f},isPrevious:function(a){return a.selStart<a.text.length},shouldShowSuggestion:function(a){var b=a.text,c=a.selStart;return 0===c||c===b.length||b.length>0&&(" "===b[c]||" "===b[c-1])},shouldAppendSpace:function(a){var b=a.text,c=a.selStart;return b.length>0&&c===b.length&&" "!==b[b.length-1]},getSafeElement:function(a,b){if(a&&Array.isArray(a)&&a.length>b)return a[b]},getCountfromModel:function(a){return Array.isArray(a)&&a.length>d.MODEL.COUNT?a[d.MODEL.COUNT]:0;
},getCountfromWordHash:function(a){return Array.isArray(a)&&a.length>d.MAP.COUNT?a[d.MAP.COUNT]:0}};b.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./indices":42}],54:[function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("lunr"),h=a("./query/processor"),rh=a("../../../../lib/rh"),i=rh._,j=rh.consts,k=a("./query/loader"),l=a("../common/merger"),m=a("../../../common/counting_seamaphore"),n=a("./query/query"),o=rh.$;b.exports=function(){function a(b){var c=this,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;e(this,a),this.widget=b,this.initDone=!1,this.max_results=d,this.queryProcessors=[],this.merger=new l([]),this._resutSeamaphore=new m(this.onResultComplete.bind(this)),this.widget.model.subscribe(j("KEY_PROJECT_LIST"),function(){c.init()})}return f(a,[{key:"init",value:function(){var a=this;if(!this.initDone){var b=this._createLoaders();i.each(b,function(b,c){b.init(c,a.addProcessors.bind(a))}),this.initDone=!0,this.pendingText&&(this.showSearchResults(this.pendingText),this.pendingText=null)}}},{key:"addProcessors",value:function(a){this.queryProcessors.push(new h(a))}},{key:"_createLoaders",value:function(){return i.map(this.projectPaths,function(a){return new k(a)})}},{key:"showSearchResults",value:function(a){var b=this;if(!this.initDone)return void(this.pendingText=a);var c=i.find(this.queryProcessors,function(c){return c.isNewQuery(a,b.searchOpts(c.getPath()))});c?(this.merger=new l([]),this._resutSeamaphore=new m(this.onResultComplete.bind(this)),this._resutSeamaphore.wait(this.processorCount),this.runSearch(a),this.merger.items&&0===this.merger.items.length&&!this.isExactSearch&&this.runSearch(a,!0)):this.widget.publish(rh.consts("EVT_SEARCH_IN_PROGRESS"),!1,{sync:!0})}},{key:"runSearch",value:function(a,b){var c=this;i.each(this.queryProcessors,function(d){d.search(a,c.searchOpts(d.getPath(),!!b&&d.needsCorrection),c.topicCallback.bind(c),c.onSearchResults.bind(c))})}},{key:"onSearchResults",value:function(a,b,c){this.processTopicsResults(a,b),this.processGlossaryResults(a,c),this._resutSeamaphore.signal()}},{key:"getClauseGroups",value:function(){return i.map(this.queryProcessors,function(a){return{clauses:i.flatten(a.query.fieldsParam),index:a.getIndex()}})}},{key:"calculateFranks",value:function(){var a=this,b=this.getClauseGroups(),c=g.Index.mergeResults(i.map(this.merger.items,function(a){return{queryTerm:a.queryTerm,index:a.index,score:a.fRanking,matchData:a.matchData,ref:a.ref}}),b,function(a,b){return n.applyClauses(b,a)});c=i.map(c,function(b){var c=i.find(a.merger.items,function(a){return a.ref===b.ref});return c.update({fRanking:b.score,proximityScore:b.proximityScore,matchData:b.matchData})}),this.merger.clear(),this.merger.append(c),this.merger.purge()}},{key:"onResultComplete",value:function(){i.isMergeProject()&&this.calculateFranks(),this.widget.publish(rh.consts("EVT_SEARCH_IN_PROGRESS"),!1,{sync:!0});var a=this.widget.get(j("KEY_SEARCH_TERM")),b=d({},j("HASH_KEY_RH_SEARCH"),a),c=i.mapToEncodedString(b);this.widget.publish(j("KEY_SEARCH_RESULT_PARAMS"),c),this.widget.publish(".p.searchresults",this.merger.items),window._textToHtml_nonbsp&&this.showSearchMsg(this.merger.items.length,window._textToHtml_nonbsp(a)),rh.model.get(j("KEY_SHOW_CONTEXT"))===!1&&this.hideContexts()}},{key:"showSearchMsg",value:function(a,b){var c=rh.model.get(rh.consts("KEY_LNG"));c=c.ResultsFoundText||"%1 result(s) found for %2",c=c.replace("%1",a),c=c.replace("%2","'"+b+"'"),this.displayMsg(c)}},{key:"displayMsg",value:function(a){var b=document.getElementById("searchMsg");b&&(b.innerHTML=a)}},{key:"hideContexts",value:function(){var a=document.getElementsByClassName("wSearchContext");i.defer(function(){i.each(a,function(a){o.addClass(a,"rh-hide")})})}},{key:"searchOpts",value:function(a,b){return{andSearch:"1"===rh.model.get(rh.consts("KEY_AND_SEARCH")),cbt:rh.model.cget("KEY_TAG_EXPRESSION"),origin:a,fuzzy:!!b}}},{key:"topicCallback",value:function(a,b,c){this.widget.publish(".p.searchsummary"+a,b),this.widget.publish(".p.searchurl"+a,c)}},{key:"processGlossaryResults",value:function(a,b){var c=b&&Object.keys(b)[0];this.widget.publish(j("KEY_GLOSSARY_RESULT_TERM"),c),this.widget.publish(j("KEY_GLOSSARY_RESULT"),b[c])}},{key:"processTopicsResults",value:function(a,b){this.text=a,this.merger.append(b),i.isMergeProject()||this.merger.purge()}},{key:"projectPaths",get:function(){return rh.model.get(rh.consts("KEY_PROJECT_LIST"))}},{key:"isExactSearch",get:function(){return i.first(this.queryProcessors).exactSearch}},{key:"processorCount",get:function(){return this.queryProcessors.length}}]),a}()},{"../../../../lib/rh":25,"../../../common/counting_seamaphore":26,"../common/merger":34,"./query/loader":59,"./query/processor":60,"./query/query":61,lunr:21}],55:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._,g=rh.consts;b.exports=function(){function a(b,c,e){d(this,a),this.cb=e,this.pipeLineFn={},this.code=this._extractCode(b),this.useLang=this._useLang(),this.loader=c}return e(a,[{key:"setLanguage",value:function(a){var b=this;return this.useLang?void f.loadScript(this.loader.getUrl(g("SEARCH_STEMMER_SUPPORT")),!0,function(){var c=f.exports();c(a),"jp"===b.code?f.loadScript(b.loader.getUrl(g("SEARCH_TINY_SEGMENTER")),!0,function(){var c=f.exports();c(a),f.loadScript(b.loader.getUrl(g("SEARCH_LNG_SUPPORT")),!0,function(){var c=f.exports();return c(a),b.cb&&b.cb(a)})}):f.loadScript(b.loader.getUrl(g("SEARCH_LNG_SUPPORT")),!0,function(){var c=f.exports();return c(a),b.cb&&b.cb(a)})}):(this.setTokenizer(a),this.cb&&this.cb(a))}},{key:"replaceFn",value:function(a,b){this.useLang&&(a.pipeline.before(b.stemmer,b[this.code].stemmer),a.pipeline.remove(b.stemmer),b[this.code]&&b[this.code].tokenizer&&(b.tokenizer=b[this.code].tokenizer))}},{key:"setTokenizer",value:function(a){a.tokenizer.separator=/[\s\.\-\'\,\n;\:\\\/\"]+/}},{key:"initFns",value:function(a){var b=this,c=this.useLang?a[this.code]:a,d=this.useLang?this.fn[this.code]||this.fn.en:this.fn.en;f.each(d,function(d,e){"jp"!==b.code&&a.Pipeline.registerFunction(c[d],e),b.pipeLineFn[e]=c[d]})}},{key:"initIndexing",value:function(a,b){this.useLang&&a.use(b[this.code])}},{key:"_useLang",value:function(){return this.code&&["en"].indexOf(this.code)===-1&&this.codes.indexOf(this.code)!==-1}},{key:"_extractCode",value:function(a){if(a){var b=a.indexOf("_"),c=a.substring(0,b).toLowerCase();return"ja"===c&&(c="jp"),c}}},{key:"stemmer",get:function(){return this.pipeLineFn.stemmer}},{key:"stopWordFilter",get:function(){return this.pipeLineFn.stopWordFilter}},{key:"tokenizer",get:function(){return this.pipeLineFn.tokenizer}},{key:"codes",get:function(){return["da","de","du","es","fi","fr","hu","it","ja","jp","no","pt","ro","ru","sv","tr"]}},{key:"fn",get:function(){return{da:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},de:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},du:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},en:{tokenizer:"tokenizer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},es:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},fi:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},fr:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},it:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},ja:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},jp:{tokenizer:"tokenizer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},no:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},pt:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},ro:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},ru:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},sv:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},th:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"},tr:{tokenizer:"trimmer",stopWordFilter:"stopWordFilter",stemmer:"stemmer"}}}}]),a}()},{"../../../../lib/rh":25}],56:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();b.exports=function(){function a(b){d(this,a),b&&(this.data=JSON.parse(b))}return e(a,[{key:"getTopicData",value:function(a){return this.topicData[a]}},{key:"getTopicSummary",value:function(a){return this.topicData[a]&&this.topicData[a].summary}},{key:"getTopicNextId",value:function(a){return this.topicData[a]&&this.topicData[a].next}},{key:"settings",get:function(){return this.data.settings}},{key:"topicData",get:function(){return this.data.metadata}},{key:"context",get:function(){return this.settings.context}},{key:"contextLimit",get:function(){return this.settings.contextLimit}},{key:"fields",get:function(){return this.settings.fields}}]),a}()},{}],57:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../../lib/rh"),f=rh._;b.exports=function(){function a(b,c,e){d(this,a),this.fileds=b,this.origin=c,this.tagExprs=e}return e(a,[{key:"filter",value:function(a){var b=this;return f.reduce(a,function(a,c){return a||b._isFilterd(c)},!1)}},{key:"_isFilterd",value:function(a){var b=this.getCbt(a);return b&&this._isFilteredCbt(b)}},{key:"_isFilteredCbt",value:function(a){var b=this,c=a.split(";");return!f.any(c,function(a){return f.evalTagExpression(a,b.tagExprs,b.origin)})}},{key:"getCbt",value:function(a){return a&&a.attributes&&a.attributes.length>0&&f.map(a.attributes,function(a){return a.value}).join(";")}}]),a}()},{"../../../../../lib/rh":25}],58:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("lunr"),g=a("../../common/synonymns"),rh=a("../../../../../lib/rh"),h=rh._,i=a("../language"),j=a("../result"),k=a("./query");b.exports=function(){function a(b,c,e){d(this,a),this.init(b,c,e)}return e(a,[{key:"init",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a=this.fixContent(a),this.settings=c,this.content=a,this.code=h.get(this.settings,"language.code"),this.languageSetter=new i(this.code,b,this.loadDb.bind(this)),this.languageSetter.setLanguage(f)}},{key:"fixContent",value:function(a){return a.pipeline=a.pipeline||[],a.fieldVectors=a.fieldVectors||[],a.invertedIndex=a.invertedIndex||[],a}},{key:"loadDb",value:function(){this.processSyn(),this.registerFunctions(),this.db=f.Index.load(this.content),h.isEmptyObject(this.content.pipeline)||this.languageSetter.replaceFn(this.db,f)}},{key:"registerFunctions",value:function(){var a=this.replaceSynonymn.bind(this),b=this.addQuery.bind(this);f.Pipeline.registerFunction(a,"replaceSynonymn"),f.Pipeline.registerFunction(b,"addQuery")}},{key:"processSyn",value:function(){var a=this.settings&&this.settings.synonyms||{},b=new g(a);this.settings.rootWords=b.rootWords}},{key:"addQuery",value:function(a){var b=a.toString();return b.startsWith("*")&&b.endsWith("*")||this.queryWords.push(b),this.queryWords=h.unique(this.queryWords),a}},{key:"replaceSynonymn",value:function(a){var b=a.toString(),c=this.settings&&this.settings.rootWords&&this.settings.rootWords[b];return c&&!h.isEmptyObject(c)?h.map(h.filter(c,function(a){return h.isString(a)&&a!==b}),function(b){return a.clone().update(function(){return b})}):a}},{key:"addStopWords",value:function(a,b){if(b){var c=f.generateStopWordFilter(b);a.pipeline.before(f.stopWordFilter,c),a.pipeline.remove(f.stopWordFilter)}}},{key:"search",value:function(a){var b=this;this.queryWords=[];var c=a.getParams(this.isStopWord.bind(this)),d=[];return h.isMergeProject()?h.each(c,function(a){if(!h.isEmpty(a)){var c=b.db.query(function(b){return k.applyClauses(a,b)},{proximityScoring:!1,sort:!1});d=d.concat(h.map(c,function(c){return new j(c,a[0].name,b.db)}))}}):(c=h.flatten(c),d=this.db&&!h.isEmptyObject(c)&&this.db.query(function(a){return k.applyClauses(c,a)})||[],d=h.map(d,function(a){return new j(a)})),a.opts?h.filter(d,function(c){return b.match(c,a.opts)}):d}},{key:"substrMatch",value:function(a,b,c){var d=this,e=!1,f=h.filter(b,function(b){return b.indexOf(a)!==-1});return h.each(f,function(a){if(c[a]&&!d.isStopWord(a))return e=!0,!1}),e}},{key:"match",value:function(a,b){var c=this,d=!0;if(b.andSearch){var e=a&&a.matchData.metadata||[];if(b.searchSubstrings){var f=h.keys(e),g=!1;h.each(this.queryWords,function(a){g=g||c.substrMatch(a,f,e)}),d=g}else h.each(this.queryWords,function(a){e[a]||c.isStopWord(a)||(d=!1)})}return d}},{key:"isStopWord",value:function(a){return this.settings.stopWords.indexOf(a.toLowerCase())!==-1}},{key:"searchGlossary",value:function(a){var b=this,c=this.settings&&this.settings.glossary||{},d=this.getRootTokens(a),e=h.reduce(c,function(a,c,e){var f=b.getRootTokens(e);return d.length===f.length&&b.matchTokens(d,f)&&(a[e]=c),a},{});return e}},{key:"matchTokens",value:function(a,b){var c=!0;return h.each(a,function(a,d){a!==b[d]&&(c=!1)}),c}},{key:"getRootTokens",value:function(a){var b=this,c=f.tokenizer(a);return h.flatten(h.map(c,function(a){var c=a.toString();return b.settings.rootWords[c]||[c]}))}},{key:"export",value:function(){return this.db.toJSON()}}]),a}()},{"../../../../../lib/rh":25,"../../common/synonymns":36,"../language":55,"../result":63,"./query":61,lunr:21}],59:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../../lib/rh"),f=rh._,g=a("../../common/paths");b.exports=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";d(this,a),this._paths=new g(b)}return e(a,[{key:"getPath",value:function(){return this._paths.getPath()}},{key:"init",value:function(a,b){this.id=a,b(this)}},{key:"loadDB",value:function(a){var b=this._paths.getSearchDbFilePath();f.loadScript(b,!0,function(){var b=f.exports();a&&a(b)},!0)}},{key:"getId",value:function(a){return this.id+"_"+a}},{key:"getUrl",value:function(a){return this._paths._getRelativePath(a)}},{key:"loadMetaData",value:function(a){var b=this._paths.getMetadataFilePath();f.loadScript(b,!0,function(){var b=f.exports();a&&a(b)},!0)}},{key:"loadTextData",value:function(a,b,c){var d=this._paths.getTextFilePath(b);f.loadScript(d,!0,function(){var d=f.exports();c&&c(a,b,d)},!0)}}]),a}()},{"../../../../../lib/rh":25,"../../common/paths":35}],60:[function(a,b,c){(function(c){(function(){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./db"),g=a("./query"),h=a("./summary"),rh=a("../../../../../lib/rh"),i=rh._,j=a("../../../../common/counting_seamaphore"),k=a("../text_merger"),l=a("../metadata"),m=a("./cbt");b.exports=function(){function a(b){var c=this;d(this,a),this.loader=b,this.metadataLoaded=this.dbLoaded=!1,this.loader.loadDB(function(a){c.initDB(a)}),this.loader.loadMetaData(function(a){c.initMetadata(a)})}return e(a,[{key:"getPath",value:function(){return this.loader.getPath()}},{key:"initMetadata",value:function(a){this.metadataLoaded=!0,this.metadata=new l(a),!this.init&&this.dbContent&&(this.initDB(this.dbContent),this.dbContent=null),rh.model.publish(rh.consts("KEY_SHOW_CONTEXT"),this.contextLimit>0)}},{key:"initDB",value:function(a){this.metadataLoaded?(this.db=new f(a,this.loader,this.metadata.settings),this.init=!0,this.waiting&&(this.waiting=!1,this.getResults())):this.dbContent=a}},{key:"topicsLoaded",value:function(){this.exactSearch&&this.filter()}},{key:"isNewQuery",value:function(a,b){if(!this.init)return!0;if(!this.metadata.settings)return!1;var c=this.buildQuery(a,b);return!this.query||!this.query.isEqual(c)}},{key:"search",value:function(a,b,c,d){this.isNewQuery(a,b)&&(this.text=a,this.seamaphore=new j(this.topicsLoaded.bind(this)),this.topicCallback=c,this.opts=b,this.summaries={},this.resultsCallback=d,this.getResults())}},{key:"filter",value:function(){var a=this,b=this.query.exaxctTerms;this.results=i.filter(this.results,function(c){var d=a.resultsMetadata[c.id].topicText;return a.matchesExact(b,d,c.id)}),this.resultsCallback(this.query.text,this.results,this.glossaryResult),this.processSummary()}},{key:"processSummary",value:function(){var a=this;i.each(this.results,function(b){var c=b.id;a.topicCallback(a.loader.getId(c),a.summaries[c],a.createUrl(c,a.query.exaxctTerms))})}},{key:"matchesExact",value:function(a,b,c){var d=this,e=!1;return i.each(a,function(a){var f=b.toLowerCase().indexOf(a);f!==-1&&(d.addSummary(c,b,f,a),e=!0)}),e}},{key:"addSummary",value:function(a,b,c,d){var e=this.metadata.getTopicSummary(a);if(this.metadata.context&&e)this.summaries[a]=e;else{var f=new h(this.metadata.topicData,this.metadata.context,this.metadata.contextLimit);this.summaries[a]=f.getSummaryText(b,c,d.length,d)}}},{key:"getResults",value:function(){return this.init?(this.query=this.buildQuery(this.text,i.extend(this.opts,{searchSubstrings:this.searchSubstrings})),this.exactSearch=this.query.exactMatch,this.glossaryResult=this.searchGlossary(this.text),this.results=this.process(),void(this.exactSearch&&0!==this.results.length||this.resultsCallback(this.query.text,this.results,this.glossaryResult))):void(this.waiting=!0)}},{key:"doCorrection",value:function(){this.query=this.buildQuery(this.query.text,i.extend(this.opts,{fuzzy:!0})),this.results=this.process()}},{key:"searchGlossary",value:function(){return this.processGlossary()}},{key:"buildQuery",value:function(a,b){return new g(a,this.metadata.settings,b,this.filterItem.bind(this))}},{key:"process",value:function(){var a=this;this.resultsMetadata={};var b=this.db.search(this.query);return this.seamaphore.wait(b.length),i.each(b,function(b){var c=a.metadata.getTopicData(b.ref);a.resultsMetadata[b.ref]?i.extend(a.resultsMetadata[b.ref],i.clone(b.matchData.metadata)):a.resultsMetadata[b.ref]=i.clone(b.matchData.metadata),a.loader.loadTextData(a.query,b.ref,a.processTopicData.bind(a)),i.extend(b,c),b.id=b.ref,b.setRef(a.loader.getId(b.ref))}),b}},{key:"processGlossary",value:function(){return this.db.searchGlossary(this.text)}},{key:"flattenedText",value:function(a){var b={};return i.each(a,function(a,c){b[c]=i.isArray(a)?i.flatten(a):a}),b}},{key:"processTopicData",value:function(a,b,c){var d=this;if(this.query.isEqual(a)){var e=this.resultsMetadata[b];if(e){var f=[],g=new h(this.metadata.topicData,this.metadata.context,this.metadata.contextLimit),j=g.getSummary(b,e,f,c);j=j.replace(/\t+/gi," ").trim(),this.resultsMetadata[b].topicText=this.createText(b,this.flattenedText(c)),!this.exactSearch&&this.searchSubstrings&&(f=i.filter(f,function(a){return a&&!a.startsWith(d.query.originalText)}),f.push(this.query.originalText)),this.exactSearch||this.topicCallback(this.getId(b),j,this.createUrl(b,f))}this.seamaphore.signal()}}},{key:"createText",value:function(a,b){var c=this.metadata.getTopicNextId(a),d=new k(c,b,this.filterId.bind(this));return d.getText()}},{key:"filterId",value:function(a){var b=this.metadata.fields,c=b[a];return this.filterItem(c)}},{key:"filterItem",value:function(a){var b=this.metadata.fields,c=new m(b,this.opts.origin,this.opts.cbt);return a&&c.filter(a)}},{key:"getId",value:function(a){return this.loader.getId(a)}},{key:"createUrl",value:function(a,b){var d=this.metadata.getTopicData(a),e={rhsearch:this.query.originalText};if(c.gbHighLight){var f=this.searchSubstrings?this.query.originalText:this.exactSearch?'"'+b[0]+'"':(b||[]).join(" ");e.rhhlterm=f}if(d){var g="?"+i.mapToEncodedString(e);return""+this.loader.getUrl(d.relUrl)+g}}},{key:"getIndex",value:function(){return this.db.db}},{key:"searchSubstrings",get:function(){return i.get(this.metadata.settings,"searchsubstrings")}},{key:"contextLimit",get:function(){var a=parseInt(this.metadata.contextLimit);return Number.isNaN(a)?100:a}},{key:"needsCorrection",get:function(){return this.results&&0===this.results.length&&this.metadata.settings.fuzzy&&!this.query.exactMatch}}]),a}()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../../../lib/rh":25,"../../../../common/counting_seamaphore":26,"../metadata":56,"../text_merger":64,"./cbt":57,"./db":58,"./query":61,"./summary":62}],61:[function(a,b,c){(function(c){(function(){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../../lib/rh"),f=rh._,g=a("./cbt"),h=a("lunr");b.exports=function(){function a(b,e,f){d(this,a),this.originalText=b.trim(),this.text=this.originalText.toLowerCase(),this.settings=e||{},this.opts=f||{},this.opts.gbHighLight=c.gbHighLight,this.checkExactMatch()}return e(a,[{key:"filter",value:function b(a){var b=new g(this.settings.fields,this.opts.origin,this.opts.cbt);return b.filter(a)}},{key:"getParams",value:function(a){return this.isStopWord=a,this.fieldsParam}},{key:"isEqual",value:function(a){return this.text===a.text&&this._bExactMatch===a._bExactMatch&&f.isEqual(this.opts,a.opts)}},{key:"getFuzzyLength",value:function(a){return f.max([0,Math.floor(Math.log2(a.length)-1)])}},{key:"getQueryArr",value:function(a,b,c){return this.isStopWord(b)?[]:this.opts.fuzzy?[{name:b,fields:[a],editDistance:this.getFuzzyLength(b),boost:c}]:this.opts.searchSubstrings&&!this._bExactMatch?[{name:b,fields:[a],boost:c},{name:b,fields:[a],boost:Math.round(Math.sqrt(c)),wildcard:h.Query.wildcard.LEADING|h.Query.wildcard.TRAILING}]:[{name:b,fields:[a],boost:c}]}},{key:"checkExactMatch",value:function(){this._isExactMatch&&(this._bExactMatch=!0,this.text=this.text.substring(1,this.text.length-1))}},{key:"getFieldBoost",value:function(a){return f.reduce(a,function(a,b){return b&&b.boost&&b.boost>a?b.boost:a},1)}},{key:"_isExactMatch",get:function(){return this.text.length>2&&this.quotesChar.indexOf(this.text[0])!==-1&&this.quotesChar.indexOf(this.text[this.text.length-1])!==-1}},{key:"exactMatch",get:function(){return this._bExactMatch}},{key:"exaxctTerms",get:function(){return[this.text]}},{key:"quotesChar",get:function(){return['"',"'"]}},{key:"fieldsParam",get:function(){var a=this,b=[],c=f.filter(f.map(h.tokenizer(this.text),function(a){return a.str}),function(a){return!f.isEmptyString(a.trim())});return f.each(c,function(c){var d=[];f.each(a.settings.fields,function(b,e){if(!a.filter(b)){var f=a.getFieldBoost(b);d=d.concat(a.getQueryArr(e,c,f))}}),b.push(d)}),b}}],[{key:"applyClauses",value:function(a,b){return f.each(a,function(a){return b.term(a.name,a)})}}]),a}()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../../../lib/rh":25,"./cbt":57,lunr:21}],62:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../../lib/rh"),f=a("../text_merger"),g=rh._;b.exports=function(){function a(b,c,e){d(this,a),this.topicData=b,this.context=c,this.contextLimit=Number.parseInt(e),this.rightLimit=Math.ceil(70*this.contextLimit/100),this.leftLimit=Math.ceil(30*this.contextLimit/100)}return e(a,[{key:"minDistance",value:function(){}},{key:"getSummary",value:function(a,b,c,d){var e=this,h=[],i="";this.context&&(i=this.topicData[a]&&(this.topicData[a].summary||"").substring(0,this.contextLimit));try{h=g.map(b,function(a){return g.union(a,function(a,b){if(a&&a.position&&a.position[0])return g.union(a.position,function(a){if(void 0!==a[0]&&void 0!==a[1]){var g=d[b],h=new f,i=h.getIndexText(g,a[2]),j=i.substring(a[0],a[0]+a[1]);return j=j.toLowerCase(),c.indexOf(j)===-1&&c.push(j),e.getSummaryText(i,a[0],a[1],j)}});var h=d[b];return g.map(g.flatten(h),function(a){return e.trimRight(a)})})}),this.context&&i&&""!==i||g.each(h[0]||[],function(a){a.length>i.length&&(i=a)})}catch(j){i=""}return""===i&&(i=this.getDefaultSummary(d)),i}},{key:"getDefaultSummary",value:function(a){var b="";try{var c="";g.each(a,function(a,b){"id"!==b&&(c+=" ")}),b=this.getSummaryText(c,0,this.contextLimit||100,"")}catch(d){b=""}return b}},{key:"getSummaryText",value:function(a,b,c,d){var e=a.substring(0,b),f=a.substring(b+c);return this.trimLeft(e)+"<b>"+d+"</b>\n              "+this.trimRight(f)}},{key:"trimLeft",value:function(a){var b=a.indexOf(" ",a.length-this.leftLimit);if(b===-1)for(b=a.length-this.leftLimit;b>0&&!/\s/.test(a[b]);)b--;return a=a.substring(b,a.length),a.trimStart()}},{key:"trimRight",value:function(a){var b=a.indexOf(" ",this.rightLimit);return b=b===-1?a.length:b,a=a.substring(0,b),a.trimEnd()}}]),a}()},{"../../../../../lib/rh":25,"../text_merger":64}],63:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("../suggestion/utils"),h=d(g),rh=a("../../../../lib/rh"),i=rh._;b.exports=function(){function a(b,c,d){e(this,a),this.fRanking=b.score,this.proximityScore=b.proximityScore,this.nIndex=1,this.strSummary=".p.searchsummary"+b.ref,this.strUrl=".p.searchurl"+b.ref,this._strBreadcrumbs=this.relTOCPath=b.relTOCPath?b.relTOCPath.join(" / "):null,this._strTitle=this.title=b.title||i.getFileName(b.relTOCPath||""),this.index=d,this.queryTerm=c,this.matchData=b.matchData,this.ref=b.ref}return f(a,[{key:"setRef",value:function(a){this.ref=a,this.strSummary=".p.searchsummary"+a,this.strUrl=".p.searchurl"+a}},{key:"merge",value:function(a){this.fRanking+=a.fRanking,this.proximityScore+=a.proximityScore}},{key:"compare",value:function(a){return this.proximityScore!==a.proximityScore?a.proximityScore-this.proximityScore:a.fRanking-this.fRanking}},{key:"match",value:function(a){return 0===h["default"].compareNoCase(a.strUrl,this.strUrl)}},{key:"update",value:function(a){return i.extend(this,a||{}),this}},{key:"strTitle",get:function(){return this.title||i.getFileName(this.relTOCPath||"")}},{key:"strBreadcrumbs",get:function(){return this.relTOCPath?this.relTOCPath.join(" / "):null}}]),a}()},{"../../../../lib/rh":25,"../suggestion/utils":53}],64:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../../../lib/rh"),f=rh._;b.exports=function(){function a(b,c,e){d(this,a),this.nextTexts=b,this.texts=c,this.filter=e||this.defaultFilter}return e(a,[{key:"join",value:function(a,b,c){for(var d=[],e=b;e<=c;e++)this.texts[a][e]&&d.push(this.texts[a][e]);return d.join("").replace(/[\n ]+/g," ").replace(/\u00A0/gi," ")}},{key:"defaultFilter",value:function(){return!1}},{key:"getIndexText",value:function(a,b){return(f.isNil(b)?a:a[b]).join("").replace(/\n/gi," ").trim()}},{key:"getText",value:function(){var a=this,b=[];return f.each(this.nextTexts,function(c){a.filter(c[0])||b.push(a.join(c[0],c[1],c[2]))}),b.join("")}}]),a}()},{"../../../../lib/rh":25}],65:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=rh._,g=rh.consts,h=function(){function a(b){d(this,a),this.widget=b}return e(a,[{key:"getLink",value:function(a){var b=a,c=this.widget.get(g("KEY_SEARCH_RESULT_PARAMS")),d=this.widget.get(g("KEY_SEARCH_TERM")),e="";if(d&&""!==d){var h=g("HASH_KEY_RH_SEARCH"),i={};i[h]=d,e=f.mapToEncodedString(i)}return void 0!==c&&""!==c?b=b+c+"&"+e:""!==e&&(b=b+"?"+e),b}}]),a}();rh.controller("SearchResultController",h)},{"../../lib/rh":25}],66:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),rh=a("../../lib/rh"),f=rh._,g=rh.consts,h=function(){function a(b){d(this,a),this.widget=b}return e(a,[{key:"select",value:function(a,b){this.widget.publish(g("KEY_TOC_SELECT_ITEM"),{id:a,url:b})}},{key:"getLink",value:function(a){if(a){var b=this.widget.get(g("KEY_TOC_BREADCRUMBS")),c=b[a];if(c&&c.hasUrl)return c.url}}},{key:"goToHome",value:function(a){if(a){var b=this.widget.get(g("KEY_TOC_BREADCRUMBS")),c=b[a];c&&!c.hasUrl&&f.goToHome({rhtocid:c.id})}}}]),a}();rh.controller("TocBreadcrumbsController",h)},{"../../lib/rh":25}],67:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),
d&&a(b,d),b}}(),rh=a("../../../lib/rh"),f=rh.$,g="change",h=".carousel-item:not(.hide):not(.rh-hide)",i=function(){function a(b,c){var e=this;d(this,a),this.widget=b,this.node=this.widget.node,this.tab=0,rh.model.subscribeOnce(rh.consts(c.key),function(){e.widget.publish(g,!0)}),rh.model.subscribe(rh.consts("KEY_SCREEN"),function(){e["goto"](e.tab,0)}),rh.model.subscribe(c.key+"gototab",function(a){e["goto"](e.pagecount(),a.tab)})}return e(a,[{key:"goto",value:function(a,b){var c=this;this.tab=b,this.carouselnode=f.find(this.node,".carousel")[0],this.animateLeft(a),rh._.delay(function(){c.widget.publish(g,!0)},1e3)}},{key:"hasNext",value:function(){this.carouselnode=f.find(this.node,".carousel")[0];var a=f.find(f.find(this.node,".carousel")[0],h);return a=a&&a.length>0?a[a.length-1]:null,a.offsetLeft+this.carouselnode.offsetLeft>this.carouselnode.offsetWidth}},{key:"animateLeft",value:function(){var a="calc(-"+14*this.tab+"px - "+100*this.tab+"%)";f.css(this.carouselnode,"left",a)}},{key:"next",value:function(){this["goto"](this.tab,this.tab+1)}},{key:"pagecount",value:function(){return this.tab}},{key:"previous",value:function(){this["goto"](this.tab,this.tab-1)}},{key:"ensureVisible",value:function(){}}]),a}();rh.controller("Carousel",i)},{"../../../lib/rh":25}],68:[function(a,b,c){"use strict";var rh=a("../../lib/rh"),d=rh.$;b.exports={nodeType:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},removeChild:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parentNode(a);return b&&b.removeChild&&b.removeChild(a)},appendChild:function(a,b){return a&&a.appendChild&&a.appendChild(b)},parentNode:function(a){return a&&a.parentNode},childNodes:function(a){return a&&a.childNodes||[]},toHtmlNode:function(a){return this.childNodes(d.createElement("div",a))},outerHTML:function(a){return a&&a.outerHTML||""},insertAfter:function(a,b){return a.parentNode.insertBefore(b,a.nextSibling)},value:function(a){return a&&a.nodeValue},name:function(a){return a&&a.nodeName},type:function(a){return a&&a.nodeType},isElementNode:function(a){return this.type(a)===this.nodeType.ELEMENT_NODE},isTextNode:function(a){return this.type(a)===this.nodeType.TEXT_NODE}}},{"../../lib/rh":25}]},{},[27]);